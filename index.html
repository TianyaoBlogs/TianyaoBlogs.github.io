<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tianyaoblogs.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="TianyaoBlogs">
<meta property="og:url" content="https://tianyaoblogs.github.io/index.html">
<meta property="og:site_name" content="TianyaoBlogs">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tianyaoblogs.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>TianyaoBlogs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">TianyaoBlogs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/11/12/datasets/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/12/datasets/" class="post-title-link" itemprop="url">QM9 Dataset</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-11-12 21:00:00 / 修改时间：21:44:14" itemprop="dateCreated datePublished" datetime="2025-11-12T21:00:00+08:00">2025-11-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dataset/" itemprop="url" rel="index"><span itemprop="name">dataset</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="uni-mol2训练数据集详细参数表">Uni-Mol2训练数据集详细参数表</h1>
<table>
<colgroup>
<col style="width: 4%" />
<col style="width: 7%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 21%" />
<col style="width: 19%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr>
<th>数据集类别</th>
<th>数据集名称</th>
<th>规模/数量</th>
<th>数据来源</th>
<th>核心内容/性质</th>
<th>用途</th>
<th>对应文档段落标记</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>预训练数据集</strong></td>
<td>Uni-Mol2 Dataset</td>
<td>约8.84亿个3D分子构象；含73,725,454个分子骨架（Scaffold）</td>
<td>1. Uni-Mol原有数据集（1900万分子）；2.
ZINC20数据库标准反应性子集</td>
<td>涵盖多样化分子结构，包含原子特征、键特征、3D坐标等信息</td>
<td>用于Uni-Mol2模型预训练，学习分子结构与性质的通用表征</td>
<td>、、、</td>
</tr>
<tr>
<td><strong>预训练验证集</strong></td>
<td>Uni-Mol2预训练验证集</td>
<td>52万个分子</td>
<td>从Uni-Mol2 Dataset中随机采样</td>
<td>与Uni-Mol2 Dataset结构一致，包含完整分子特征与3D构象</td>
<td>评估预训练模型效果，探究验证损失与模型规模、数据集规模、计算资源的缩放定律</td>
<td></td>
</tr>
<tr>
<td><strong>下游任务数据集</strong></td>
<td>QM9 Dataset</td>
<td>13.4万个稳定有机分子（每个分子最多含9个重原子）</td>
<td>量子化学公开数据集（文献[41,42]）</td>
<td>含几何、能量、电子、热力学性质，核心性质包括：HOMO、LUMO、能隙（GAP）、极化率（alpha）、热容（Cv）、偶极矩（mu）、电子空间范围（R²）、零点振动能（ZPVE）</td>
<td>评估模型在分子量子化学性质预测任务中的性能，验证模型缩放效果</td>
<td>、</td>
</tr>
<tr>
<td><strong>下游任务数据集</strong></td>
<td>QM9衍生子集（train50）</td>
<td>QM9训练集的50%样本（按HOMO-LUMO GAP标签分位数分层采样）</td>
<td>QM9 Dataset训练集</td>
<td>与QM9 Dataset核心性质一致，仅样本量为原训练集的50%</td>
<td>模拟“有限标注数据”场景，评估模型在数据稀缺时的预测能力</td>
<td>、</td>
</tr>
<tr>
<td><strong>下游任务数据集</strong></td>
<td>QM9衍生子集（train100）</td>
<td>QM9训练集的100%样本（按HOMO-LUMO GAP标签分位数分层采样）</td>
<td>QM9 Dataset训练集</td>
<td>与QM9 Dataset核心性质一致，样本量为原训练集的100%</td>
<td>模拟“有限标注数据”场景，评估模型在数据稀缺时的预测能力</td>
<td>、</td>
</tr>
<tr>
<td><strong>下游任务数据集</strong></td>
<td>QM9衍生子集（train200）</td>
<td>QM9训练集的200%样本（按HOMO-LUMO GAP标签分位数分层采样）</td>
<td>QM9 Dataset训练集</td>
<td>与QM9 Dataset核心性质一致，样本量为原训练集的200%</td>
<td>模拟“有限标注数据”场景，评估模型在数据稀缺时的预测能力</td>
<td>、</td>
</tr>
<tr>
<td><strong>下游任务数据集</strong></td>
<td>COMPAS-1D Dataset</td>
<td>8678个多环芳烃（PAHs）分子</td>
<td>COMPAS项目公开数据集（文献[43]）</td>
<td>含有机光电材料关键性质，核心性质包括：绝热电子亲和能（aEA）、绝热电离势（aIP）、色散力（dispersion）、偶极矩（Dipmom
Debye）</td>
<td>验证模型在有机光电材料相关性质预测中的泛化能力</td>
<td>、</td>
</tr>
</tbody>
</table>
<h1
id="uni-mol2相关数据集及资源链接汇总表">Uni-Mol2相关数据集及资源链接汇总表</h1>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 19%" />
<col style="width: 31%" />
<col style="width: 33%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr>
<th>类别</th>
<th>数据集/资源名称</th>
<th>链接</th>
<th>用途说明</th>
<th>来源摘要编号</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<h2 id="一预训练数据集相关">一、预训练数据集相关</h2>
<div class="line-block">预训练基础数据 | Uni-Mol1
预训练配体数据（ligands.tar.gz） |
https://bioos-hermite-beijing.tos-cn-beijing.volces.com/unimol_data/pre_train/ligands.tar.gz
| Uni-Mol2 可复用的基础预训练数据，含分子3D构象信息 | 1 |<br />
预训练扩展数据 | ZINC20 数据集文献参考（Uni-Mol2 用到） |
https://pubs.acs.org/doi/10.1021/acs.jcim.0c00675 | Uni-Mol2
预训练数据的核心来源之一（约1TB规模），需通过文献指引获取数据集 | 1
|<br />
数据加载代码 | Uni-Mol2 数据集加载代码（load_dataset） |
https://github.com/deepmodeling/uni-mol/blob/main/unimol2/unimol2/tasks/unimol2.py
| 适配Uni-Mol2数据集格式的核心代码，用于数据读取与预处理 | 1 |<br />
项目基础代码 | Uni-Mol 项目主页（含基础数据入口） |
https://github.com/deepmodeling/Uni-Mol |
获取Uni-Mol系列（含Uni-Mol2）基础数据、预训练权重的核心入口 | 1、4
|</div>
<h2 id="二下游任务数据集qm9及衍生">二、下游任务数据集（QM9及衍生）</h2>
<div class="line-block">QM9 原始数据 | QM9 分子结构数据（gdb9.tar.gz） |
https://deepchemdata.s3-us-west-1.amazonaws.com/datasets/gdb9.tar.gz |
含13.4万有机分子3D结构，用于量子化学性质预测任务 | 3 |<br />
QM9 性质数据 | QM9 性质表格（qm9.csv） |
https://deepchemdata.s3-us-west-1.amazonaws.com/datasets/qm9.csv |
对应QM9分子的热力学、电子性质标签（如HOMO、LUMO、偶极矩等） | 3 |<br />
QM9 加载代码 | deepchem QM9 数据集加载脚本 |
https://github.com/deepchem/deepchem/blob/master/deepchem/molnet/load_function/qm9_datasets.py
| 第三方（deepchem）实现的QM9数据加载代码，可辅助数据预处理 | 3 |<br />
QM9 修正数据集 | curatedQM9 项目页（含13.3万修正分子） |
https://moldis-group.github.io/curatedQM9/ |
修正QM9中“未表征”分子的3D构象，含133660个有效分子，提供XYZ格式文件 | 6
|</div>
<h2 id="三uni-mol-docking-v2-相关衍生任务">三、Uni-Mol Docking V2
相关（衍生任务）</h2>
<div class="line-block">对接任务训练数据 | Uni-Mol Docking V2 训练数据集
| https://zenodo.org/records/11191555 |
用于配体-蛋白结合构象预测任务的训练/验证/测试数据 | 4 |<br />
对接模型权重 | Uni-Mol Docking V2 预训练权重 |
https://www.dropbox.com/scl/fi/sfhrtx1tjprce18wbvmdr/unimol_docking_v2_240517.pt?rlkey=5zg7bh150kcinalrqdhzmyyoo&amp;st=n6j0nt6c&amp;dl=0
| 预训练完成的对接模型权重，可直接用于推理或微调 | 4 |<br />
小分子预训练权重 | Uni-Mol 小分子基础预训练权重 |
https://github.com/deepmodeling/Uni-Mol/releases/download/v0.1/mol_pre_no_h_220816.pt
| Uni-Mol Docking V2 依赖的小分子编码器预训练权重 | 4 |<br />
蛋白口袋预训练权重 | Uni-Mol 蛋白口袋基础预训练权重 |
https://github.com/deepmodeling/Uni-Mol/releases/download/v0.1/pocket_pre_220816.pt
| Uni-Mol Docking V2 依赖的蛋白口袋编码器预训练权重 | 4 |<br />
对接微调数据集 | 蛋白-配体结合构象预测微调数据 |
https://bioos-hermite-beijing.tos-cn-beijing.volces.com/unimol_data/finetune/protein_ligand_binding_pose_prediction.tar.gz
| 用于微调对接模型的LMDB格式数据集（含训练/验证/测试集） | 4 |<br />
对接模型项目页 | Uni-Mol Docking V2 代码与数据入口 |
https://github.com/dptech-corp/uni-mol |
获取对接模型完整代码、数据集更新及技术文档 | 5 |<br />
对接在线服务 | Uni-Mol Docking V2 在线推理工具 |
https://bohrium.dptech.com/apps/unimol_docking_v2 |
无需本地部署，直接在线使用对接模型进行结合构象预测 | 5 |</div>
<h2 id="四论文及核心参考">四、论文及核心参考</h2>
<div class="line-block">Uni-Mol2 论文 | Uni-Mol2 官方论文（arXiv） |
https://arxiv.org/abs/2406.14969v1 | Uni-Mol2
模型设计、数据集构建及实验结果的核心参考 | 2 |</div>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/11/10/phys5120-hw4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/10/phys5120-hw4/" class="post-title-link" itemprop="url">phys-5120-hw4</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-11-10 21:00:00 / 修改时间：14:54:21" itemprop="dateCreated datePublished" datetime="2025-11-10T21:00:00+08:00">2025-11-10</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hw/" itemprop="url" rel="index"><span itemprop="name">hw</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          这是一篇加密文章
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/11/10/phys5120-hw4/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/11/10/summary_11_10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/10/summary_11_10/" class="post-title-link" itemprop="url">Summary_2025_11_10</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-11-10 21:00:00 / 修改时间：14:58:52" itemprop="dateCreated datePublished" datetime="2025-11-10T21:00:00+08:00">2025-11-10</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Deep-Learning/" itemprop="url" rel="index"><span itemprop="name">Deep Learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          这是一篇加密文章
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/11/10/summary_11_10/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/11/10/5054_solution/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/10/5054_solution/" class="post-title-link" itemprop="url">5054-solution</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-11-10 21:00:00" itemprop="dateCreated datePublished" datetime="2025-11-10T21:00:00+08:00">2025-11-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-11-11 05:40:24" itemprop="dateModified" datetime="2025-11-11T05:40:24+08:00">2025-11-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-Learning/" itemprop="url" rel="index"><span itemprop="name">Machine Learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          这是一篇加密文章
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/11/10/5054_solution/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/11/08/GCL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/08/GCL/" class="post-title-link" itemprop="url">Code Review - Graph Contrastive Learning</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-11-08 21:00:00" itemprop="dateCreated datePublished" datetime="2025-11-08T21:00:00+08:00">2025-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-11-10 13:45:07" itemprop="dateModified" datetime="2025-11-10T13:45:07+08:00">2025-11-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Deep-Learning/" itemprop="url" rel="index"><span itemprop="name">Deep Learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          这是一篇加密文章
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/11/08/GCL/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/11/08/papers_11_8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/08/papers_11_8/" class="post-title-link" itemprop="url">Paper Overview</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-11-08 21:00:00 / 修改时间：16:32:43" itemprop="dateCreated datePublished" datetime="2025-11-08T21:00:00+08:00">2025-11-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/QM9-papers-collections/" itemprop="url" rel="index"><span itemprop="name">QM9 papers collections</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          这是一篇加密文章
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2025/11/08/papers_11_8/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/11/07/5120c9-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/07/5120c9-2/" class="post-title-link" itemprop="url">PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W9-2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-11-07 22:00:00 / 修改时间：19:01:30" itemprop="dateCreated datePublished" datetime="2025-11-07T22:00:00+08:00">2025-11-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHYS-5120/" itemprop="url" rel="index"><span itemprop="name">PHYS-5120</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>PHYS 5120 - 计算能源材料和电子结构模拟 Lecture</p>
<p><a target="_blank" rel="noopener" href="https://chem.hkust.edu.hk/people/ding-pan-panding">Lecturer:
Prof.PAN DING</a></p>
<p>在前面，我们看到了“理想”的<strong>无轨道 DFT
(OF-DFT)</strong>，它试图将能量 <span class="math inline">\(E\)</span>
直接写成密度 <span class="math inline">\(\rho\)</span> 的泛函 <span
class="math inline">\(E[\rho]\)</span>。但它失败了，因为我们无法找到一个足够精确的<strong>动能泛函
<span class="math inline">\(T[\rho]\)</span></strong>。</p>
<p>接下来介绍的是<strong>Kohn-Sham (KS)
DFT</strong>，它采用了一种“妥协”方案，彻底绕开了这个难题。</p>
<h3 id="概念回顾无轨道-dft-的困境">1. 概念回顾：无轨道 DFT 的困境</h3>
<p>首先回顾我们已知的（也是 OF-DFT 的）总能量泛函：</p>
<p><span class="math display">\[E[\rho] = \underbrace{T[\rho]}_{\text{①
动能}} + \int V_{ext}(\vec{r})\rho(\vec{r})d\vec{r} +
\underbrace{\frac{e^2}{2}\iint d\vec{r}d\vec{r}&#39;
\frac{\rho(\vec{r})\rho(\vec{r}&#39;)}{|\vec{r}-\vec{r}&#39;|}}_{\text{Hartree
能量}} + \underbrace{E_{xc}[\rho]}_{\text{② 交换关联能}}\]</span></p>
<ul>
<li><strong>问题所在：</strong>
<ul>
<li><strong>① <span class="math inline">\(T[\rho]\)</span>
(动能)：</strong>
这是最大的难题。动能是一个与波函数<strong>曲率</strong> (curvature)
相关的量子力学量 (<span class="math inline">\(\hat{T} \propto
\nabla^2\)</span>)。我们无法简单地通过密度 <span
class="math inline">\(\rho\)</span>（一个标量场）来精确描述它。前面推导的
<span class="math inline">\(T[\rho] \propto \int \rho^{5/3}
d\vec{r}\)</span> 只是一个非常粗糙的近似。</li>
<li><strong>② <span class="math inline">\(E_{xc}[\rho]\)</span>
(交换关联能)：</strong>
这是第二个难题。它包含了所有复杂的、非经典的电子-电子相互作用（泡利不相容原理的交换效应、电子相互躲避的关联效应）。</li>
</ul></li>
</ul>
<p>KS-DFT 的目标就是<strong>同时解决这两个问题</strong>。</p>
<h3 id="核心概念kohn-sham-辅助系统">2. 核心概念：Kohn-Sham 辅助系统</h3>
<p>Kohn-Sham 的核心思想是：“我承认 <span
class="math inline">\(T[\rho]\)</span>
太难了，所以我干脆<strong>不去近似它</strong>。”</p>
<blockquote>
<p><strong>Kohn-Sham 的核心假设：</strong>
对于<em>任何</em>一个我们关心的、有相互作用的<strong>真实系统</strong>（其基态密度为
<span
class="math inline">\(\rho_{true}\)</span>），我们<em>总能</em>构建一个<strong>虚构的
(fictitious)</strong>、<strong>无相互作用的</strong>辅助系统，这个系统被设计为<strong>恰好具有与真实系统完全相同的基态密度
<span class="math inline">\(\rho(\vec{r}) =
\rho_{true}(\vec{r})\)</span></strong>。</p>
</blockquote>
<p>这个想法彻底改变了规则。</p>
<ul>
<li><strong>公式 1：Kohn-Sham 哈密顿量 <span
class="math inline">\(\hat{H}_{KS}\)</span></strong>
<ul>
<li><code>Ĥ_KS = -ħ²/2m ∇² + V_KS(r)</code></li>
<li>这是一个描述 <span class="math inline">\(N\)</span>
个<strong>无相互作用</strong>电子的哈密顿量，它们都在一个共同的<strong>有效势
<span class="math inline">\(V_{KS}(\vec{r})\)</span></strong>
中运动。</li>
<li><strong>关键点：</strong>
这个哈密顿量中<strong>没有</strong>电子-电子相互作用项（如 <span
class="math inline">\(e^2/|\vec{r}_i -
\vec{r}_j|\)</span>）。这使得它在数学上变得极其简单。</li>
</ul></li>
<li><strong>公式 2：Kohn-Sham 波函数 <span
class="math inline">\(\Phi\)</span></strong>
<ul>
<li>一个斯莱特行列式：<code>Φ = 1/√N! | ... |</code></li>
<li><strong>详细解释：</strong> 由于 <span
class="math inline">\(\hat{H}_{KS}\)</span> 是 <span
class="math inline">\(N\)</span> 个无相互作用粒子的哈密顿量（<span
class="math inline">\(\hat{H}_{KS} = \sum_i
\hat{h}_i\)</span>），它的基态波函数 <span
class="math inline">\(\Phi\)</span>
可以被<strong>精确地</strong>写成一个由 <span
class="math inline">\(N\)</span> 个最低能量的单电子<strong>Kohn-Sham
轨道 <span class="math inline">\(\phi_i\)</span></strong>
构成的<strong>斯莱特行列式 (Slater Determinant)</strong>。</li>
<li>这些轨道 <span class="math inline">\(\phi_i\)</span>
是单粒子薛定谔方程（即 <strong>Kohn-Sham 方程</strong>）的解： <span
class="math display">\[\left( -\frac{\hbar^2}{2m}\nabla^2 +
V_{KS}(\vec{r}) \right) \phi_i(\vec{r}) = \epsilon_i
\phi_i(\vec{r})\]</span></li>
</ul></li>
</ul>
<h3 id="关键公式密度和动能">3. 关键公式：密度和动能</h3>
<p>现在，我们来看看这个“虚构系统”是如何帮我们解决问题的。</p>
<ul>
<li><strong>公式 3：KS 系统的电子密度 <span
class="math inline">\(\rho(\vec{r})\)</span></strong>
<ul>
<li><code>ρ(r) = ⟨Φ| Σ δ(r-ri) |Φ⟩ = Σ_&#123;i=1&#125;^N |φ_i|²</code></li>
<li><strong>详细解释：</strong>
<ul>
<li><code>⟨Φ| Σ δ(r-ri) |Φ⟩</code>：这是密度 <span
class="math inline">\(\rho(\vec{r})\)</span> 的标准量子力学定义，即“在
<span class="math inline">\(\vec{r}\)</span>
处找到<em>任意</em>一个电子的概率”。</li>
<li><code>= Σ_&#123;i=1&#125;^N |φ_i|²</code>：这是最关键的简化。对于一个斯莱特行列式波函数
<span
class="math inline">\(\Phi\)</span>，总的电子密度<strong>精确地等于</strong>所有被占据的
KS 轨道的概率密度之和。</li>
</ul></li>
<li><strong>KS 假设的重申：</strong> 我们假设存在一个 <span
class="math inline">\(V_{KS}(\vec{r})\)</span>，使得这个 <span
class="math inline">\(\rho(\vec{r})\)</span>
<strong>恒等于</strong>我们想研究的<strong>真实系统</strong>的密度 <span
class="math inline">\(\rho_{true}(\vec{r})\)</span>。</li>
</ul></li>
<li><strong>公式 4：无相互作用动能 <span
class="math inline">\(T_s[\rho]\)</span></strong>
<ul>
<li><code>Ts[ρ] = ⟨Φ| Σ -ħ²/2m ∇_i² |Φ⟩ = Σ_&#123;i=1&#125;^N ⟨φ_i| -ħ²/2m ∇² |φ_i⟩</code></li>
<li><strong>详细解释：</strong>
<ul>
<li><strong>这就是 KS 方案的全部意义！</strong></li>
<li>我们想知道这个虚构系统的总动能 <span
class="math inline">\(T_s\)</span> (s 代表 ‘single-particle’ 或
‘non-interacting’)。</li>
<li><span class="math inline">\(T_s = \langle \Phi | \hat{T} | \Phi
\rangle\)</span>。</li>
<li>与密度一样，由于 <span class="math inline">\(\Phi\)</span>
是斯莱特行列式，<span class="math inline">\(\hat{T}\)</span>
是单体算符，总动能<strong>精确地等于</strong>所有被占据的 KS
轨道的动能之和。</li>
</ul></li>
<li><strong>结论：</strong> 我们成功地<strong>避免了对 <span
class="math inline">\(T[\rho]\)</span>
的近似</strong>。我们现在不去近似它，而是通过求解 KS 轨道 <span
class="math inline">\(\phi_i\)</span>
来<strong>精确计算</strong>动能的主要部分 <span
class="math inline">\(T_s\)</span>。</li>
</ul></li>
</ul>
<h3 id="证明t_srho-与-t_truerho-的关系">4. “证明”：<span
class="math inline">\(T_s[\rho]\)</span> 与 <span
class="math inline">\(T_{true}[\rho]\)</span> 的关系</h3>
<p>提出了一个问题和一个潦草的证明：</p>
<ul>
<li><p><strong>问题：</strong> <code>Ts[ρ] ≤ T_true[ρ] ?</code></p>
<ul>
<li>我们通过轨道计算的<strong>无相互作用动能 <span
class="math inline">\(T_s\)</span></strong>
与<strong>真实系统</strong>的<strong>真正动能 <span
class="math inline">\(T_{true}\)</span></strong> 相比，哪个更大？</li>
</ul></li>
<li><p><strong>答案：<span class="math inline">\(T_s[\rho] \le
T_{true}[\rho]\)</span> 恒成立。</strong></p></li>
<li><p><strong>证明</strong>：</p>
<ul>
<li><code>Proof: ⟨Φ_ks| ...</code>
这里的字迹非常潦草，似乎是想用变分原理来论证，但写得并不清楚。</li>
</ul></li>
<li><p><strong>一个更清晰的、概念性的证明：</strong></p>
<ol type="1">
<li><span class="math inline">\(T_s[\rho]\)</span>
是一个<strong>无相互作用</strong>系统在密度为 <span
class="math inline">\(\rho\)</span> 时的基态动能。</li>
<li><span class="math inline">\(T_{true}[\rho]\)</span>
是一个<strong>有相互作用</strong>系统在密度为 <span
class="math inline">\(\rho\)</span> 时的基态动能。</li>
<li>在真实系统中，电子不仅受 <span
class="math inline">\(V_{ext}\)</span> 束缚，它们还必须<strong>相互排斥
(correlation)</strong>。为了“躲避”彼此，它们的波函数必须变得更加“弯曲”或“扭动”。</li>
<li>在量子力学中，<strong>动能 <span class="math inline">\(\propto \int
|\nabla \Psi|^2\)</span></strong>，它衡量的是波函数的“弯曲程度”。</li>
<li>真实电子为了相互躲避而增加的额外“弯曲”，导致了<strong>额外的动能</strong>。</li>
<li>因此，对于同一个密度 <span
class="math inline">\(\rho\)</span>，真实系统的动能 <span
class="math inline">\(T_{true}\)</span>
必然<strong>大于或等于</strong>那个不需要考虑相互躲避的、虚构的无相互作用系统的动能
<span class="math inline">\(T_s\)</span>。</li>
</ol></li>
<li><p><strong>这引出了最终的 KS-DFT 能量划分：</strong></p>
<ol type="1">
<li><p>真实动能 <span class="math inline">\(T_{true}\)</span>
被拆分为：<span class="math inline">\(T_{true}[\rho] = T_s[\rho] +
T_c[\rho]\)</span></p>
<ul>
<li><span
class="math inline">\(T_s[\rho]\)</span>：无相互作用动能（<strong>我们用轨道精确计算</strong>）。</li>
<li><span
class="math inline">\(T_c[\rho]\)</span>：<strong>动能的关联部分</strong>（<span
class="math inline">\(T_{true} - T_s\)</span>，这是个未知的小量）。</li>
</ul></li>
<li><p>现在，Kohn-Sham 方案将所有未知项——<span
class="math inline">\(T_c[\rho]\)</span> 和 <span
class="math inline">\(E_{xc}[\rho]\)</span>（来自 OF-DFT）——
<strong>全部打包</strong> 进一个<strong>新的</strong>交换关联泛函 <span
class="math inline">\(E_{xc}^{KS}[\rho]\)</span> 中。</p></li>
<li><p><strong>Kohn-Sham 总能量泛函：</strong> <span
class="math display">\[E[\rho] = \mathbf{T_s[\{\phi_i\}]} + \int
V_{ext}(\vec{r})\rho(\vec{r})d\vec{r} + E_H[\rho] +
\mathbf{E_{xc}^{KS}[\rho]}\]</span></p></li>
</ol></li>
</ul>
<p><strong>总结：</strong> KS-DFT
的赌注是：通过轨道<strong>精确计算</strong> <span
class="math inline">\(T_s\)</span>，剩下的那个包含 <span
class="math inline">\(T_c\)</span> 的<strong>新 <span
class="math inline">\(E_{xc}^{KS}[\rho]\)</span></strong>，会比原来那个包含整个
<span class="math inline">\(T_{true}\)</span> 的 OF-DFT
泛函<strong>容易得多</strong>。</p>
<p>历史证明，这个赌注赢了。</p>
<p><strong>现代 DFT 计算的核心——Kohn-Sham 方程</strong>。</p>
<p>它回答了两个终极问题： 1. 我们把所有“脏活累活”都塞进 <span
class="math inline">\(E_{xc}\)</span> (交换关联能) 里，那这个 <span
class="math inline">\(E_{xc}\)</span> <strong>到底是什么</strong>？ 2.
我们如何<strong>求解</strong>这个 KS 系统来找到轨道 <span
class="math inline">\(\phi_i\)</span> 和密度 <span
class="math inline">\(\rho\)</span>？</p>
<h3 id="概念e_xc-的正式定义-左侧">1. 概念：<span
class="math inline">\(E_{xc}\)</span> 的正式定义 (左侧)</h3>
<p>接下来给出了 Kohn-Sham 交换关联能 <span
class="math inline">\(E_{xc}\)</span>
的<strong>精确定义</strong>。它是一个“垃圾堆”泛函，包含了所有真实系统与虚构
KS 系统之间的差异。</p>
<ul>
<li><strong><span class="math inline">\(E_{xc}[\rho] = (T_{true}[\rho] -
T_s[\rho]) + (\langle \Psi_{true} | \hat{V}_{ee} | \Psi_{true} \rangle -
E_{Hartree}[\rho])\)</span></strong>
<ul>
<li><strong>第一部分：<span class="math inline">\((T_{true}[\rho] -
T_s[\rho])\)</span></strong>
<ul>
<li>这是<strong>动能的关联部分 <span
class="math inline">\(T_c\)</span></strong>。</li>
<li><span class="math inline">\(T_{true}\)</span>
是真实系统的（未知的）总动能。</li>
<li><span class="math inline">\(T_s\)</span> 是我们用 KS
轨道<strong>精确计算</strong>的无相互作用动能。</li>
<li><span class="math inline">\(E_{xc}\)</span>
必须包含这个动能差。</li>
</ul></li>
<li><strong>第二部分：<span class="math inline">\((\langle \Psi_{true} |
\hat{V}_{ee} | \Psi_{true} \rangle -
E_{Hartree}[\rho])\)</span></strong>
<ul>
<li>这是<strong>势能的交换与关联部分</strong>。</li>
<li><span class="math inline">\(\langle \Psi_{true} | \hat{V}_{ee} |
\Psi_{true} \rangle\)</span> 是真实系统中电子-电子相互作用 <span
class="math inline">\(\hat{V}_{ee}\)</span>
的完整（未知的）期望值。</li>
<li><span class="math inline">\(E_{Hartree}[\rho]\)</span>
是我们<strong>可以精确计算</strong>的经典静电排斥能（哈特里能量）。</li>
<li><span class="math inline">\(E_{xc}\)</span>
包含了真实相互作用与经典排斥之间的<strong>差值</strong>，这部分就是纯粹的量子效应（交换
+ 关联）。</li>
</ul></li>
</ul></li>
</ul>
<p><strong>一句话总结：<span class="math inline">\(E_{xc}\)</span>
包含了所有我们不知道的动能和势能的复杂量子效应。</strong></p>
<h3 id="核心公式kohn-sham-总能量">2. 核心公式：Kohn-Sham 总能量</h3>
<p>有了 <span class="math inline">\(E_{xc}\)</span> 的定义，Kohn-Sham
的<strong>总能量泛函</strong>现在可以被<strong>精确地</strong>（在形式上）写为：</p>
<p><span class="math display">\[E_{KS}[\rho] = \mathbf{T_s[\{\phi_i\}]}
+ \int d\vec{r} V_{ext}(\vec{r})\rho(\vec{r}) + \frac{1}{2}\iint
d\vec{r}d\vec{r}&#39;
\frac{\rho(\vec{r})\rho(\vec{r}&#39;)}{|\vec{r}-\vec{r}&#39;|} +
\mathbf{E_{xc}[\rho]}\]</span></p>
<ul>
<li><strong><span
class="math inline">\(T_s[\{\phi_i\}]\)</span></strong>：无相互作用动能（<strong>通过轨道精确计算</strong>）。</li>
<li><strong><span class="math inline">\(\int V_{ext}
\rho\)</span></strong>：外势能（例如原子核吸引，已知）。</li>
<li><strong><span class="math inline">\(\frac{1}{2}\iint
...\)</span></strong>：哈特里能量（经典静电排斥，已知）。</li>
<li><strong><span
class="math inline">\(E_{xc}[\rho]\)</span></strong>：交换关联能（<strong>这是唯一需要近似的部分！</strong>）。</li>
</ul>
<p><strong>这是整个 KS-DFT 的基石。</strong> 我们成功地将一个无法解决的
<span class="math inline">\(T_{true}\)</span>
问题，转化为了一个<strong>可以被近似</strong>的 <span
class="math inline">\(E_{xc}\)</span> 问题。</p>
<h3 id="推导kohn-sham-方程">3. 推导：Kohn-Sham 方程</h3>
<p>我们如何找到使 <span class="math inline">\(E_{KS}[\rho]\)</span>
最小的轨道 <span class="math inline">\(\phi_i\)</span> 呢？
答案是使用<strong>变分法</strong>：我们对总能量 <span
class="math inline">\(E_{KS}\)</span> 求关于轨道 <span
class="math inline">\(\phi_i^*\)</span> 的泛函导数，并令其为零。</p>
<ul>
<li><strong><span class="math inline">\(\frac{\delta}{\delta\phi_i^*}
\left( E_{KS}[\rho] - \sum_j \epsilon_j (\int |\phi_j|^2 d\vec{r} - 1)
\right) = 0\)</span></strong>
<ul>
<li>这就是带有<strong>约束条件</strong>（每个轨道必须归一化）的能量最小化。</li>
<li><span class="math inline">\(\epsilon_j\)</span>
是拉格朗日乘子。</li>
</ul></li>
<li><strong>对 <span class="math inline">\(E_{KS}\)</span>
的每一项求导：</strong>
<ul>
<li><span class="math inline">\(\frac{\delta
T_s}{\delta\phi_i^*}\)</span> <span
class="math inline">\(\rightarrow\)</span> <span
class="math inline">\(-\frac{\hbar^2}{2m}\nabla^2
\phi_i(\vec{r})\)</span></li>
<li><span class="math inline">\(\frac{\delta
E_{V_{ext}}}{\delta\phi_i^*}\)</span> <span
class="math inline">\(\rightarrow\)</span> <span
class="math inline">\(V_{ext}(\vec{r}) \phi_i(\vec{r})\)</span></li>
<li><span class="math inline">\(\frac{\delta
E_{Hartree}}{\delta\phi_i^*}\)</span> <span
class="math inline">\(\rightarrow\)</span> <span
class="math inline">\(\left( \int
\frac{\rho(\vec{r}&#39;)}{|\vec{r}-\vec{r}&#39;|} d\vec{r}&#39; \right)
\phi_i(\vec{r})\)</span> (即 <span
class="math inline">\(V_H(\vec{r})\phi_i(\vec{r})\)</span>)</li>
<li><span class="math inline">\(\frac{\delta
E_{xc}}{\delta\phi_i^*}\)</span> <span
class="math inline">\(\rightarrow\)</span> <span
class="math inline">\(\left( \frac{\delta E_{xc}}{\delta\rho} \right)
\phi_i(\vec{r})\)</span> (即 <span
class="math inline">\(V_{xc}(\vec{r})\phi_i(\vec{r})\)</span>)</li>
<li><span class="math inline">\(\frac{\delta
(\text{约束项})}{\delta\phi_i^*}\)</span> <span
class="math inline">\(\rightarrow\)</span> <span
class="math inline">\(\epsilon_i \phi_i(\vec{r})\)</span></li>
</ul></li>
<li><strong>把所有项合并，我们就得到了最终的 Kohn-Sham 方程：</strong>
<span class="math display">\[\left[ -\frac{\hbar^2}{2m}\nabla^2 +
V_{ext}(\vec{r}) + \int
\frac{\rho(\vec{r}&#39;)}{|\vec{r}-\vec{r}&#39;|} d\vec{r}&#39; +
V_{xc}(\vec{r}) \right] \phi_i(\vec{r}) = \epsilon_i
\phi_i(\vec{r})\]</span>
<ul>
<li><span
class="math inline">\(\epsilon_i\)</span>（拉格朗日乘子）的物理意义是
<strong>Kohn-Sham 轨道 <span class="math inline">\(\phi_i\)</span>
的能量</strong>。</li>
</ul></li>
</ul>
<h3 id="结论v_ks-的最终形式">4. 结论：<span
class="math inline">\(V_{KS}\)</span> 的最终形式</h3>
<p><strong>Kohn-Sham
方程</strong>本质上是一个<strong>单粒子薛定谔方程</strong>
<code>Ĥ_KS φ_i = ε_i φ_i</code>。</p>
<p>通过上面的推导，我们明确地找到了这个虚构的 <strong>Kohn-Sham 势 <span
class="math inline">\(V_{KS}\)</span></strong> 到底是什么：</p>
<p><span class="math display">\[V_{KS}(\vec{r}) = V_{ext}(\vec{r}) +
V_H(\vec{r}) + V_{xc}(\vec{r})\]</span></p>
<p><span class="math display">\[V_{KS}(\vec{r}) =
\underbrace{V_{ext}(\vec{r})}_{\text{原子核势}} + \underbrace{\int
\frac{\rho(\vec{r}&#39;)}{|\vec{r}-\vec{r}&#39;|}
d\vec{r}&#39;}_{\text{哈特里势 (经典排斥)}} + \underbrace{\frac{\delta
E_{xc}[\rho]}{\delta\rho}}_{\text{交换关联势 (量子效应)}}\]</span></p>
<h3 id="最终总结">最终总结</h3>
<p>这个方程完美地闭合了整个理论： * 我们想求解 <span
class="math inline">\(V_{KS}\)</span> 中的 <span
class="math inline">\(\phi_i\)</span>。 * 但 <span
class="math inline">\(V_{KS}\)</span> 本身又依赖于 <span
class="math inline">\(V_H\)</span> 和 <span
class="math inline">\(V_{xc}\)</span>。 * <span
class="math inline">\(V_H\)</span> 和 <span
class="math inline">\(V_{xc}\)</span> 又依赖于 <span
class="math inline">\(\rho\)</span>（密度）。 * 而 <span
class="math inline">\(\rho\)</span> 又是由 <span
class="math inline">\(\phi_i\)</span>（<span class="math inline">\(\rho
= \sum |\phi_i|^2\)</span>）构成的。</p>
<p>这是一个<strong>“鸡生蛋，蛋生鸡”</strong>的问题。
在实践中，我们必须通过<strong>自洽迭代 (self-consistent loop)</strong>
来求解： 1. <strong>猜测</strong>一个初始密度 <span
class="math inline">\(\rho_{in}\)</span>。 2. 用 <span
class="math inline">\(\rho_{in}\)</span> 计算 <span
class="math inline">\(V_H\)</span> 和 <span
class="math inline">\(V_{xc}\)</span>，得到 <span
class="math inline">\(V_{KS}\)</span>。 3. 求解 KS 方程 <span
class="math inline">\(\hat{H}_{KS} \phi_i = \epsilon_i \phi_i\)</span>
得到新的轨道 <span class="math inline">\(\phi_i\)</span>。 4. 用新的
<span class="math inline">\(\phi_i\)</span>
计算出<strong>新的密度</strong> <span class="math inline">\(\rho_{out} =
\sum |\phi_i|^2\)</span>。 5. 比较 <span
class="math inline">\(\rho_{out}\)</span> 和 <span
class="math inline">\(\rho_{in}\)</span>。如果它们不一致，就混合新旧密度，重复步骤
2。 6. 循环往复，直到 <span class="math inline">\(\rho_{out} =
\rho_{in}\)</span>，达到<strong>自洽</strong>，计算完成。</p>
<p>在前面，我们推导出了一切都取决于一个<strong>未知的</strong>、需要<strong>近似</strong>的能量项：<strong>交换关联泛函
<span class="math inline">\(E_{xc}[\rho]\)</span></strong>。</p>
<p>接下来展示的就是在实践中<strong>如何近似 <span
class="math inline">\(E_{xc}[\rho]\)</span></strong>
的两种最基本、最重要的方法：<strong>LDA</strong> 和
<strong>GGA</strong>。</p>
<h3 id="局域密度近似-local-density-approximation-lda">1. 局域密度近似
(Local Density Approximation, LDA)</h3>
<p>这是对 <span class="math inline">\(E_{xc}[\rho]\)</span>
最简单、最基础的近似。</p>
<ul>
<li><strong>图示：</strong>
白板左上角画了一个图：一个真实的、密度不均匀的分子（或固体），但在某一点
<span class="math inline">\(\vec{r}\)</span>
处，我们“假装”它周围是一片均匀的电子海洋（自由电子气）。</li>
<li><strong>核心思想 (LDA)：</strong> 系统在 <span
class="math inline">\(\vec{r}\)</span>
处的交换关联能量密度，<strong>仅仅</strong>取决于<strong>该点 <span
class="math inline">\(\vec{r}\)</span> 处的电子密度 <span
class="math inline">\(\rho(\vec{r})\)</span></strong>。
我们假设它与具有相同密度的<strong>均匀电子气 (free electron
gas)</strong> 的交换关联能量密度 <span
class="math inline">\(\epsilon_{xc}^{unif}(\rho)\)</span>
完全相同。</li>
<li><strong>公式 1：<span
class="math inline">\(E_{xc}^{LDA}[\rho]\)</span></strong> <span
class="math display">\[E_{xc}^{LDA}[\rho] = \int d\vec{r} \rho(\vec{r})
\epsilon_{xc}^{unif}(\rho(\vec{r}))\]</span>
<ul>
<li><strong><span
class="math inline">\(\epsilon_{xc}^{unif}(\rho)\)</span></strong>：这就是我们在<strong>第
3
张白板</strong>上推导过的<strong>均匀电子气</strong>的（单粒子）交换关联能量。这是一个已知的、关于
<span class="math inline">\(\rho\)</span>
的函数（通过量子蒙特卡洛等方法可以精确算出）。</li>
<li><strong><span
class="math inline">\(\rho(\vec{r})\)</span></strong>：该点的电子密度。</li>
<li><strong>含义：</strong> 我们在空间中逐点计算该点的 <span
class="math inline">\(\rho\)</span> 对应的 <span
class="math inline">\(\epsilon_{xc}\)</span>，然后乘以该点的密度 <span
class="math inline">\(\rho\)</span>，最后在整个空间积分（求和）。</li>
</ul></li>
<li><strong>公式 2：<span class="math inline">\(V_{xc}^{LDA}\)</span>
(交换关联势)</strong> <span class="math display">\[V_{xc} = \frac{\delta
E_{xc}}{\delta \rho} = \epsilon_{xc}(\rho, \vec{r}) + \rho(\vec{r})
\frac{\partial \epsilon_{xc}}{\partial \rho}\]</span>
<ul>
<li>这是将 <span class="math inline">\(E_{xc}^{LDA}\)</span>
代入我们在<strong>第 5 张白板</strong>上定义的 <span
class="math inline">\(V_{xc} = \delta E_{xc} / \delta \rho\)</span>
中，通过链式法则推导出来的结果。</li>
</ul></li>
<li><strong>“Perdew-Zunger (1981)”</strong>
<ul>
<li>这是一个<strong>具体的 LDA 泛函</strong>的名称。Perdew 和 Zunger 在
1981 年利用高精度的均匀电子气数据（来自 Ceperley-Alder 的 QMC
计算），拟合出了一套非常精确和实用的 <span
class="math inline">\(\epsilon_{xc}^{unif}(\rho)\)</span>
参数化公式。这至今仍是 LDA 计算的标准。</li>
</ul></li>
</ul>
<h3 id="广义梯度近似-generalized-gradient-approximation-gga">2.
广义梯度近似 (Generalized-Gradient Approximation, GGA)</h3>
<p>LDA 假设在 <span class="math inline">\(\vec{r}\)</span>
处的能量只取决于 <span
class="math inline">\(\rho(\vec{r})\)</span>，这是一个<strong>非常强</strong>（且通常不正确）的假设。真实系统（如分子）的密度变化非常快。</p>
<ul>
<li><strong>核心思想 (GGA)：</strong>
一个更智能的近似，不仅要考虑<strong>该点的密度 <span
class="math inline">\(\rho(\vec{r})\)</span></strong>，还应该考虑<strong>该点密度的变化率</strong>，即<strong>梯度的模
<span class="math inline">\(|\nabla\rho|\)</span></strong>。
<ul>
<li>如果 <span class="math inline">\(|\nabla\rho|\)</span>
很大，说明密度变化剧烈（如在分子键合区域或原子边缘），<span
class="math inline">\(\epsilon_{xc}\)</span> 应该与 LDA 不同。</li>
</ul></li>
<li><strong>公式 3：<span
class="math inline">\(E_{xc}^{GGA}[\rho^\uparrow,
\rho^\downarrow]\)</span></strong> <span
class="math display">\[E_{xc}^{GGA}[\rho^\uparrow, \rho^\downarrow] =
\int d\vec{r} \rho(\vec{r}) \epsilon_{xc}(\rho^\uparrow,
\rho^\downarrow, |\nabla\rho^\uparrow|, |\nabla\rho^\downarrow|,
\vec{r})\]</span>
<ul>
<li><strong><span class="math inline">\(\rho^\uparrow,
\rho^\downarrow\)</span></strong>：自旋向上和自旋向下的电子密度（更完整的表述）。</li>
<li><strong><span class="math inline">\(|\nabla\rho^\uparrow|,
|\nabla\rho^\downarrow|\)</span></strong>：<strong>新加入的项！</strong>
密度梯度的信息被包含了进来。</li>
<li><strong><span
class="math inline">\(\epsilon_{xc}(...)\)</span></strong>：现在是一个更复杂的函数，它不仅是
<span class="math inline">\(\rho\)</span> 的函数，还是 <span
class="math inline">\(|\nabla\rho|\)</span> 的函数。</li>
</ul></li>
<li><strong>“PBE”, “BLYP” …</strong>
<ul>
<li>这些都是<strong>具体的 GGA 泛函</strong>的名称。它们就像 <span
class="math inline">\(\epsilon_{xc}\)</span> 的不同“配方”。</li>
<li><strong>BLYP</strong> = Becke (交换) + Lee, Yang, Parr (关联)。</li>
<li><strong>PBE</strong> = Perdew, Burke, Ernzerhof。</li>
<li>PBE 和 BLYP 是化学和材料科学中<strong>最常用、最成功</strong>的 GGA
泛函之二。</li>
</ul></li>
</ul>
<p>接下来介绍的是“Jacob’s Ladder”（DFT
近似的雅各天梯）的更高几层：<strong>meta-GGA</strong> 和 <strong>Hybrid
functionals (混合泛函)</strong>。</p>
<h3 id="密度泛函近似-dfa">1. 密度泛函近似 (DFA)</h3>
<ul>
<li><strong>DFA (Density Functional Approximation):</strong>
<ul>
<li>这是一个总称，泛指我们对 <span
class="math inline">\(E_{xc}[\rho]\)</span>（交换关联泛函）所做的<strong>所有近似</strong>，包括
LDA, GGA 等。</li>
</ul></li>
</ul>
<h3 id="meta-gga">2. Meta-GGA</h3>
<p>这是超越 GGA 的“天梯”的下一级。</p>
<ul>
<li><strong><span class="math inline">\(\Delta\)</span> meta
GGA:</strong>
<ul>
<li><strong>核心思想：</strong> GGA 只用了 <span
class="math inline">\(\rho\)</span>（密度）和 <span
class="math inline">\(|\nabla\rho|\)</span>（密度梯度）。为了获得更高精度，meta-GGA
引入了<strong>第三种信息</strong>。</li>
<li><strong>成分：<span class="math inline">\(\rho, |\nabla\rho|,
\nabla^2\rho? |\nabla\phi_i|^2\)</span></strong>
<ul>
<li><span class="math inline">\(\rho\)</span> (密度)</li>
<li><span class="math inline">\(|\nabla\rho|\)</span> (密度梯度)</li>
<li><code>∇²ρ?</code> (密度的拉普拉斯，一种可能的成分)</li>
<li><strong><span
class="math inline">\(|\nabla\phi_i|^2\)</span></strong> (Kohn-Sham
轨道的动能密度 <span class="math inline">\(\tau\)</span>)：这是现代
meta-GGA
泛函中<strong>最关键</strong>的成分。它使得泛函<strong>间接地</strong>依赖于轨道，从而能“感知”更复杂的电子结构信息（例如，区分是单键、双键还是孤对电子）。</li>
</ul></li>
</ul></li>
<li><strong>“SCAN”</strong>
<ul>
<li>这是一个<strong>具体的 meta-GGA
泛函</strong>的名称，是目前最流行、最成功的 meta-GGA 之一。</li>
</ul></li>
</ul>
<h3 id="一个关键问题自相互作用误差-sie">3. 一个关键问题：自相互作用误差
(SIE)</h3>
<p>为什么我们需要更高级的泛函？因为 LDA 和 GGA
有一个<strong>根本性的缺陷</strong>。</p>
<ul>
<li><strong>“self-interaction error” (自相互作用误差, SIE):</strong>
<ul>
<li><strong>问题来源：</strong> 在 DFT 中，一个电子的密度 <span
class="math inline">\(\rho\)</span> 是其自身的总密度 <span
class="math inline">\(\rho\)</span> 的一部分。在计算哈特里能量 <span
class="math inline">\(E_H[\rho] \propto \iint \rho \rho&#39;
...\)</span>
时，这个电子<strong>错误地与它自己</strong>产生了静电排斥。</li>
<li><strong>本应：</strong> <span
class="math inline">\(E_{xc}\)</span>（交换能）应该<strong>完美地抵消</strong>掉这个虚假的自排斥。</li>
<li><strong>现实：</strong> <strong>LDA 和 GGA
泛函都未能</strong>完美抵消它。</li>
</ul></li>
<li><strong>“charge too delocalized” (电荷过度离域):</strong>
<ul>
<li><strong>后果：</strong>
由于电子错误地“排斥”自己，系统为了降低能量，会倾向于将电子“涂抹”或“离域”
(delocalize) 到尽可能大的空间中，以减小这种虚假的自排斥。</li>
<li><strong>图示：</strong> 白板上的山峰（或势垒）图示说明：SIE
导致电荷在过渡态的局域化（电子集中在某处）变得困难，因此 LDA/GGA
总是<strong>低估</strong>化学反应的<strong>能垒</strong>。</li>
<li><strong>“Cl- — nH₂O”</strong>
<ul>
<li>这是一个具体例子：一个 Cl⁻ 离子被水分子包围。LDA/GGA 会错误地将 Cl⁻
上的负电荷“泄露”或“离域”到周围的水分子上，从而导致错误的体系结构和能量。</li>
</ul></li>
</ul></li>
</ul>
<h3 id="解决方案混合泛函-hybrid-functional">4. 解决方案：混合泛函
(Hybrid Functional)</h3>
<p>这是“天梯”的第四级，是目前在化学计算中<strong>最标准、最常用</strong>的高精度方法。</p>
<ul>
<li><strong><span class="math inline">\(\Delta\)</span> Hybrid
functional:</strong>
<ul>
<li><strong>核心思想：</strong> 如何修复 SIE？
<ul>
<li>我们知道，在 <strong>Hartree-Fock (HF) 理论</strong>中，其“交换能”
<span class="math inline">\(E_x^{HF}\)</span>
是通过轨道<strong>精确计算</strong>的，并且它<strong>完美地</strong>抵消了自相互作用。</li>
<li><strong>混合 (Hybrid) 思想：</strong> 让我们把 DFT (如 PBE)
的交换项拿掉一部分，<strong>替换</strong>为同一比例的“精确”的 HF
交换项。</li>
</ul></li>
</ul></li>
<li><strong>“PBE0” (一个具体的混合泛函名称):</strong>
<ul>
<li>这是最著名的混合泛函之一。</li>
<li><strong><span class="math inline">\(E_{xc} = \frac{1}{4} E_x^{HF} +
\frac{3}{4} E_x^{PBE} + E_c^{PBE}\)</span></strong></li>
<li><strong>公式分解：</strong>
<ul>
<li><strong><span class="math inline">\(\frac{1}{4}
E_x^{HF}\)</span></strong>：用 <strong>25%</strong> 的<strong>精确 HF
交换</strong>。</li>
<li><strong><span class="math inline">\(\frac{3}{4}
E_x^{PBE}\)</span></strong>：用 <strong>75%</strong> 的 <strong>PBE
(GGA) 交换</strong>。</li>
<li><strong><span class="math inline">\(E_c^{PBE}\)</span></strong>：用
<strong>100%</strong> 的 <strong>PBE (GGA) 关联</strong>。</li>
</ul></li>
<li><strong>效果：</strong> 引入 25%
的精确交换，极大地<strong>纠正</strong>了自相互作用误差
(SIE)，使其在计算能垒、带隙、分子性质等方面远比纯 GGA 准确。</li>
</ul></li>
</ul>
<p>接下来介绍了当今计算化学和材料科学中<strong>最先进、最常用</strong>的几种高级泛函。</p>
<p><strong>混合泛函 (Hybrid functional) 家族的“动物园”</strong>——
它们是如何被构建的，以及它们各自解决了什么问题。</p>
<h3 id="b3lyp-最著名的经验混合泛函">1. B3LYP (最著名的经验混合泛函)</h3>
<ul>
<li><strong><span class="math inline">\(\Delta\)</span> B3LYP:</strong>
<ul>
<li>这是<strong>最著名</strong>的混合泛函之一，特别是在量子化学领域。</li>
<li>它的构造是<strong>半经验的
(semi-empirical)</strong>，意味着它的混合参数是由拟合（fitting）一组精确的实验/基准化学数据（如分子的原子化热）而确定的。</li>
</ul></li>
<li><strong>公式：</strong> <span class="math display">\[E_{xc} =
E_x^{LDA} + a_0(E_x^{HF} - E_x^{LDA}) + a_x(E_x^{Becke} - E_x^{LDA}) +
E_c^{LDA} + a_c(E_c^{LYP} - E_c^{LDA})\]</span></li>
<li><strong>解释：</strong>
<ul>
<li>B3LYP (Becke, 3-parameter, Lee-Yang-Parr)
是一个复杂的“鸡尾酒”。</li>
<li>它混合了 <strong>LDA</strong> 的交换和关联、<strong>Hartree-Fock
(HF)</strong> 的精确交换，以及 <strong>GGA</strong> 的交换 (Becke88)
和关联 (LYP)。</li>
<li><code>a_0</code>, <code>a_x</code>, <code>a_c</code>
是三个被拟合的参数，用于确定每种成分的“配比”。</li>
</ul></li>
</ul>
<h3 id="自洽混合泛函-self-consistent-hybrid">2. 自洽混合泛函
(Self-consistent hybrid)</h3>
<ul>
<li><strong><span class="math inline">\(\Delta\)</span> Self-consistent
hybrid:</strong>
<ul>
<li><strong>思想：</strong> 与其像 PBE0（固定 25%）或
B3LYP（经验拟合）那样<em>指定</em>一个混合参数 <span
class="math inline">\(\alpha\)</span>，我们是否能从<strong>第一性原理
(ab initio)</strong> 出发，让系统<strong>自己决定</strong>应该混合多少
HF 交换？</li>
</ul></li>
<li><strong>公式：</strong>
<ul>
<li><span class="math inline">\(E_{xc} = \alpha E_x^{HF} + (1-\alpha)
E_x^{GGA} + E_c^{GGA}\)</span> (这与 PBE0 的形式相同)</li>
</ul></li>
<li><strong>关键创新：</strong>
<ul>
<li><strong><span class="math inline">\(\alpha =
\frac{1}{\epsilon_\infty}\)</span></strong></li>
<li><strong>解释：</strong> 混合比例 <span
class="math inline">\(\alpha\)</span> 被设定为材料<strong>高频介电常数
<span class="math inline">\(\epsilon_\infty\)</span>
的倒数</strong>。</li>
<li><strong>物理意义：</strong> <span
class="math inline">\(\epsilon_\infty\)</span>
描述了材料中电子<strong>屏蔽 (screening)</strong> 库仑相互作用的能力。
<ul>
<li>绝缘体/半导体：<span class="math inline">\(\epsilon_\infty\)</span>
较小（例如 2-10），<span class="math inline">\(\alpha\)</span>
较大（例如 10-50%），需要更多 HF 交换来打开带隙。</li>
<li>金属：<span class="math inline">\(\epsilon_\infty \to
\infty\)</span>，<span class="math inline">\(\alpha \to
0\)</span>，不需要 HF 交换（退化为纯 GGA）。</li>
</ul></li>
<li>这是一个<strong>自洽</strong>过程：<span
class="math inline">\(\alpha\)</span> 决定了电子结构，而电子结构（通过
<code>GW</code> 等理论）又决定了 <span
class="math inline">\(\epsilon_\infty\)</span>。</li>
</ul></li>
</ul>
<h3 id="范围分离混合泛函-range-separated-hybrid">3. 范围分离混合泛函
(Range-separated hybrid)</h3>
<ul>
<li><strong><span class="math inline">\(\Delta\)</span> Range-separated
hybrid:</strong>
<ul>
<li><strong>思想：</strong> 电子-电子排斥 <span
class="math inline">\(1/r\)</span>
在短距离和长距离下表现不同。也许我们不需要“一刀切”的混合。</li>
<li><strong>策略：</strong> 将 <span class="math inline">\(1/r\)</span>
分割为<strong>短程 (short-range, SR)</strong> 和<strong>长程
(long-range, LR)</strong>
两部分，并对它们使用<strong>不同</strong>的泛函。</li>
<li>旁边的涂鸦 <code>... ~ ...</code> 和
<code>screening</code>（屏蔽）形象地说明了这种思想：在长程，相互作用被“屏蔽”了。</li>
</ul></li>
<li><strong>公式 (以 HSE06 为例):</strong>
<ul>
<li>白板上写了 <code>HSE06'</code>（HSE 泛函的 2006
年版本），并给出了其参数：</li>
<li><strong><span class="math inline">\(\alpha = 0, \beta =
1/4\)</span></strong> (代入白板上那个复杂的通用公式)</li>
</ul></li>
<li><strong>HSE06 泛函的通俗解释：</strong>
<ul>
<li>它将 PBE (GGA) 泛函的<strong>交换部分 <span
class="math inline">\(E_x^{PBE}\)</span></strong> 进行了范围分离：</li>
<li><strong>在短程 (SR):</strong> <span class="math inline">\(E_x =
\frac{1}{4} E_x^{HF,SR} + \frac{3}{4} E_x^{PBE,SR}\)</span>
<ul>
<li>(在短距离内，它是一个 PBE0 泛函，混合了 25% 的 HF 精确交换)</li>
</ul></li>
<li><strong>在长程 (LR):</strong> <span class="math inline">\(E_x =
E_x^{PBE,LR}\)</span>
<ul>
<li>(在长距离处，它退化为 100% 的 PBE 纯 GGA 交换)</li>
</ul></li>
<li><strong>关联部分 <span class="math inline">\(E_c\)</span></strong>
始终是 100% 的 PBE 关联。</li>
</ul></li>
<li><strong>为什么这样做？</strong>
<ul>
<li><strong>物理上：</strong> 修正了长程的自相互作用误差。</li>
<li><strong>计算上：</strong> 在<strong>固体 (solid)</strong>
计算中<strong>极其重要</strong>。HF
交换的计算量非常大，尤其是在长程。HSE
泛函通过在长程<strong>关闭</strong>HF
交换（即“屏蔽”它），使得计算<strong>速度</strong>大幅提升，同时保留了混合泛函在短程（如化学键）的<strong>高精度</strong>。</li>
</ul></li>
</ul>
<h3 id="总结">总结</h3>
<ol type="1">
<li><strong>1 (HK 定理):</strong> 奠定了<strong>理论基石</strong>——
<span class="math inline">\(E = E[\rho]\)</span>。</li>
<li><strong>2 (OF-DFT):</strong> 提出了<strong>理想</strong>的无轨道
DFT，并指出了其 <span class="math inline">\(T[\rho]\)</span>
的<strong>困难</strong>。</li>
<li><strong>3 (自由电子气):</strong> <strong>推导</strong>了 <span
class="math inline">\(T[\rho]\)</span> 的<strong>最简近似</strong> <span
class="math inline">\(T \propto \int \rho^{5/3}\)</span>。</li>
<li><strong>4 (OF-DFT 求解):</strong>
展示了如何通过<strong>变分法</strong> <span class="math inline">\(\delta
E / \delta \rho = \mu\)</span> 求解 <span
class="math inline">\(\rho_0\)</span>。</li>
<li><strong>5 (Kohn-Sham):</strong> 引入了<strong>实用方案
(KS-DFT)</strong>，用“轨道” <span class="math inline">\(\phi_i\)</span>
<strong>精确计算</strong>动能 <span
class="math inline">\(T_s\)</span>，将未知项塞入 <span
class="math inline">\(E_{xc}\)</span>。</li>
<li><strong>6 (LDA/GGA):</strong> 展示了如何<strong>近似 <span
class="math inline">\(E_{xc}\)</span></strong>（“雅各天梯”的第一、二层），即
LDA（依赖 <span class="math inline">\(\rho\)</span>）和 GGA（依赖 <span
class="math inline">\(\rho, |\nabla\rho|\)</span>）。</li>
<li><strong>7 (Meta-GGA / Hybrid):</strong> 攀登天梯的更高层 (Meta-GGA,
Hybrid-PBE0)，并指出了 LDA/GGA
的<strong>根本缺陷</strong>（自相互作用误差 SIE）。</li>
<li><strong>8 (B3LYP / HSE):</strong>
展示了<strong>最先进的泛函</strong> (B3LYP, HSE06)
是如何通过经验拟合或范围分离等技巧，在精度和计算效率之间达到最佳平衡的。</li>
</ol>
<p>这完整地勾勒出了 DFT 从 1960
年代的抽象理论到当今最前沿的计算工具的整个发展脉络。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/11/07/5120c9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/07/5120c9/" class="post-title-link" itemprop="url">PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W9-1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-11-07 21:00:00 / 修改时间：17:17:51" itemprop="dateCreated datePublished" datetime="2025-11-07T21:00:00+08:00">2025-11-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHYS-5120/" itemprop="url" rel="index"><span itemprop="name">PHYS-5120</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>PHYS 5120 - 计算能源材料和电子结构模拟 Lecture</p>
<p><a target="_blank" rel="noopener" href="https://chem.hkust.edu.hk/people/ding-pan-panding">Lecturer:
Prof.PAN DING</a></p>
<p><strong>密度泛函理论 (Density Functional Theory, DFT)</strong>
的核心概念笔记，这是一种在物理和化学领域，特别是量子化学和凝聚态物理中，用于研究多电子体系电子结构的计算方法。</p>
<h3 id="密度泛函理论-density-functional-theory">密度泛函理论 (Density
Functional Theory)</h3>
<ul>
<li><strong>N-electron (N 电子体系):</strong>
<ul>
<li>波函数 (Wavefunction): <span class="math inline">\(\Psi(\vec{r}_1,
\vec{r}_2, ..., \vec{r}_N): \mathbb{R}^{3N} \to \mathbb{C}\)</span>
<ul>
<li>这是一个包含 N 个电子的体系，其波函数 <span
class="math inline">\(\Psi\)</span> 是 <span
class="math inline">\(3N\)</span>
个空间坐标（每个电子有3个坐标）的函数，值域为复数 <span
class="math inline">\(\mathbb{C}\)</span>。这是一个非常高维度的复杂函数。</li>
</ul></li>
<li>电子密度 (Electron density): <span
class="math inline">\(\rho(\vec{r}): \mathbb{R}^3 \to
\mathbb{R}\)</span>
<ul>
<li>电子密度 <span class="math inline">\(\rho\)</span> 只是空间中一点
<span
class="math inline">\(\vec{r}\)</span>（3个坐标）的函数，值域为实数
<span class="math inline">\(\mathbb{R}\)</span>。</li>
<li>DFT 的核心思想就是用这个更简单的 <span
class="math inline">\(\rho(\vec{r})\)</span> 来代替复杂的 <span
class="math inline">\(\Psi\)</span> 作为基本变量。</li>
</ul></li>
</ul></li>
<li><strong>H.K. (Hohenberg-Kohn) 定理:</strong>
<ul>
<li>这是 DFT 的理论基石。白板上的图示 ① 和 ② 总结了这两个定理。</li>
<li><strong>图示 ① (H.K. 第一定理):</strong>
<ul>
<li><code>Vext/H</code> <span
class="math inline">\(\leftrightarrow\)</span> <code>ρ(r)</code> <span
class="math inline">\(\leftrightarrow\)</span>
<code>Ψi(r1, r2, ...)</code></li>
<li><strong>含义:</strong> 体系的外势 <span
class="math inline">\(V_{ext}\)</span>
（通常指原子核对电子的吸引势，它决定了体系的哈密顿量 <span
class="math inline">\(H\)</span>）与基态电子密度 <span
class="math inline">\(\rho(\vec{r})\)</span> 之间存在一一对应关系。</li>
<li><strong>推论:</strong> 由于 <span
class="math inline">\(V_{ext}\)</span> 决定了波函数 <span
class="math inline">\(\Psi\)</span>，因此，基态电子密度 <span
class="math inline">\(\rho_0\)</span> 唯一地决定了基态波函数 <span
class="math inline">\(\Psi_0\)</span> 以及体系的所有性质。</li>
</ul></li>
<li><strong>图示 ② (H.K. 第二定理):</strong>
<ul>
<li><code>min E[ρ(r)] → ρ₀, Egs</code></li>
<li><strong>含义:</strong> 能量泛函 <span
class="math inline">\(E[\rho]\)</span>
（能量是电子密度的函数）在正确的基态密度 <span
class="math inline">\(\rho_0\)</span>
处取得最小值，这个最小值就是体系的基态能量 <span
class="math inline">\(E_{gs}\)</span>。</li>
</ul></li>
</ul></li>
<li><strong>Levy-Lieb 泛函 (Levy-Lieb functional):</strong>
<ul>
<li>也称为 <strong>Levy 约束搜索 (constrained search)
泛函</strong>。这是对 H.K. 定理中能量泛函 <span
class="math inline">\(E[\rho]\)</span> 的一种更严格和普适的定义。</li>
<li><code>ρ ← Vext : v-representability</code>
<ul>
<li>这提出了一个问题：什么样的密度 <span
class="math inline">\(\rho\)</span> 可以对应于某个外势 <span
class="math inline">\(V_{ext}\)</span>？这被称为“v-可表征性”问题。</li>
</ul></li>
<li><code>Δ</code> (三角符号通常表示 “定义为”)</li>
<li><code>N</code> (圆圈) <span class="math inline">\(\supset\)</span>
<code>K</code> (圆圈)
<ul>
<li><em>这个符号旁边的字迹有些潦草，但结合上下文，这可能是在区分
N-representability（N-可表征性）和
v-representability（v-可表Vext表征性）。</em></li>
</ul></li>
</ul></li>
</ul>
<h3 id="能量泛函与计算">能量泛函与计算</h3>
<ul>
<li><strong>约束搜索 (Constrained search):</strong>
<ul>
<li><span class="math inline">\(\int \rho(\vec{r}) d\vec{r} = N\)</span>
<ul>
<li>这是一个约束条件，即电子密度在全空间积分必须等于体系的总电子数 <span
class="math inline">\(N\)</span>。</li>
</ul></li>
</ul></li>
<li><strong>① 能量泛函 <span class="math inline">\(E_{LL}[\rho]\)</span>
(Levy-Lieb):</strong>
<ul>
<li><span class="math inline">\(E_{LL}[\rho] = \min_{\Psi \to \rho}
\langle \Psi | \hat{T} + \hat{V}_{ee} | \Psi \rangle + \int d\vec{r}
V_{ext}(\vec{r}) \rho(\vec{r})\)</span></li>
<li><strong>解释:</strong>
<ul>
<li>这个公式定义了总能量 <span class="math inline">\(E\)</span>
如何作为密度 <span class="math inline">\(\rho\)</span> 的泛函。</li>
<li>它分为两部分：
<ol type="1">
<li><span class="math inline">\(\int d\vec{r} V_{ext}(\vec{r})
\rho(\vec{r})\)</span>: 电子在外势 <span
class="math inline">\(V_{ext}\)</span> 中的能量。这部分是已知的（如果
<span class="math inline">\(V_{ext}\)</span> 和 <span
class="math inline">\(\rho\)</span> 已知）。</li>
<li><span class="math inline">\(\min_{\Psi \to \rho} \langle \Psi |
\hat{T} + \hat{V}_{ee} | \Psi \rangle\)</span>: 这是
<strong>Hohenberg-Kohn 泛函</strong> <span
class="math inline">\(F_{HK}[\rho]\)</span>（也常被称为 Levy-Lieb
泛函），它代表动能 <span class="math inline">\(\hat{T}\)</span>
和电子-电子相互作用能 <span class="math inline">\(\hat{V}_{ee}\)</span>
的总和。</li>
</ol></li>
<li><strong>约束搜索 (min <span class="math inline">\(\Psi \to
\rho\)</span>)</strong>： <span
class="math inline">\(F_{HK}[\rho]\)</span>
的值是通过搜索所有能够产生该密度 <span
class="math inline">\(\rho\)</span> 的波函数 <span
class="math inline">\(\Psi\)</span>，并从中找出使 <span
class="math inline">\(\langle \hat{T} + \hat{V}_{ee} \rangle\)</span>
最小的那个 <span class="math inline">\(\Psi\)</span> 来确定的。这个泛函
<span class="math inline">\(F_{HK}[\rho]\)</span> 是<strong>普适
(Universal)</strong> 的，因为它不依赖于 <span
class="math inline">\(V_{ext}\)</span>。</li>
</ul></li>
</ul></li>
<li><strong>② 求解基态 (Finding the Ground State):</strong>
<ul>
<li><span class="math inline">\(E_{gs} = \min_{\rho}
E_{LL}[\rho]\)</span>
<ul>
<li><strong>含义 (H.K. 第二定理的变分原理):</strong> 体系的基态能量
<span class="math inline">\(E_{gs}\)</span> 可以通过最小化总能量泛函
<span class="math inline">\(E_{LL}[\rho]\)</span> 来获得。</li>
</ul></li>
<li><span class="math inline">\(\rho_0 \to \{\Psi_0^{(1)}, \Psi_0^{(2)},
...\} \Rightarrow V_{ext}\)</span>
<ul>
<li><strong>含义:</strong> 当找到最优的基态密度 <span
class="math inline">\(\rho_0\)</span> 时，我们就同时确定了基态能量 <span
class="math inline">\(E_{gs}\)</span>。通过这个 <span
class="math inline">\(\rho_0\)</span>（以及它对应的波函数集合），原则上也可以反推出唯一确定它的外势
<span class="math inline">\(V_{ext}\)</span>。</li>
</ul></li>
</ul></li>
</ul>
<h3 id="其他笔记">其他笔记</h3>
<ul>
<li><strong><span class="math inline">\(p_i \propto e^{-\beta E_i /
Z}\)</span> finite temperature</strong>
<ul>
<li>这是白板右下角的一行字，与上面的 DFT 主题略有不同。</li>
<li><strong>含义:</strong> 这描述的是<strong>有限温度 (finite
temperature)</strong> 下的<strong>正则系综 (canonical
ensemble)</strong>。</li>
<li><span class="math inline">\(p_i\)</span> 是体系处于能量为 <span
class="math inline">\(E_i\)</span> 的某个状态的概率。</li>
<li><span class="math inline">\(\beta = 1 / (k_B T)\)</span>，<span
class="math inline">\(k_B\)</span> 是玻尔兹曼常数，<span
class="math inline">\(T\)</span> 是温度。</li>
<li><span class="math inline">\(Z\)</span> 是配分函数 (Partition
function)。</li>
<li>这个公式（玻尔兹曼分布）是统计力学的基础，用于将 DFT 推广到 <span
class="math inline">\(T &gt; 0\)</span> K 的情况（即 Mermin
泛函）。</li>
</ul></li>
</ul>
<h3 id="总结">总结</h3>
<p>总结了密度泛函理论 (DFT) 的数学和物理基础，从 Hohenberg-Kohn
定理（能量和密度的一一对应及变分原理）讲到了 Levy-Lieb
的约束搜索构造方法，这是现代 DFT
理论的核心。右下角的笔记则暗示了如何将此理论推广到有限温度体系。</p>
<p>这是（基态 DFT）内容的延续，主题是<strong>有限温度和系综 DFT (Finite
temperature and ensemble DFT)</strong>，以及<strong>无轨道 DFT
(Orbital-free DFT)</strong>。</p>
<p>以下是白板上内容的逐条中文转录和解释：</p>
<h3 id="有限温度和系综-dft-mermin-dft">有限温度和系综 DFT (Mermin
DFT)</h3>
<p>这部分内容将 DFT 从 <span
class="math inline">\(T=0\text{K}\)</span>（绝对零度，只关心基态）推广到
<span class="math inline">\(T &gt;
0\text{K}\)</span>（有限温度，需要考虑热激发和系综平均）。</p>
<ul>
<li><strong>对比 <span class="math inline">\(T=0\text{K}\)</span> 和
<span class="math inline">\(T\)</span> finite (有限温度):</strong>
<ul>
<li><strong><span class="math inline">\(T=0K\)</span> (左栏):</strong>
<ul>
<li><span class="math inline">\(\rho_0\)</span> (基态密度)</li>
<li><span class="math inline">\(|\Psi\rangle\)</span> (基态波函数)</li>
<li><span class="math inline">\(\langle \hat{O} \rangle = \langle \Psi |
\hat{O} | \Psi \rangle\)</span> (零温下的期望值)</li>
</ul></li>
<li><strong><span class="math inline">\(T\)</span> finite
(中栏):</strong>
<ul>
<li><span class="math inline">\(p_e\)</span> (系综密度 /
热力学密度)</li>
<li><span class="math inline">\(\hat{\rho} = \sum_i f_i
|\Psi_i\rangle\langle\Psi_i|\)</span> (密度矩阵)</li>
<li><span class="math inline">\(\langle \hat{O} \rangle =
\text{Tr}(\hat{\rho}\hat{O})\)</span>
(有限温度下的期望值，即系综平均)</li>
</ul></li>
</ul></li>
<li><strong>Mermin 泛函 (Mermin Functional):</strong>
<ul>
<li>这是 Mermin (1965年) 对 DFT 的推广，用于描述有限温度下的体系。</li>
<li>目标是最小化<strong>自由能 (Free
Energy)</strong>，而不是总能量。</li>
<li><strong><span class="math inline">\(F_{Mermin}[\rho] =
\min_{\hat{\rho} \to \rho} \text{Tr} \{ \hat{\rho} [ \hat{H} +
\frac{1}{\beta}\ln\hat{\rho} ] \}\)</span></strong>
<ul>
<li><strong>解释:</strong>
<ul>
<li>这里的 <span class="math inline">\(F\)</span> 不是指 Hohenberg-Kohn
泛函，而是指<strong>亥姆霍兹自由能 (Helmholtz free energy)</strong>
<span class="math inline">\(\Omega\)</span>（或 <span
class="math inline">\(A\)</span>）。白板上写 <span
class="math inline">\(F\)</span> 可能是指普适泛函部分。</li>
<li><span class="math inline">\(\hat{H}\)</span> 是哈密顿量（不含 <span
class="math inline">\(V_{ext}\)</span> 的部分，即 <span
class="math inline">\(\hat{T} + \hat{V}_{ee}\)</span>）。</li>
<li><span class="math inline">\(\frac{1}{\beta}\ln\hat{\rho}\)</span>
这一项与<strong>熵 (Entropy)</strong> 相关 (<span
class="math inline">\(S = -k_B
\text{Tr}(\hat{\rho}\ln\hat{\rho})\)</span>)。</li>
<li><span class="math inline">\(\beta = 1 / (k_B T)\)</span>。</li>
<li>整个 <span class="math inline">\(\text{Tr}\{...\}\)</span>
表达式代表系统的亥姆霍兹自由能 <span
class="math inline">\(A\)</span>。</li>
<li><span class="math inline">\(\min_{\hat{\rho} \to \rho}\)</span>：与
Levy-Lieb 约束搜索类似，这里是搜索所有能产生密度 <span
class="math inline">\(\rho\)</span> 的密度矩阵 <span
class="math inline">\(\hat{\rho}\)</span>，并找到使自由能最小的那个。</li>
</ul></li>
</ul></li>
</ul></li>
<li><strong>② 自由能最小化:</strong>
<ul>
<li><strong><span class="math inline">\(F_e = \min_{\hat{\rho}_e}
f_{mermin}[\rho], \rho_e\)</span></strong>
<ul>
<li><em>这行字迹有些潦草，但结合上下文，它表达的意思是：</em>
体系的平衡自由能 <span class="math inline">\(F_e\)</span> (或 <span
class="math inline">\(\Omega_e\)</span>) 是通过最小化 Mermin
泛函得到的，此时对应的密度是平衡态密度 <span
class="math inline">\(\rho_e\)</span>。</li>
</ul></li>
<li><strong><span class="math inline">\(\hat{\rho}_e = \frac{e^{-\beta
\hat{H}}}{\text{Tr}(e^{-\beta \hat{H}})} = \frac{e^{-\beta
\hat{H}}}{Z}\)</span></strong>
<ul>
<li>这是热力学平衡态下的<strong>正则系综密度矩阵 (equilibrium density
matrix)</strong>。<span class="math inline">\(Z\)</span>
是配分函数。</li>
</ul></li>
<li><strong><span class="math inline">\(\hat{H} =
-\frac{1}{\beta}\ln(\hat{\rho}_e)\)</span></strong>
<ul>
<li>这是上一个公式的简单变形，反解出哈密顿量 <span
class="math inline">\(\hat{H}\)</span>。</li>
</ul></li>
</ul></li>
<li><strong>应用场景 (右上角):</strong>
<ul>
<li><strong><span class="math inline">\(T &gt; 10,000K\)</span>
warm-dense materials</strong>
<ul>
<li>指出这种有限温度 DFT 理论常用于研究<strong>温稠密物质</strong>
(WDM)，如行星核心或惯性约束聚变 (ICF) 实验中的状态。</li>
</ul></li>
<li><strong>Fermi sea (费米海):</strong>
<ul>
<li>旁边的图示 (一个方框和坐标轴)
可能是在示意费米面在高温下变得模糊（即费米-狄拉克分布不再是 <span
class="math inline">\(T=0\)</span> 时的阶跃函数）。</li>
</ul></li>
</ul></li>
</ul>
<h3 id="칠-无轨道-dft-orbital-free-dft">칠 无轨道 DFT (Orbital-free
DFT)</h3>
<p>这部分回到了 <span class="math inline">\(T=0\)</span>
的情况（或稍作修改也可用于有限温度），但介绍了一种计算上更简化的 DFT
方法。</p>
<ul>
<li><strong><span class="math inline">\(E[\rho]\)</span> ?</strong>
<ul>
<li>提出一个问题：能量泛函 <span class="math inline">\(E[\rho]\)</span>
到底是什么样子的？</li>
</ul></li>
<li><strong><span class="math inline">\(\Delta\)</span> Orbital-free DFT
(OF-DFT):</strong>
<ul>
<li><strong>动机:</strong> Kohn-Sham DFT (标准的 DFT)
仍然需要求解一组单电子轨道，计算量随系统增大而急剧上升 (通常是 <span
class="math inline">\(N^3\)</span> 或更高)。OF-DFT
试图完全避免求解轨道，只依赖于密度 <span
class="math inline">\(\rho\)</span> 本身。</li>
<li><strong>Thomas-Fermi-Dirac approximation (托马斯-费米-狄拉克
近似):</strong>
<ul>
<li>这是 OF-DFT 中最早期和最简单的近似。</li>
<li><strong><span class="math inline">\(E_{TF}[\rho] = T[\rho] + \int
V_{ext}(\vec{r})\rho(\vec{r})d\vec{r} + \frac{e^2}{2} \iint
\frac{\rho(\vec{r})\rho(\vec{r}&#39;)}{|\vec{r}-\vec{r}&#39;|}d\vec{r}d\vec{r}&#39;
+ E_{xc}[\rho]\)</span> ?</strong></li>
<li><strong>泛函的组成：</strong>
<ol type="1">
<li><strong><span class="math inline">\(T[\rho]\)</span>:</strong>
动能泛函。在 OF-DFT 中，最大的挑战就是找到 <span
class="math inline">\(T[\rho]\)</span>
的一个精确的、仅依赖于密度的表达式。Thomas-Fermi
理论给出了第一个近似（<span class="math inline">\(T_{TF}[\rho] \propto
\int \rho^{5/3} d\vec{r}\)</span>）。</li>
<li><strong><span class="math inline">\(\int
V_{ext}(\vec{r})\rho(\vec{r})d\vec{r}\)</span>:</strong> 外势能量
(与标准 DFT 相同)。</li>
<li><strong><span class="math inline">\(\frac{e^2}{2} \iint
...\)</span>:</strong> 电子-电子相互作用的<strong>哈特里 (Hartree)
能量</strong>，即经典的静电排斥能 (与标准 DFT 相同)。</li>
<li><strong><span class="math inline">\(E_{xc}[\rho]\)</span>
?:</strong> <strong>交换关联 (Exchange-Correlation) 能量</strong>。
<ul>
<li><em>白板上在这一项后面打了一个问号</em>，表示这部分也需要一个仅依赖于
<span class="math inline">\(\rho\)</span> 的近似泛函（例如 Local Density
Approximation, LDA，其中 <span class="math inline">\(E_x \propto \int
\rho^{4/3} d\vec{r}\)</span>）。</li>
<li>当 <span class="math inline">\(E_{xc}\)</span> 包含狄拉克 (Dirac)
的交换能近似时，就称为 Thomas-Fermi-Dirac (TFD) 理论。</li>
</ul></li>
</ol></li>
</ul></li>
</ul></li>
</ul>
<h3 id="总结-1">总结</h3>
<p>从 <span class="math inline">\(T=0\)</span> 的基态 DFT
出发，探讨了两个进阶主题： 1. <strong>Mermin DFT:</strong> 如何将 DFT
框架从 <span class="math inline">\(T=0\)</span> 的总能量 <span
class="math inline">\(E\)</span> 推广到 <span class="math inline">\(T
&gt; 0\)</span> 的自由能 <span
class="math inline">\(F\)</span>，这对于描述高温系统（如温稠密物质）至关重要。
2. <strong>Orbital-free DFT:</strong>
一种计算上可能更高效（但目前精度较低）的 DFT 方法，它试图避免使用
Kohn-Sham 轨道，而是直接构建总能量（特别是动能 <span
class="math inline">\(T[\rho]\)</span>）作为电子密度的显式泛函。</p>
<p><strong>Orbital-free DFT (OF-DFT)</strong> 是一种“理想中”的
DFT，而我们通常在实践中（例如在 Google 上搜索“DFT 计算”）谈论的几乎都是
<strong>Kohn-Sham DFT (KS-DFT)</strong>。</p>
<p>它们都基于相同的 Hohenberg-Kohn
定理，但实现这个定理的<strong>策略</strong>完全不同。</p>
<h3 id="kohn-sham-ks-dft实用的妥协方案">Kohn-Sham (KS)
DFT：实用的妥协方案</h3>
<p>KS-DFT 的天才之处在于它<strong>没有</strong>试图直接解决那个最棘手的
<strong><span
class="math inline">\(T[\rho]\)</span></strong>（动能泛函）。</p>
<p><strong>1. 核心思想：引入“虚拟系统”</strong></p>
<p>Kohn 和 Sham
提出：我们不去处理那个复杂、强相互作用的<strong>真实电子系统</strong>，而是构建一个<strong>虚拟的、无相互作用的电子系统</strong>。</p>
<p>这个虚拟系统被设计为<strong>恰好</strong>具有与真实系统<strong>完全相同的基态电子密度
<span class="math inline">\(\rho_0(\vec{r})\)</span></strong>。</p>
<p><strong>2. 为什么这样做有好处？</strong></p>
<ul>
<li>对于<strong>无相互作用</strong>的系统，我们<strong>精确地知道</strong>如何计算其动能！</li>
<li>动能 <span class="math inline">\(T_s\)</span> 就是所有虚拟粒子（称为
Kohn-Sham 轨道 <span
class="math inline">\(\phi_i\)</span>）动能的总和。</li>
<li>这个系统的波函数就是一个简单的斯莱特行列式（Slater
determinant），密度 <span class="math inline">\(\rho(\vec{r}) = \sum_i^N
|\phi_i(\vec{r})|^2\)</span>。</li>
</ul>
<p><strong>3. Kohn-Sham 能量泛函</strong></p>
<p>KS-DFT 将总能量 <span class="math inline">\(E[\rho]\)</span>
重新划分为以下几项：</p>
<p><span class="math display">\[E_{KS}[\rho] = T_s[\{\phi_i\}] + \int
V_{ext} \rho(\vec{r}) d\vec{r} + E_H[\rho] + E_{xc}[\rho]\]</span></p>
<ul>
<li><span class="math inline">\(T_s[\{\phi_i\}]\)</span>:
<strong>无相互作用动能</strong>。这是通过求解轨道 <span
class="math inline">\(\phi_i\)</span>
来<strong>精确计算</strong>的，而不是作为 <span
class="math inline">\(\rho\)</span> 的泛函来近似。</li>
<li><span class="math inline">\(\int V_{ext} \rho(\vec{r})
d\vec{r}\)</span>: 外势能 (与 OF-DFT 相同)。</li>
<li><span class="math inline">\(E_H[\rho]\)</span>: 电子-电子静电排斥能
(Hartree 能量，与 OF-DFT 相同)。</li>
<li><span class="math inline">\(E_{xc}[\rho]\)</span>:
<strong>交换关联能</strong>。</li>
</ul>
<p><strong>4. 在 <span class="math inline">\(E_{xc}\)</span>
中</strong></p>
<p>现在，未知被藏在了 <span class="math inline">\(E_{xc}[\rho]\)</span>
这一项里。它包含： 1. <strong>交换能</strong> (纯量子效应)。 2.
<strong>关联能</strong> (电子如何相互“躲避”)。 3.
<strong>动能差</strong>：真实系统的动能 <span
class="math inline">\(T\)</span> 和我们计算的无相互作用动能 <span
class="math inline">\(T_s\)</span> 之间的差值 <span
class="math inline">\((T - T_s)\)</span>。</p>
<p>KS-DFT 的<strong>巨大成功</strong>在于：<strong><span
class="math inline">\(E_{xc}[\rho]\)</span>
这一项（虽然仍然未知且必须近似）被证明比直接近似 <span
class="math inline">\(T[\rho]\)</span> 要容易得多！</strong></p>
<p>KS-DFT 的工作就是求解一组单电子方程（Kohn-Sham 方程），找到轨道 <span
class="math inline">\(\phi_i\)</span>，从而构建 <span
class="math inline">\(\rho\)</span>，并计算总能量。</p>
<h3 id="对比kohn-sham-dft-vs.-orbital-free-dft">对比：Kohn-Sham DFT
vs. Orbital-Free DFT</h3>
<p>这张表格总结了两者最关键的区别：</p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr>
<th style="text-align: left;">特征</th>
<th style="text-align: left;">🔵 Kohn-Sham DFT (KS-DFT)</th>
<th style="text-align: left;">🟠 Orbital-Free DFT (OF-DFT)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>基本变量</strong></td>
<td style="text-align: left;">Kohn-Sham <strong>轨道</strong> <span
class="math inline">\(\{\phi_i\}\)</span> (用来构建密度 <span
class="math inline">\(\rho\)</span>)</td>
<td style="text-align: left;"><strong>电子密度</strong> <span
class="math inline">\(\rho(\vec{r})\)</span></td>
</tr>
<tr>
<td style="text-align: left;"><strong>核心挑战</strong></td>
<td style="text-align: left;">近似<strong>交换关联泛函 <span
class="math inline">\(E_{xc}[\rho]\)</span></strong></td>
<td style="text-align: left;">近似<strong>动能泛函 <span
class="math inline">\(T[\rho]\)</span></strong> (以及 <span
class="math inline">\(E_{xc}[\rho]\)</span>)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>动能处理</strong></td>
<td style="text-align: left;"><strong>间接计算</strong>：通过求解轨道
<span class="math inline">\(\phi_i\)</span>
精确计算<strong>无相互作用动能 <span
class="math inline">\(T_s\)</span></strong>。</td>
<td style="text-align: left;"><strong>直接近似</strong>：必须找到一个
<span class="math inline">\(T[\rho]\)</span> 的表达式 (例如 <span
class="math inline">\(T \propto \int \rho^{5/3}\)</span>)。</td>
</tr>
<tr>
<td style="text-align: left;"><strong>计算成本</strong></td>
<td
style="text-align: left;"><strong>高</strong>。求解轨道是计算瓶颈，计算量通常随系统大小
<span class="math inline">\(N\)</span> 呈 <span
class="math inline">\(N^3\)</span> 增长。</td>
<td style="text-align: left;"><strong>非常低</strong>。原则上可以 <span
class="math inline">\(N \log N\)</span> 或 <span
class="math inline">\(N\)</span> (线性标度)，因为它只处理 3D 变量 <span
class="math inline">\(\rho\)</span>。</td>
</tr>
<tr>
<td style="text-align: left;"><strong>当前精度</strong></td>
<td
style="text-align: left;"><strong>高</strong>。是量子化学和材料科学的标准方法。</td>
<td style="text-align: left;"><strong>低</strong>。找到一个普适且精确的
<span class="math inline">\(T[\rho]\)</span>
泛函被证明<strong>极其困难</strong>。</td>
</tr>
</tbody>
</table>
<h3 id="总结-2">总结</h3>
<ul>
<li><strong>OF-DFT </strong>
一个完全依赖于密度的理论，计算速度极快，但苦于找不到准确的<strong>动能泛函</strong>
<span class="math inline">\(T[\rho]\)</span>。</li>
<li><strong>KS-DFT (标准方法)</strong>
是一个务实的“妥协”。它引入了<strong>轨道</strong>，用 <span
class="math inline">\(T_s\)</span>
这一项精确地处理了大部分动能，把更小的、更“好近似”的动能差 <span
class="math inline">\((T-T_s)\)</span> 连同交换关联能一起打包成 <span
class="math inline">\(E_{xc}[\rho]\)</span>。</li>
</ul>
<p>当今几乎所有的 DFT 软件（如 VASP, Gaussian, QE）都是基于 Kohn-Sham
方案的。</p>
<p>这推导的是<strong>自由电子气 (free electron gas)</strong>
的动能泛函，这个结果是<strong>无轨道 DFT (OF-DFT)</strong>
和<strong>局域密度近似 (LDA)</strong> 的理论基础。</p>
<p>这内容承接了上一张图的 <span
class="math inline">\(T[\rho]\)</span>（动能泛函）问题，展示了如何为最简单的系统——均匀的自由电子气——推导出
<span class="math inline">\(T\)</span> 和 <span
class="math inline">\(\rho\)</span> 的关系。</p>
<h3 id="详解">详解</h3>
<h4
id="左半部分自由电子气的基本设定">左半部分：自由电子气的基本设定</h4>
<ol type="1">
<li><strong>标题：free electron gas (自由电子气)</strong>
<ul>
<li>这是一个理想化模型，假设电子在无外势（或均匀正电荷背景）中自由运动。</li>
</ul></li>
<li><strong>薛定谔方程：</strong>
<ul>
<li><span class="math inline">\(-\frac{\hbar^2}{2m}\nabla^2\Psi =
E_k\Psi\)</span></li>
<li>这是自由粒子的定态薛定谔方程，其解为平面波。</li>
</ul></li>
<li><strong>波函数与能量：</strong>
<ul>
<li><span class="math inline">\(\Psi_k = \frac{1}{\sqrt{\Omega}}
e^{i\vec{k}\cdot\vec{r}}\)</span> （平面波解）</li>
<li><span class="math inline">\(\Omega = L^3\)</span> （系统体积）</li>
<li><span class="math inline">\(E_k = \frac{\hbar^2 k^2}{2m}\)</span>
（能量本征值，k 是波矢 <span
class="math inline">\(k=|\vec{k}|\)</span>）</li>
</ul></li>
<li><strong>PBC (周期性边界条件):</strong>
<ul>
<li><code>kx = 0, ±2π/L, ±4π/L, ...</code></li>
<li>这说明 <span class="math inline">\(\vec{k}\)</span>
矢量在“k空间”中不是连续的，而是形成一个晶格，每个点占据的体积是 <span
class="math inline">\((\frac{2\pi}{L})^3\)</span>。</li>
</ul></li>
<li><strong>3D 状态填充 (费米球):</strong>
<ul>
<li>图示为一个球体，半径为 <span
class="math inline">\(k_F\)</span>（费米波矢）。在 <span
class="math inline">\(T=0\text{K}\)</span> 时，所有 <span
class="math inline">\(k &lt; k_F\)</span> 的状态都被电子填满。</li>
<li><strong>计算电子总数 <span class="math inline">\(N^\sigma\)</span>
(单一自旋):</strong>
<ul>
<li><span class="math inline">\(N^\sigma =
\frac{\text{费米球体积}}{\text{单个 k 态体积}}\)</span></li>
<li><span class="math inline">\(N^\sigma = \frac{\frac{4}{3}\pi
(k_F^\sigma)^3}{(\frac{2\pi}{L})^3} = \frac{\frac{4}{3}\pi
(k_F^\sigma)^3}{(2\pi)^3/\Omega}\)</span></li>
</ul></li>
</ul></li>
</ol>
<h4 id="右半部分推导-trho-动能泛函">右半部分：推导 <span
class="math inline">\(T[\rho]\)</span> (动能泛函)</h4>
<ol type="1">
<li><strong>关联 <span class="math inline">\(k_F\)</span> 和密度 <span
class="math inline">\(\rho\)</span>:</strong>
<ul>
<li>从左侧公式整理可得：<span class="math inline">\(\rho^\sigma =
\frac{N^\sigma}{\Omega} = \frac{(k_F^\sigma)^3}{6\pi^2}\)</span>。</li>
<li>假设系统是自旋非极化的（<span class="math inline">\(\rho^\uparrow =
\rho^\downarrow\)</span>），总密度 <span class="math inline">\(\rho =
\rho^\uparrow + \rho^\downarrow = 2\rho^\sigma\)</span>，且 <span
class="math inline">\(k_F^\uparrow = k_F^\downarrow =
k_F\)</span>。</li>
<li>代入可得：<span class="math inline">\(\rho = 2 \cdot
\frac{k_F^3}{6\pi^2} = \frac{k_F^3}{3\pi^2}\)</span>。</li>
<li><strong><span class="math inline">\(\Rightarrow (k_F)^3 = 3\pi^2
\rho\)</span></strong> (白板上的关键关系)</li>
</ul></li>
<li><strong>费米能 (Fermi Energy):</strong>
<ul>
<li><code>HOMO/VBM → EF</code> (在连续能带中，最高占据能级就是费米能
<span class="math inline">\(E_F\)</span>)</li>
<li><span class="math inline">\(E_F = \frac{\hbar^2
k_F^2}{2m}\)</span></li>
</ul></li>
<li><strong>计算总动能 <span class="math inline">\(T\)</span>:</strong>
<ul>
<li>总动能 <span class="math inline">\(T\)</span>
是所有电子动能的总和。在 <span
class="math inline">\(T=0\text{K}\)</span>
时，等于对费米球内所有状态的能量 <span
class="math inline">\(E_k\)</span> 进行积分。</li>
<li><span class="math inline">\(T = T^\uparrow +
T^\downarrow\)</span></li>
<li>通过积分（白板上省略了积分步骤，直接用了熟知结论），可以得到<strong>平均动能</strong>
<span class="math inline">\(\langle E_{kin} \rangle = \frac{3}{5}
E_F\)</span>。</li>
<li>因此，总动能 <span class="math inline">\(T = N \cdot \langle E_{kin}
\rangle = N \cdot \frac{3}{5} E_F\)</span>。</li>
</ul></li>
<li><strong>T 作为 <span class="math inline">\(\rho\)</span> 的泛函
(最终推导):</strong>
<ul>
<li>这是最关键的一步：将 <span class="math inline">\(T = \frac{3}{5} N
E_F\)</span> 中的 <span class="math inline">\(N\)</span> 和 <span
class="math inline">\(E_F\)</span> 全部用密度 <span
class="math inline">\(\rho\)</span> 替换掉。</li>
<li><span class="math inline">\(N = \int \rho(\vec{r}) d\vec{r}\)</span>
(电子总数)</li>
<li><span class="math inline">\(E_F = \frac{\hbar^2 k_F^2}{2m} =
\frac{\hbar^2}{2m} (3\pi^2 \rho)^{2/3}\)</span> (将 <span
class="math inline">\(k_F\)</span> 用 <span
class="math inline">\(\rho\)</span> 替换)</li>
<li><strong>局域密度近似 (Local Density Approximation, LDA):</strong>
<ul>
<li>我们<strong>假设</strong>一个真实系统（密度<em>不</em>均匀，<span
class="math inline">\(\rho =
\rho(\vec{r})\)</span>）的总动能，可以通过在空间中每一点 <span
class="math inline">\((\vec{r})\)</span>
使用上述<strong>均匀电子气</strong>的结果，然后求和（积分）得到。</li>
<li><span class="math inline">\(T[\rho] = \int (\text{电子数密度}) \cdot
(\text{平均动能}) d\vec{r}\)</span></li>
<li><span class="math inline">\(T[\rho] = \int \rho(\vec{r}) \cdot
\frac{3}{5} E_F(\rho(\vec{r})) d\vec{r}\)</span></li>
<li><span class="math inline">\(T[\rho] = \int \rho(\vec{r}) \cdot
\frac{3}{5} \left[ \frac{\hbar^2}{2m} (3\pi^2 \rho(\vec{r}))^{2/3}
\right] d\vec{r}\)</span></li>
</ul></li>
<li><strong>整理后得到白板上的最终公式：</strong>
<ul>
<li><span class="math inline">\(T[\rho] = \frac{\hbar^2}{m} \frac{3}{10}
(3\pi^2)^{2/3} \int \rho^{5/3}(\vec{r}) d\vec{r}\)</span></li>
<li>这被称为<strong>托马斯-费米 (Thomas-Fermi) 动能泛函</strong>。</li>
</ul></li>
</ul></li>
</ol>
<h3 id="总结-3">总结</h3>
<p>这展示了 <span class="math inline">\(T[\rho] \propto \int \rho^{5/3}
d\vec{r}\)</span> 这个著名公式的来源。</p>
<ul>
<li>它为<strong>无轨道 DFT</strong>
提供了第一个（也是最简单的）<strong>动能泛函</strong> <span
class="math inline">\(T[\rho]\)</span> 近似。</li>
<li>它也是<strong>局域密度近似 (LDA)</strong> 的基础。在 Kohn-Sham DFT
中，虽然 <span class="math inline">\(T_s\)</span> (无相互作用动能)
是通过轨道精确计算的，但 <span class="math inline">\(E_{xc}\)</span>
(交换关联能) 里的交换能 <span class="math inline">\(E_x\)</span>
也是用完全相同的逻辑（自由电子气模型）推导出来的（<span
class="math inline">\(E_x[\rho] \propto \int \rho^{4/3}
d\vec{r}\)</span>）。</li>
</ul>
<p><strong>无轨道密度泛函理论 (Orbital-Free DFT)</strong>
的核心求解方程，它直接源自前面的推导。</p>
<p><strong>如何通过最小化能量泛函来找到基态密度 <span
class="math inline">\(\rho_0\)</span></strong>。</p>
<h3 id="详解-1">详解</h3>
<p><strong>1. 核心思想：约束下的最小化</strong></p>
<ul>
<li><strong><span class="math inline">\(\frac{\delta}{\delta\rho} \left(
E_{TF}[\rho] - \mu (\int \rho(\vec{r})d\vec{r} - N) \right) =
0\)</span></strong>
<ul>
<li>这是一个使用“拉格朗日乘子法”的<strong>泛函求导</strong>（或称变分）方程。</li>
<li><strong>目的：</strong> 寻找使总能量 <span
class="math inline">\(E_{TF}[\rho]\)</span>
达到<strong>最小值</strong>的那个密度 <span
class="math inline">\(\rho\)</span>。</li>
<li><strong>约束：</strong>
这个最小化必须满足一个条件，即电子密度在全空间积分必须等于总电子数 <span
class="math inline">\(N\)</span>（即 <span class="math inline">\(\int
\rho(\vec{r})d\vec{r} = N\)</span>）。</li>
<li><strong><span class="math inline">\(\mu\)</span> (mu):</strong>
就是为这个约束条件引入的“拉格朗日乘子”。</li>
</ul></li>
</ul>
<p><strong>2. 欧拉-拉格朗日方程 (Euler-Lagrange Equation)</strong></p>
<ul>
<li>下面那一大长串方程，就是执行上面那行泛函求导 <span
class="math inline">\(\frac{\delta}{\delta\rho}\)</span>
后得到的结果，其形式为 <span class="math inline">\(\frac{\delta
E_{TF}[\rho]}{\delta\rho} = \mu\)</span>。</li>
<li>让我们逐项分解 <span class="math inline">\(\frac{\delta
E_{TF}[\rho]}{\delta\rho}\)</span>：
<ul>
<li><strong><span class="math inline">\(E_{TF}[\rho] = T[\rho] +
E_{V_{ext}}[\rho] + E_H[\rho] + E_{xc}[\rho]\)</span></strong>
(这是上一张白板中定义的总能量)</li>
</ul></li>
<li><strong>方程的各项：</strong>
<ul>
<li><strong>第一项：<span class="math inline">\(\frac{\hbar^2}{m}
\frac{3}{10} (3\pi^2)^{2/3} \cdot \frac{5}{3}
\rho^{2/3}\)</span></strong>
<ul>
<li>这是对 <strong>动能泛函 <span
class="math inline">\(T[\rho]\)</span></strong> 求泛函导数的结果。</li>
<li><span class="math inline">\(T[\rho] = C_F \int \rho^{5/3}
d\vec{r}\)</span> (来自上一张白板)。</li>
<li><span class="math inline">\(\frac{\delta T[\rho]}{\delta\rho} = C_F
\cdot \frac{5}{3} \rho^{2/3}\)</span>。</li>
<li>这一项代表一种源自动能的“量子压力”。</li>
</ul></li>
<li><strong>第二项：<span
class="math inline">\(V_{ext}(\vec{r})\)</span></strong>
<ul>
<li>这是对 <strong>外势能</strong> <span
class="math inline">\(E_{V_{ext}}[\rho] = \int V_{ext}(\vec{r})
\rho(\vec{r}) d\vec{r}\)</span> 求导的结果。</li>
<li><span class="math inline">\(\frac{\delta
E_{V_{ext}}[\rho]}{\delta\rho} = V_{ext}(\vec{r})\)</span>。</li>
</ul></li>
<li><strong>第三项：<span class="math inline">\(+ e^2 \int d\vec{r}&#39;
\frac{\rho(\vec{r}&#39;)}{|\vec{r}-\vec{r}&#39;|}\)</span></strong>
<ul>
<li>这是对 <strong>哈特里 (Hartree) 能量</strong> <span
class="math inline">\(E_H[\rho]\)</span>
（电子间经典静电排斥能）求导的结果。</li>
<li>这一项就是<strong>哈特里势 <span
class="math inline">\(V_H(\vec{r})\)</span></strong>，即 <span
class="math inline">\(\rho\)</span> 在 <span
class="math inline">\(\vec{r}\)</span>
处感受到的来自所有其他电子的静电势。</li>
<li><em>(注：白板上在 <span class="math inline">\(V_{ext}\)</span>
和这一项之间写的 <span class="math inline">\(V_{exc}[\rho]\)</span>
似乎是个笔误或简写，因为方程后面明确地分别写出了哈特里项和交换关联项。)</em></li>
</ul></li>
<li><strong>第四项：<span class="math inline">\(+ \frac{\delta
E_{xc}[\rho]}{\delta\rho}\)</span></strong>
<ul>
<li>这是对 <strong>交换关联 (Exchange-Correlation) 能量 <span
class="math inline">\(E_{xc}[\rho]\)</span></strong> 求导的结果。</li>
<li>这个导数本身被<strong>定义</strong>为<strong>交换关联势 <span
class="math inline">\(V_{xc}(\vec{r})\)</span></strong>。</li>
</ul></li>
</ul></li>
</ul>
<p><strong>3. 方程的物理意义</strong></p>
<ul>
<li><strong><span class="math inline">\(= \mu \text{ chemical
potential}\)</span></strong>
<ul>
<li>方程表明，在基态密度 <span class="math inline">\(\rho_0\)</span>
下，系统中所有“势”的总和在空间中处处等于一个常数 <span
class="math inline">\(\mu\)</span>。</li>
<li>这个常数 <span
class="math inline">\(\mu\)</span>（拉格朗日乘子）的物理意义是体系的<strong>化学势
(chemical potential)</strong>，即向系统中添加一个电子所需的能量。</li>
</ul></li>
</ul>
<p><strong>4. 总结 </strong></p>
<ul>
<li><strong><span class="math inline">\(\rho_0 \quad E_{TF}[\rho_0]
\quad \text{shell}\)</span></strong>
<ul>
<li><strong><span class="math inline">\(\rho_0\)</span>:</strong>
通过求解上面那个复杂的（非线性）积分-微分方程，我们就能得到<strong>基态密度
<span class="math inline">\(\rho_0\)</span></strong>。</li>
<li><strong><span
class="math inline">\(E_{TF}[\rho_0]\)</span>:</strong> 将 <span
class="math inline">\(\rho_0\)</span> 代回到 <span
class="math inline">\(E_{TF}[\rho]\)</span>
的原始表达式中，就能计算出体系的<strong>基态总能量</strong>。</li>
<li><strong><span class="math inline">\(\text{shell}\)</span>
(壳层):</strong> 这是一个非常重要的旁注。托马斯-费米 (Thomas-Fermi)
理论（即 OF-DFT
的最早版本）的一个著名<strong>缺陷</strong>是它无法预测原子中<strong>电子壳层结构</strong>（如
1s, 2s, 2p…）。它的密度 <span class="math inline">\(\rho\)</span>
曲线是平滑的，没有“Kohn-Sham
DFT”中轨道所产生的波峰和波谷。这个词很可能是在提醒这个理论的局限性。</li>
</ul></li>
</ul>
<h3 id="整个系列总结">整个系列总结</h3>
<p>这四部分构成了一个关于 DFT 基础： 1. <strong>1:</strong> 介绍了 DFT
的<strong>核心思想</strong> (Hohenberg-Kohn 定理)，即能量是密度的泛函
<span class="math inline">\(E[\rho]\)</span>。 2. <strong>2:</strong>
探讨了两种 DFT 的实现：一种用于<strong>有限温度</strong> (Mermin
DFT)，另一种是<strong>无轨道 DFT (OF-DFT)</strong>，并写出了 <span
class="math inline">\(E_{TF}[\rho]\)</span> 的一般形式。 3.
<strong>3:</strong> 详细<strong>推导</strong>了 OF-DFT
中最关键的<strong>动能泛函</strong> <span class="math inline">\(T[\rho]
\propto \int \rho^{5/3} d\vec{r}\)</span>，其基于自由电子气模型。 4.
<strong>4:</strong> 展示了如何<strong>使用</strong>这个 <span
class="math inline">\(E_{TF}[\rho]\)</span>
泛函，通过泛函求导（变分法）建立一个可解的方程（欧拉-拉格朗日方程），以求得基态密度
<span class="math inline">\(\rho_0\)</span> 和能量 <span
class="math inline">\(E_0\)</span>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/11/04/diffusion_model/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/11/04/diffusion_model/" class="post-title-link" itemprop="url">Diffusion Model</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-11-04 11:00:00 / 修改时间：13:48:13" itemprop="dateCreated datePublished" datetime="2025-11-04T11:00:00+08:00">2025-11-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%89%A9%E6%95%A3%E6%A8%A1%E5%9E%8B/" itemprop="url" rel="index"><span itemprop="name">扩散模型</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>第 1 部分：基础数学工具与物理背景</strong></p>
<p>最近在尝试理解扩散模型所依赖的核心数学概念：高斯分布的性质、朗之万动力学（SDE）及其离散化。</p>
<h3 id="核心数学工具高斯分布-gaussian-distribution">1.
核心数学工具：高斯分布 (Gaussian Distribution)</h3>
<p>扩散模型（尤其是 DDPM）的全部推导都建立在高斯分布的美妙性质之上。</p>
<h4 id="定义">1.1 定义</h4>
<p>一个一维高斯分布（正态分布）由均值 <span
class="math inline">\(\mu\)</span> 和方差 <span
class="math inline">\(\sigma^2\)</span> 定义，其概率密度函数 (PDF) 为：
<span class="math display">\[
\mathcal{N}(x; \mu, \sigma^2) = \frac{1}{\sqrt{2\pi\sigma^2}}
\exp\left(-\frac{(x - \mu)^2}{2\sigma^2}\right)
\]</span> 对于 <span class="math inline">\(D\)</span> 维向量 <span
class="math inline">\(\mathbf{x}\)</span>（例如视频中 <span
class="math inline">\(32 \times 32 = 1024\)</span>
维的图片向量），多维高斯分布由均值向量 <span
class="math inline">\(\boldsymbol{\mu}\)</span> 和协方差矩阵 <span
class="math inline">\(\boldsymbol{\Sigma}\)</span> 定义： <span
class="math display">\[
\mathcal{N}(\mathbf{x}; \boldsymbol{\mu}, \boldsymbol{\Sigma}) =
\frac{1}{\sqrt{(2\pi)^D \det(\boldsymbol{\Sigma})}}
\exp\left(-\frac{1}{2}(\mathbf{x} - \boldsymbol{\mu})^T
\boldsymbol{\Sigma}^{-1}(\mathbf{x} - \boldsymbol{\mu})\right)
\]</span> &gt; <strong>关键简化：</strong> 在 DDPM
中，我们通常假设协方差矩阵是<strong>对角矩阵</strong> <span
class="math inline">\(\boldsymbol{\Sigma} = \sigma^2
\mathbf{I}\)</span>，其中 <span
class="math inline">\(\mathbf{I}\)</span>
是单位矩阵。这意味着向量的每个维度（每个像素）是独立同分布的（IID）。</p>
<h4 id="关键性质-1重参数化技巧-reparameterization-trick">1.2 关键性质
1：重参数化技巧 (Reparameterization Trick)</h4>
<p><strong>问题：</strong> 我们如何从 <span
class="math inline">\(\mathcal{N}(\mu, \sigma^2)\)</span>
中采样？直接对这个分布采样是困难的，且在神经网络中无法传递梯度。</p>
<p><strong>技巧：</strong> 我们可以从一个<strong>标准高斯分布</strong>
<span class="math inline">\(\epsilon \sim \mathcal{N}(0, 1)\)</span>
中采样，然后通过线性变换得到 <span class="math inline">\(x\)</span>：
<span class="math display">\[
x = \mu + \sigma \cdot \epsilon
\]</span> <strong>推导：</strong> * <strong>1.：</strong> 设 <span
class="math inline">\(\epsilon \sim \mathcal{N}(0, 1)\)</span>，即 <span
class="math inline">\(E[\epsilon] = 0, \text{Var}(\epsilon) =
1\)</span>。 * <strong>2.：</strong> 我们构造 <span
class="math inline">\(x = \mu + \sigma \epsilon\)</span>。 * 计算 <span
class="math inline">\(x\)</span> 的均值：<span
class="math inline">\(E[x] = E[\mu + \sigma \epsilon] = E[\mu] + \sigma
E[\epsilon] = \mu + \sigma \cdot 0 = \mu\)</span>。 *
<strong>3.：</strong> 计算 <span class="math inline">\(x\)</span>
的方差：<span class="math inline">\(\text{Var}(x) = \text{Var}(\mu +
\sigma \epsilon) = \text{Var}(\sigma \epsilon) = \sigma^2
\text{Var}(\epsilon) = \sigma^2 \cdot 1 = \sigma^2\)</span>。 *
<strong>4.：</strong> 由于高斯分布的线性变换仍然是高斯分布，因此 <span
class="math inline">\(x \sim \mathcal{N}(\mu, \sigma^2)\)</span>。</p>
<p><strong>意义：</strong> 这使得采样过程可微。<span
class="math inline">\(\mu\)</span> 和 <span
class="math inline">\(\sigma\)</span> 可以是神经网络的输出，<span
class="math inline">\(\epsilon\)</span>
作为外部噪声输入，梯度可以反向传播回 <span
class="math inline">\(\mu\)</span> 和 <span
class="math inline">\(\sigma\)</span>。</p>
<h4 id="关键性质-2两个独立高斯分布之和-sum-of-independent-gaussians">1.3
关键性质 2：两个独立高斯分布之和 (Sum of Independent Gaussians)</h4>
<p><strong>问题：</strong>
两个独立高斯分布相加会怎样？这是前向加噪过程（Forward
Process）的核心。</p>
<p><strong>性质：</strong> 如果 <span class="math inline">\(X_1 \sim
\mathcal{N}(\mu_1, \sigma_1^2)\)</span> 且 <span
class="math inline">\(X_2 \sim \mathcal{N}(\mu_2, \sigma_2^2)\)</span>
相互独立，那么它们的和 <span class="math inline">\(Y = X_1 +
X_2\)</span> 仍然是高斯分布： <span class="math display">\[
Y \sim \mathcal{N}(\mu_1 + \mu_2, \sigma_1^2 + \sigma_2^2)
\]</span> <strong>推导：</strong> * <strong>均值：</strong> <span
class="math inline">\(E[Y] = E[X_1 + X_2] = E[X_1] + E[X_2] = \mu_1 +
\mu_2\)</span>。 * <strong>方差：</strong> 由于 <span
class="math inline">\(X_1\)</span> 和 <span
class="math inline">\(X_2\)</span> 相互独立，<span
class="math inline">\(\text{Cov}(X_1, X_2) = 0\)</span>。 <span
class="math inline">\(\text{Var}(Y) = \text{Var}(X_1 + X_2) =
\text{Var}(X_1) + \text{Var}(X_2) + 2 \text{Cov}(X_1, X_2) = \sigma_1^2
+ \sigma_2^2\)</span>。 *
（两个独立高斯变量之和仍为高斯分布，这可以通过矩生成函数或特征函数严格证明，这里我们接受这个结论。）</p>
<p><strong>意义：</strong> 这使得我们可以计算前向过程中任意 <span
class="math inline">\(t\)</span> 时刻 <span
class="math inline">\(x_t\)</span> 从 <span
class="math inline">\(x_0\)</span> 开始累积加噪的结果。</p>
<h3 id="物理与sde朗之万动力学-langevin-dynamics">2.
物理与SDE：朗之万动力学 (Langevin Dynamics)</h3>
<p>这是扩散模型的物理原型。</p>
<h4 id="随机微分方程-sde">2.1 随机微分方程 (SDE)</h4>
<p>朗之万动力学描述了一个粒子（在我们的例子中是图片向量 <span
class="math inline">\(\mathbf{x}\)</span>）在势场 <span
class="math inline">\(U(\mathbf{x})\)</span>
中运动，同时受到随机力（如布朗运动）的影响。其 SDE 形式 为： <span
class="math display">\[
d\mathbf{x}_t = \mathbf{f}(\mathbf{x}_t, t)dt + g(t)d\mathbf{w}_t
\]</span> * <span class="math inline">\(\mathbf{x}_t\)</span>：<span
class="math inline">\(t\)</span> 时刻的粒子位置（图片向量）。 * <span
class="math inline">\(\mathbf{f}(\mathbf{x}_t,
t)\)</span>：<strong>漂移项 (Drift)</strong>。代表确定性的力，如视频中
提到的 “吸引回原点的线性运动”（例如 <span
class="math inline">\(\mathbf{f}(\mathbf{x}, t) = -\beta
\mathbf{x}\)</span>，使分布趋向原点）。它对应能量函数的负梯度 <span
class="math inline">\(-\nabla U(\mathbf{x})\)</span>。 * <span
class="math inline">\(g(t)\)</span>：<strong>扩散项
(Diffusion)</strong>。控制随机噪声的强度。 * <span
class="math inline">\(d\mathbf{w}_t\)</span>：<strong>维纳过程 (Wiener
Process)</strong> 或布朗运动。它是一个随机项，其增量 <span
class="math inline">\(d\mathbf{w}_t\)</span> 在 <span
class="math inline">\(dt\)</span> 时间内服从高斯分布 <span
class="math inline">\(d\mathbf{w}_t \sim \mathcal{N}(0, \mathbf{I}
dt)\)</span>。</p>
<h4 id="sde-的离散化欧拉-丸山法-euler-maruyama">2.2 SDE
的离散化：欧拉-丸山法 (Euler-Maruyama)</h4>
<p><strong>问题：</strong> 计算机无法处理连续时间 <span
class="math inline">\(dt\)</span>。我们如何模拟这个 SDE？</p>
<p><strong>方法：</strong> 我们使用欧拉近似法（在 SDE 中称为
Euler-Maruyama）将其离散化为小的时间步 <span
class="math inline">\(\Delta t\)</span>。 <span class="math display">\[
\mathbf{x}_{t+\Delta t} - \mathbf{x}_t \approx \mathbf{f}(\mathbf{x}_t,
t)\Delta t + g(t) (\mathbf{w}_{t+\Delta t} - \mathbf{w}_t)
\]</span> 根据维纳过程的性质，在 <span class="math inline">\(\Delta
t\)</span> 时间内的增量 <span
class="math inline">\((\mathbf{w}_{t+\Delta t} - \mathbf{w}_t)\)</span>
服从 <span class="math inline">\(\mathcal{N}(0, \mathbf{I} \Delta
t)\)</span>。 根据<strong>性质 1.2（重参数化）</strong>，<span
class="math inline">\(\mathcal{N}(0, \mathbf{I} \Delta t)\)</span>
可以写成 <span class="math inline">\(\sqrt{\Delta t} \cdot
\mathbf{z}\)</span>，其中 <span class="math inline">\(\mathbf{z} \sim
\mathcal{N}(0, \mathbf{I})\)</span>。</p>
<p><strong>离散迭代公式：</strong> <span class="math display">\[
\mathbf{x}_{t+\Delta t} \approx \mathbf{x}_t + \mathbf{f}(\mathbf{x}_t,
t)\Delta t + g(t) \sqrt{\Delta t} \mathbf{z}_t
\]</span> 其中 <span class="math inline">\(\mathbf{z}_t \sim
\mathcal{N}(0, \mathbf{I})\)</span> 是在 <span
class="math inline">\(t\)</span> 时刻采样的标准高斯噪声。</p>
<p>这就是 DDPM <strong>前向加噪过程 (Forward Process)</strong>
的数学原型。</p>
<h3 id="核心数学工具贝叶斯公式-bayes-theorem">3.
核心数学工具：贝叶斯公式 (Bayes’ Theorem)</h3>
<p>贝叶斯公式是连接<strong>前向过程</strong>（加噪）和<strong>反向过程</strong>（去噪）的桥梁。</p>
<p>对于连续变量（概率密度函数）： <span class="math display">\[
p(x|y) = \frac{p(y|x) p(x)}{p(y)}
\]</span> 其中 <span class="math inline">\(p(y) = \int p(y|x) p(x)
dx\)</span>。</p>
<p><strong>在扩散模型中的应用：</strong> * <strong>1.：</strong>
我们定义了一个简单的前向加噪过程 <span class="math inline">\(q(x_t |
x_{t-1})\)</span>（易于计算）。 * <strong>2.：</strong>
我们想要的是反向去噪过程 <span class="math inline">\(p(x_{t-1} |
x_t)\)</span>（难以计算）。 * <strong>3.：</strong>
贝叶斯公式告诉我们：<span class="math inline">\(p(x_{t-1} | x_t) \propto
p(x_t | x_{t-1}) p(x_{t-1})\)</span>。 * <strong>4.：</strong> 在 DDPM
中，我们会看到一个更复杂的形式，它利用了 <span
class="math inline">\(x_0\)</span>： <span class="math display">\[
    q(x_{t-1} | x_t, x_0) = \frac{q(x_t | x_{t-1}, x_0) q(x_{t-1} |
x_0)}{q(x_t | x_0)}
    \]</span></p>
<p><strong>小结</strong></p>
<ol type="1">
<li><strong>高斯分布的性质</strong>（重参数化、加法），能精确计算加噪后的分布。</li>
<li><strong>朗之万动力学与欧拉近似</strong>，为 “逐步加噪”
提供了物理和数学模型。</li>
<li><strong>贝叶斯公式</strong>，指明了如何从 “加噪” 倒推出
“去噪”。</li>
</ol>
<h3 id="ddpm-前向过程从图像到噪声-the-forward-process">2. DDPM
前向过程：从图像到噪声 (The Forward Process)</h3>
<p>前向过程的目标是模拟大纲
中描述的“图片在向量空间中逐步噪声化的轨迹”。我们定义一个<strong>马尔可夫过程</strong>，在该过程中，我们从原始数据
<span class="math inline">\(\mathbf{x}_0 \sim
q(\mathbf{x}_0)\)</span>（即真实图片分布）开始，在 <span
class="math inline">\(T\)</span>
个离散的时间步中逐步向其添加高斯噪声。</p>
<h4 id="单步加噪过程-qmathbfx_t-mathbfx_t-1">2.1 单步加噪过程 <span
class="math inline">\(q(\mathbf{x}_t | \mathbf{x}_{t-1})\)</span></h4>
<p>在每个 <span class="math inline">\(t\)</span> 步，我们向 <span
class="math inline">\(\mathbf{x}_{t-1}\)</span> 添加少量噪声以生成 <span
class="math inline">\(\mathbf{x}_t\)</span>。这个过程被定义为一个高斯转变（这源于我们第
1 部分中对朗之万动力学的离散化）：</p>
<p><span class="math display">\[
q(\mathbf{x}_t | \mathbf{x}_{t-1}) = \mathcal{N}(\mathbf{x}_t; \sqrt{1 -
\beta_t} \mathbf{x}_{t-1}, \beta_t \mathbf{I})
\]</span></p>
<ul>
<li><span class="math inline">\(\{\beta_t\}_{t=1}^T\)</span>
是一个预先设定的<strong>方差表 (variance schedule)</strong>。它们是
<span class="math inline">\(T\)</span> 个很小的正常数（例如，<span
class="math inline">\(\beta_1 = 10^{-4}, \beta_T =
0.02\)</span>）。</li>
<li><span class="math inline">\(\sqrt{1 - \beta_t}
\mathbf{x}_{t-1}\)</span>：这是<strong>缩放项</strong>（大纲）。我们在添加噪声之前先将前一步的图片向量“缩小”一点。</li>
<li><span class="math inline">\(\beta_t
\mathbf{I}\)</span>：这是<strong>噪声项</strong>。<span
class="math inline">\(\beta_t\)</span> 是添加的噪声的方差，<span
class="math inline">\(\mathbf{I}\)</span>
是单位矩阵，表示噪声在所有维度（像素）上是独立同分布的。</li>
</ul>
<p><strong>重参数化技巧的应用：</strong> 我们可以使用第 1
部分中的<strong>重参数化技巧</strong>来显式地写出这个采样过程： <span
class="math display">\[
\mathbf{x}_t = \sqrt{1 - \beta_t} \mathbf{x}_{t-1} + \sqrt{\beta_t}
\boldsymbol{\epsilon}_{t-1}
\]</span> 其中 <span class="math inline">\(\boldsymbol{\epsilon}_{t-1}
\sim \mathcal{N}(0, \mathbf{I})\)</span> 是在 <span
class="math inline">\(t-1\)</span> 时刻采样的一个标准高斯噪声。</p>
<h4 id="累积加噪过程-qmathbfx_t-mathbfx_0-核心推导">2.2 累积加噪过程
<span class="math inline">\(q(\mathbf{x}_t | \mathbf{x}_0)\)</span>
(核心推导)</h4>
<p><strong>问题：</strong> 在训练期间（如大纲
所述），我们希望<strong>随机跳到</strong>任意 <span
class="math inline">\(t\)</span> 步并生成 <span
class="math inline">\(\mathbf{x}_t\)</span>。如果我们必须从 <span
class="math inline">\(\mathbf{x}_0\)</span> 迭代 <span
class="math inline">\(t\)</span> 次，这将非常缓慢。</p>
<p><strong>目标：</strong> 我们需要一个公式，能让我们从 <span
class="math inline">\(\mathbf{x}_0\)</span> <strong>一次性</strong>得到
<span class="math inline">\(\mathbf{x}_t\)</span> 的分布 <span
class="math inline">\(q(\mathbf{x}_t |
\mathbf{x}_0)\)</span>。这就是大纲
中提到的“构造出高斯分布的累计变换”。</p>
<p><strong>推导：</strong> 1. <strong>定义新变量：</strong>
为了简化推导，我们定义 <span class="math inline">\(\alpha_t = 1 -
\beta_t\)</span> 和 <span class="math inline">\(\bar{\alpha}_t =
\prod_{i=1}^t \alpha_i\)</span>。 * <span
class="math inline">\(\alpha_t\)</span> 是每一步的缩放因子。 * <span
class="math inline">\(\bar{\alpha}_t\)</span> 是从第 1 步到第 <span
class="math inline">\(t\)</span> 步的<strong>累积缩放因子</strong>。</p>
<ol start="2" type="1">
<li><p><strong>展开迭代 (Step-by-step Expansion)：</strong> 让我们从
<span class="math inline">\(\mathbf{x}_t\)</span> 开始，逐步代入 <span
class="math inline">\(\mathbf{x}_{t-1}\)</span>： <span
class="math display">\[
\mathbf{x}_t = \sqrt{\alpha_t} \mathbf{x}_{t-1} + \sqrt{1 - \alpha_t}
\boldsymbol{\epsilon}_{t-1}
\]</span> 现在，我们代入 <span class="math inline">\(\mathbf{x}_{t-1} =
\sqrt{\alpha_{t-1}} \mathbf{x}_{t-2} + \sqrt{1 - \alpha_{t-1}}
\boldsymbol{\epsilon}_{t-2}\)</span>： <span class="math display">\[
\begin{aligned}
\mathbf{x}_t &amp;= \sqrt{\alpha_t} (\sqrt{\alpha_{t-1}}
\mathbf{x}_{t-2} + \sqrt{1 - \alpha_{t-1}} \boldsymbol{\epsilon}_{t-2})
+ \sqrt{1 - \alpha_t} \boldsymbol{\epsilon}_{t-1} \\
&amp;= \sqrt{\alpha_t \alpha_{t-1}} \mathbf{x}_{t-2} + \sqrt{\alpha_t(1
- \alpha_{t-1})} \boldsymbol{\epsilon}_{t-2} + \sqrt{1 - \alpha_t}
\boldsymbol{\epsilon}_{t-1}
\end{aligned}
\]</span></p></li>
<li><p><strong>合并高斯噪声 (Merging Gaussians)：</strong>
注意上式的后两项：<span class="math inline">\(\sqrt{\alpha_t(1 -
\alpha_{t-1})} \boldsymbol{\epsilon}_{t-2}\)</span> 和 <span
class="math inline">\(\sqrt{1 - \alpha_t}
\boldsymbol{\epsilon}_{t-1}\)</span>。</p>
<ul>
<li><span class="math inline">\(\boldsymbol{\epsilon}_{t-2}\)</span> 和
<span class="math inline">\(\boldsymbol{\epsilon}_{t-1}\)</span>
是两个<strong>独立</strong>的标准高斯分布。</li>
<li>我们正在对两个独立的、均值为 0 的高斯分布进行线性组合。</li>
<li>根据第 1 部分的<strong>性质 1.3</strong>
(两个独立高斯分布之和)，它们的和仍然是一个均值为 0 的高斯分布。</li>
<li>这个新的高斯分布的<strong>方差</strong>是多少？ <span
class="math display">\[
  \begin{aligned}
  \text{Var}(\text{new\_noise}) &amp;= \text{Var}(\sqrt{\alpha_t(1 -
\alpha_{t-1})} \boldsymbol{\epsilon}_{t-2}) + \text{Var}(\sqrt{1 -
\alpha_t} \boldsymbol{\epsilon}_{t-1}) \\
  &amp;= (\alpha_t(1 - \alpha_{t-1})) \mathbf{I} + (1 - \alpha_t)
\mathbf{I} \\
  &amp;= (\alpha_t - \alpha_t\alpha_{t-1} + 1 - \alpha_t) \mathbf{I} \\
  &amp;= (1 - \alpha_t\alpha_{t-1}) \mathbf{I}
  \end{aligned}
  \]</span></li>
<li>根据重参数化技巧，一个方差为 <span class="math inline">\((1 -
\alpha_t\alpha_{t-1}) \mathbf{I}\)</span> 的高斯分布，可以写成 <span
class="math inline">\(\sqrt{1 - \alpha_t\alpha_{t-1}} \cdot
\bar{\boldsymbol{\epsilon}}_{t-2}\)</span>，其中 <span
class="math inline">\(\bar{\boldsymbol{\epsilon}}_{t-2} \sim
\mathcal{N}(0, \mathbf{I})\)</span> 是一个新的标准高斯噪声。</li>
</ul></li>
<li><p><strong>递归与通项公式：</strong> 我们将合并后的噪声代入第 2
步的展开式： <span class="math display">\[
\mathbf{x}_t = \sqrt{\alpha_t \alpha_{t-1}} \mathbf{x}_{t-2} + \sqrt{1 -
\alpha_t \alpha_{t-1}} \bar{\boldsymbol{\epsilon}}_{t-2}
\]</span></p>
<ul>
<li><span class="math inline">\(\mathbf{x}_t\)</span> 和 <span
class="math inline">\(\mathbf{x}_{t-2}\)</span> 的关系，与 <span
class="math inline">\(\mathbf{x}_t\)</span> 和 <span
class="math inline">\(\mathbf{x}_{t-1}\)</span> 的关系（<span
class="math inline">\(\mathbf{x}_t = \sqrt{\alpha_t} \mathbf{x}_{t-1} +
\sqrt{1 - \alpha_t}
\boldsymbol{\epsilon}_{t-1}\)</span>）在形式上是完全一致的！只是 <span
class="math inline">\(\alpha_t\)</span> 变成了 <span
class="math inline">\(\alpha_t \alpha_{t-1}\)</span>。</li>
<li>我们可以将这个模式递归地应用 <span class="math inline">\(t\)</span>
次： <span class="math display">\[
  \begin{aligned}
  \mathbf{x}_t &amp;= \sqrt{(\alpha_t \alpha_{t-1} \cdots \alpha_1)}
\mathbf{x}_0 + \sqrt{1 - (\alpha_t \alpha_{t-1} \cdots \alpha_1)}
\boldsymbol{\epsilon} \\
  &amp;= \sqrt{\bar{\alpha}_t} \mathbf{x}_0 + \sqrt{1 - \bar{\alpha}_t}
\boldsymbol{\epsilon}
  \end{aligned}
  \]</span></li>
<li>其中 <span class="math inline">\(\boldsymbol{\epsilon} \sim
\mathcal{N}(0, \mathbf{I})\)</span> 是一个（合并了 <span
class="math inline">\(t\)</span> 次的）标准高斯噪声。</li>
</ul></li>
</ol>
<h4 id="前向过程的最终公式">2.3 前向过程的最终公式</h4>
<p>我们得到了前向过程中最关键的<strong>累积加噪公式</strong>： <span
class="math display">\[
q(\mathbf{x}_t | \mathbf{x}_0) = \mathcal{N}(\mathbf{x}_t;
\sqrt{\bar{\alpha}_t} \mathbf{x}_0, (1 - \bar{\alpha}_t) \mathbf{I})
\]</span> 这个公式的重参数化形式为： <span class="math display">\[
\mathbf{x}_t = \sqrt{\bar{\alpha}_t} \mathbf{x}_0 + \sqrt{1 -
\bar{\alpha}_t} \boldsymbol{\epsilon}
\]</span> <strong>意义：</strong> * <strong>训练效率：</strong>
这个公式是 DDPM 训练效率的<strong>关键</strong>。我们不需要迭代 <span
class="math inline">\(t\)</span> 次来生成 <span
class="math inline">\(\mathbf{x}_t\)</span>。 *
<strong>随机训练：</strong> 在训练神经网络时，我们可以： 1.
从数据集中拿一张清晰图片 <span
class="math inline">\(\mathbf{x}_0\)</span>。 2.
<strong>随机</strong>选择一个时间步 <span
class="math inline">\(t\)</span>（例如 <span
class="math inline">\(t=150\)</span>）。 3. 从 <span
class="math inline">\(\mathcal{N}(0, \mathbf{I})\)</span> 中采样一个噪声
<span class="math inline">\(\boldsymbol{\epsilon}\)</span>。 4.
使用上述公式<strong>一步</strong>计算出 <span
class="math inline">\(\mathbf{x}_t = \sqrt{\bar{\alpha}_t} \mathbf{x}_0
+ \sqrt{1 - \bar{\alpha}_t} \boldsymbol{\epsilon}\)</span>。 5. 将 <span
class="math inline">\((\mathbf{x}_t, t, \boldsymbol{\epsilon})\)</span>
喂给神经网络进行训练。</p>
<p>当 <span class="math inline">\(t \to T\)</span> 时（例如 <span
class="math inline">\(T=1000\)</span>），<span
class="math inline">\(\bar{\alpha}_T = \prod_{i=1}^T (1 -
\beta_i)\)</span>。由于所有的 <span class="math inline">\(\beta_i &gt;
0\)</span>，<span class="math inline">\(\bar{\alpha}_T\)</span>
会非常接近 0。 此时： <span class="math display">\[
\mathbf{x}_T \approx \sqrt{0} \mathbf{x}_0 + \sqrt{1 - 0}
\boldsymbol{\epsilon} = \boldsymbol{\epsilon}
\]</span> 这意味着，在 <span class="math inline">\(T\)</span>
步之后，<span class="math inline">\(\mathbf{x}_T\)</span> 的分布 <span
class="math inline">\(q(\mathbf{x}_T | \mathbf{x}_0) \approx
\mathcal{N}(0,
\mathbf{I})\)</span>，它几乎完全变成了<strong>标准高斯噪声</strong>，并且与
<span class="math inline">\(\mathbf{x}_0\)</span> 无关。</p>
<p>成功地将复杂的图片分布 <span
class="math inline">\(q(\mathbf{x}_0)\)</span>
转化为了简单的标准高斯分布 <span
class="math inline">\(q(\mathbf{x}_T)\)</span>。</p>
<p><strong>小结</strong></p>
<p>核心问题：如何<strong>逆转</strong>这个过程？如何从一张纯噪声图片
<span class="math inline">\(\mathbf{x}_T \sim \mathcal{N}(0,
\mathbf{I})\)</span> 出发，一步步去噪，最终得到一张清晰的图片 <span
class="math inline">\(\mathbf{x}_0\)</span>？</p>
<p>这需要推导<strong>反向去噪过程 (Reverse Process)</strong> <span
class="math inline">\(p_\theta(\mathbf{x}_{t-1} |
\mathbf{x}_t)\)</span>。</p>
<h3 id="反向过程从噪声到图像-the-reverse-process">3.
反向过程：从噪声到图像 (The Reverse Process)</h3>
<p>我们的目标是学习反向的马尔可夫链，即 <span
class="math inline">\(p_\theta(\mathbf{x}_{t-1} |
\mathbf{x}_t)\)</span>。</p>
<h4 id="棘手的目标-pmathbfx_t-1-mathbfx_t">3.1 棘手的目标 <span
class="math inline">\(p(\mathbf{x}_{t-1} | \mathbf{x}_t)\)</span></h4>
<p>我们想从 <span class="math inline">\(\mathbf{x}_t\)</span> 推导出
<span class="math inline">\(\mathbf{x}_{t-1}\)</span>。根据贝叶斯公式：
<span class="math display">\[
p(\mathbf{x}_{t-1} | \mathbf{x}_t) = \frac{p(\mathbf{x}_t |
\mathbf{x}_{t-1}) p(\mathbf{x}_{t-1})}{p(\mathbf{x}_t)}
\]</span> * <span class="math inline">\(p(\mathbf{x}_t |
\mathbf{x}_{t-1})\)</span> 就是前向过程 <span
class="math inline">\(q(\mathbf{x}_t |
\mathbf{x}_{t-1})\)</span>，我们已知。 * <span
class="math inline">\(p(\mathbf{x}_{t-1})\)</span> 是 <span
class="math inline">\(t-1\)</span> 时刻的边缘分布，需要对所有 <span
class="math inline">\(\mathbf{x}_0\)</span> 积分 <span
class="math inline">\(p(\mathbf{x}_{t-1}) = \int q(\mathbf{x}_{t-1} |
\mathbf{x}_0) q(\mathbf{x}_0) d\mathbf{x}_0\)</span>，这依赖于 <span
class="math inline">\(q(\mathbf{x}_0)\)</span>（真实数据分布），<strong>极其困难
(intractable)</strong>。 * <span
class="math inline">\(p(\mathbf{x}_t)\)</span> 同样难以计算。</p>
<h4 id="ddpm-的核心创见利用-mathbfx_0-对应">3.2 DDPM 的核心创见：利用
<span class="math inline">\(\mathbf{x}_0\)</span> (对应)</h4>
<p><strong>关键洞察：</strong> 虽然 <span
class="math inline">\(p(\mathbf{x}_{t-1} | \mathbf{x}_t)\)</span>
难以计算，但<strong>如果我们额外知道 <span
class="math inline">\(\mathbf{x}_0\)</span></strong>，这个后验分布 <span
class="math inline">\(q(\mathbf{x}_{t-1} | \mathbf{x}_t,
\mathbf{x}_0)\)</span> <strong>是可计算的</strong>！</p>
<p>为什么？因为我们定义了所有 <span class="math inline">\(q\)</span>
的前向步骤。我们再次使用贝叶斯公式 (对应)： <span
class="math display">\[
q(\mathbf{x}_{t-1} | \mathbf{x}_t, \mathbf{x}_0) = \frac{q(\mathbf{x}_t
| \mathbf{x}_{t-1}, \mathbf{x}_0) \cdot q(\mathbf{x}_{t-1} |
\mathbf{x}_0)}{q(\mathbf{x}_t | \mathbf{x}_0)}
\]</span> 利用马尔可夫性质 <span class="math inline">\(q(\mathbf{x}_t |
\mathbf{x}_{t-1}, \mathbf{x}_0) = q(\mathbf{x}_t |
\mathbf{x}_{t-1})\)</span>，我们得到： <span class="math display">\[
q(\mathbf{x}_{t-1} | \mathbf{x}_t, \mathbf{x}_0) \propto q(\mathbf{x}_t
| \mathbf{x}_{t-1}) \cdot q(\mathbf{x}_{t-1} | \mathbf{x}_0)
\]</span> 我们已知这三个分布都是高斯分布（在第 2 部分已推导）： 1. <span
class="math inline">\(q(\mathbf{x}_t | \mathbf{x}_{t-1}) =
\mathcal{N}(\mathbf{x}_t; \sqrt{\alpha_t} \mathbf{x}_{t-1}, \beta_t
\mathbf{I})\)</span> 2. <span class="math inline">\(q(\mathbf{x}_{t-1} |
\mathbf{x}_0) = \mathcal{N}(\mathbf{x}_{t-1}; \sqrt{\bar{\alpha}_{t-1}}
\mathbf{x}_0, (1 - \bar{\alpha}_{t-1}) \mathbf{I})\)</span> 3. <span
class="math inline">\(q(\mathbf{x}_t | \mathbf{x}_0) =
\mathcal{N}(\mathbf{x}_t; \sqrt{\bar{\alpha}_t} \mathbf{x}_0, (1 -
\bar{\alpha}_t) \mathbf{I})\)</span></p>
<p>我们正在用 <span class="math inline">\(\mathbf{x}_{t-1}\)</span>
作为变量，乘以两个高斯分布的概率密度函数 (PDF)。高斯 PDF 的形式是 <span
class="math inline">\(C \cdot \exp(-\frac{(x -
\mu)^2}{2\sigma^2})\)</span>。两个高斯 PDF
相乘的结果<strong>仍然是一个高斯分布</strong>。</p>
<p>通过匹配 <span class="math inline">\(\mathbf{x}_{t-1}\)</span>
的一次项和二次项系数（一个繁琐但直接的代数过程），我们可以解出这个新高斯分布的均值
<span class="math inline">\(\tilde{\boldsymbol{\mu}}_t\)</span> 和方差
<span class="math inline">\(\tilde{\beta}_t\)</span>：</p>
<p><span class="math display">\[
q(\mathbf{x}_{t-1} | \mathbf{x}_t, \mathbf{x}_0) =
\mathcal{N}(\mathbf{x}_{t-1}; \tilde{\boldsymbol{\mu}}_t(\mathbf{x}_t,
\mathbf{x}_0), \tilde{\beta}_t \mathbf{I})
\]</span> 其中： * <strong>方差 <span
class="math inline">\(\tilde{\beta}_t\)</span></strong>：不依赖于 <span
class="math inline">\(\mathbf{x}_t\)</span> 或 <span
class="math inline">\(\mathbf{x}_0\)</span>，它是一个固定的超参数。
<span class="math display">\[
    \tilde{\beta}_t = \frac{1 - \bar{\alpha}_{t-1}}{1 - \bar{\alpha}_t}
\cdot \beta_t
    \]</span> * <strong>均值 <span
class="math inline">\(\tilde{\boldsymbol{\mu}}_t\)</span></strong>：依赖于
<span class="math inline">\(\mathbf{x}_t\)</span> 和 <span
class="math inline">\(\mathbf{x}_0\)</span>。 <span
class="math display">\[
    \tilde{\boldsymbol{\mu}}_t(\mathbf{x}_t, \mathbf{x}_0) =
\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_t}{1 - \bar{\alpha}_t} \mathbf{x}_0
+ \frac{\sqrt{\alpha_t}(1 - \bar{\alpha}_{t-1})}{1 - \bar{\alpha}_t}
\mathbf{x}_t
    \]</span></p>
<h3 id="训练学习反向过程-training">4. 训练：学习反向过程 (Training)</h3>
<h4 id="神经网络的目标">4.1 神经网络的目标</h4>
<p>我们有了一个完美的目标分布 <span
class="math inline">\(q(\mathbf{x}_{t-1} | \mathbf{x}_t,
\mathbf{x}_0)\)</span>。但它有个问题：在<strong>推理
(Inference)</strong> 时，我们从 <span
class="math inline">\(\mathbf{x}_T\)</span> 开始，并不知道 <span
class="math inline">\(\mathbf{x}_0\)</span>。</p>
<p>因此，我们训练一个神经网络 <span
class="math inline">\(p_\theta\)</span>
来<strong>近似</strong>这个分布： <span class="math display">\[
p_\theta(\mathbf{x}_{t-1} | \mathbf{x}_t) =
\mathcal{N}(\mathbf{x}_{t-1}; \boldsymbol{\mu}_\theta(\mathbf{x}_t, t),
\boldsymbol{\Sigma}_\theta(\mathbf{x}_t, t))
\]</span> 我们的目标是让 <span class="math inline">\(p_\theta\)</span>
尽可能接近 <span class="math inline">\(q\)</span>。 * <strong>简化1
(固定方差)</strong>：DDPM 论文发现，将神经网络的方差 <span
class="math inline">\(\boldsymbol{\Sigma}_\theta\)</span> 固定为 <span
class="math inline">\(\tilde{\beta}_t \mathbf{I}\)</span> 或 <span
class="math inline">\(\beta_t \mathbf{I}\)</span>
效果最好。这极大地简化了问题：<strong>神经网络只需要学习均值 <span
class="math inline">\(\boldsymbol{\mu}_\theta\)</span></strong>。 *
<strong>简化2 (学习目标)</strong>：我们训练 <span
class="math inline">\(\boldsymbol{\mu}_\theta(\mathbf{x}_t, t)\)</span>
来预测真实均值 <span
class="math inline">\(\tilde{\boldsymbol{\mu}}_t(\mathbf{x}_t,
\mathbf{x}_0)\)</span>。</p>
<h4 id="ddpm-的关键改进预测噪声-对应">4.2 DDPM 的关键改进：预测噪声
(对应)</h4>
<p><span class="math inline">\(\tilde{\boldsymbol{\mu}}_t\)</span>
的公式 <span
class="math inline">\(\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_t}{1 -
\bar{\alpha}_t} \mathbf{x}_0 + \frac{\sqrt{\alpha_t}(1 -
\bar{\alpha}_{t-1})}{1 - \bar{\alpha}_t} \mathbf{x}_t\)</span>
仍然很复杂。</p>
<p><strong>DDPM 论文提出了一个重要的的重参数化：</strong> 我们回顾第 2
部分的前向公式：<span class="math inline">\(\mathbf{x}_t =
\sqrt{\bar{\alpha}_t} \mathbf{x}_0 + \sqrt{1 - \bar{\alpha}_t}
\boldsymbol{\epsilon}\)</span> 我们可以用它来反解 <span
class="math inline">\(\mathbf{x}_0\)</span>（在 <span
class="math inline">\(\mathbf{x}_t\)</span> 和 <span
class="math inline">\(\boldsymbol{\epsilon}\)</span> 已知的情况下）：
<span class="math display">\[
\mathbf{x}_0 = \frac{1}{\sqrt{\bar{\alpha}_t}} (\mathbf{x}_t - \sqrt{1 -
\bar{\alpha}_t} \boldsymbol{\epsilon})
\]</span> 现在，我们将这个 <span
class="math inline">\(\mathbf{x}_0\)</span> 的表达式代入上面 <span
class="math inline">\(\tilde{\boldsymbol{\mu}}_t\)</span> 的复杂公式中：
<span class="math display">\[
\begin{aligned}
\tilde{\boldsymbol{\mu}}_t &amp;=
\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_t}{1 - \bar{\alpha}_t} \left(
\frac{1}{\sqrt{\bar{\alpha}_t}} (\mathbf{x}_t - \sqrt{1 -
\bar{\alpha}_t} \boldsymbol{\epsilon}) \right) + \frac{\sqrt{\alpha_t}(1
- \bar{\alpha}_{t-1})}{1 - \bar{\alpha}_t} \mathbf{x}_t \\
&amp;= \left( \frac{\sqrt{\bar{\alpha}_{t-1}}\beta_t}{(1 -
\bar{\alpha}_t)\sqrt{\bar{\alpha}_t}} + \frac{\sqrt{\alpha_t}(1 -
\bar{\alpha}_{t-1})}{1 - \bar{\alpha}_t} \right) \mathbf{x}_t - \left(
\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_t \sqrt{1 - \bar{\alpha}_t}}{(1 -
\bar{\alpha}_t)\sqrt{\bar{\alpha}_t}} \right) \boldsymbol{\epsilon}
\end{aligned}
\]</span> (经过一系列基于 <span class="math inline">\(\bar{\alpha}_t =
\alpha_t \bar{\alpha}_{t-1}\)</span> 和 <span
class="math inline">\(\beta_t = 1 - \alpha_t\)</span> 的代数化简) <span
class="math display">\[
\tilde{\boldsymbol{\mu}}_t = \frac{1}{\sqrt{\alpha_t}} \left(
\mathbf{x}_t - \frac{\beta_t}{\sqrt{1 - \bar{\alpha}_t}}
\boldsymbol{\epsilon} \right)
\]</span> <strong>分析这个优美的公式：</strong> * <span
class="math inline">\(\alpha_t\)</span>, <span
class="math inline">\(\beta_t\)</span>, <span
class="math inline">\(\bar{\alpha}_t\)</span> 都是预先设定的超参数。 *
<span class="math inline">\(\mathbf{x}_t\)</span> 是神经网络的输入。 *
<strong>唯一未知的就是 <span
class="math inline">\(\boldsymbol{\epsilon}\)</span></strong> ——
那个在第 2 部分用于从 <span class="math inline">\(\mathbf{x}_0\)</span>
生成 <span class="math inline">\(\mathbf{x}_t\)</span>
的<strong>原始噪声</strong>。</p>
<p><strong>结论（DDPM 核心思想）：</strong> (对应) 与其让神经网络 <span
class="math inline">\(\boldsymbol{\mu}_\theta\)</span>
预测那个复杂的均值 <span
class="math inline">\(\tilde{\boldsymbol{\mu}}_t\)</span>，我们可以让它转而去预测这个<strong>噪声
<span class="math inline">\(\boldsymbol{\epsilon}\)</span></strong>。
我们定义一个神经网络（通常是 U-Net 结构）<span
class="math inline">\(\boldsymbol{\epsilon}_\theta(\mathbf{x}_t,
t)\)</span>，它的目标就是预测 <span
class="math inline">\(\boldsymbol{\epsilon}\)</span>。</p>
<h4 id="训练流程与损失函数-对应-012440">4.3 训练流程与损失函数
(对应-[01:24:40])</h4>
<ol type="1">
<li>从数据集中随机抽取一张清晰图像 <span
class="math inline">\(\mathbf{x}_0\)</span>。</li>
<li><strong>随机</strong>选择一个时间步 <span
class="math inline">\(t\)</span>（从 1 到 <span
class="math inline">\(T\)</span>）。(对应 随机训练)</li>
<li><strong>随机</strong>采样一个标准高斯噪声 <span
class="math inline">\(\boldsymbol{\epsilon} \sim \mathcal{N}(0,
\mathbf{I})\)</span>。(对应)</li>
<li>使用前向公式<strong>一步</strong>生成加噪图像：<span
class="math inline">\(\mathbf{x}_t = \sqrt{\bar{\alpha}_t} \mathbf{x}_0
+ \sqrt{1 - \bar{\alpha}_t} \boldsymbol{\epsilon}\)</span>。</li>
<li>将 <span class="math inline">\((\mathbf{x}_t, t)\)</span>
作为输入，喂给神经网络 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta(\mathbf{x}_t,
t)\)</span>，得到预测噪声 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta\)</span>。</li>
<li>计算损失函数（均方误差 MSE）：(对应) <span class="math display">\[
L(\theta) = E_{t, \mathbf{x}_0, \boldsymbol{\epsilon}} \left[ ||
\boldsymbol{\epsilon} - \boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t)
||^2 \right]
\]</span></li>
<li>使用梯度下降更新网络参数 <span
class="math inline">\(\theta\)</span>。</li>
</ol>
<h3 id="推理逐步去噪生成图像-inference">5. 推理：逐步去噪生成图像
(Inference)</h3>
<p>当训练好 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta\)</span>
后，就可以从纯噪声生成图像了：</p>
<ol type="1">
<li><strong>起始：</strong> 从标准高斯分布中采样一张纯噪声图像 <span
class="math inline">\(\mathbf{x}_T \sim \mathcal{N}(0,
\mathbf{I})\)</span>。</li>
<li><strong>迭代：</strong> <strong>从 <span class="math inline">\(t =
T\)</span> 循环到 <span class="math inline">\(t = 1\)</span></strong>：
<ol type="a">
<li>将当前的 <span class="math inline">\(\mathbf{x}_t\)</span> 和时间步
<span class="math inline">\(t\)</span> 输入网络，得到噪声预测：<span
class="math inline">\(\boldsymbol{\epsilon}_\theta =
\boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t)\)</span>。(对应)</li>
<li>使用 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta\)</span> 作为我们对
<span class="math inline">\(\boldsymbol{\epsilon}\)</span>
的最佳估计，代入 <strong>4.2</strong> 中的均值公式，计算 <span
class="math inline">\(t-1\)</span> 步的<strong>均值</strong> <span
class="math inline">\(\boldsymbol{\mu}_\theta(\mathbf{x}_t,
t)\)</span>：(对应) <span class="math display">\[
\boldsymbol{\mu}_\theta(\mathbf{x}_t, t) = \frac{1}{\sqrt{\alpha_t}}
\left( \mathbf{x}_t - \frac{\beta_t}{\sqrt{1 - \bar{\alpha}_t}}
\boldsymbol{\epsilon}_\theta \right)
\]</span></li>
<li>计算 <span class="math inline">\(t-1\)</span>
步的<strong>方差</strong>。我们使用固定的方差 <span
class="math inline">\(\sigma_t^2 \mathbf{I} = \tilde{\beta}_t \mathbf{I}
= \frac{1 - \bar{\alpha}_{t-1}}{1 - \bar{\alpha}_t} \beta_t
\mathbf{I}\)</span>。</li>
<li><strong>采样 (Sampling)</strong> (对应)：从这个高斯分布中采样 <span
class="math inline">\(\mathbf{x}_{t-1}\)</span>： <span
class="math display">\[
\mathbf{x}_{t-1} = \boldsymbol{\mu}_\theta(\mathbf{x}_t, t) + \sigma_t
\mathbf{z}
\]</span> 其中 <span class="math inline">\(\mathbf{z} \sim
\mathcal{N}(0, \mathbf{I})\)</span> 是一个新采样的随机噪声。
（<em>注意：当 <span class="math inline">\(t=1\)</span> 时，<span
class="math inline">\(\mathbf{z}\)</span> 设为 0，因为 <span
class="math inline">\(\mathbf{x}_0\)</span>
应该是一个确定性的输出，不再添加噪声</em>）。</li>
</ol></li>
<li><strong>结束：</strong> 当循环结束时，<span
class="math inline">\(\mathbf{x}_0\)</span>
就是生成的清晰图像。(对应)</li>
</ol>
<p><strong>小结</strong></p>
<p>完整地推导了 DDPM 的核心数学原理： 1. <strong>前向过程 <span
class="math inline">\(q\)</span></strong>：使用 <span
class="math inline">\(q(\mathbf{x}_t | \mathbf{x}_0)\)</span> 高效加噪。
2. <strong>反向过程 <span
class="math inline">\(p_\theta\)</span></strong>：通过贝叶斯公式推导出
<span class="math inline">\(q(\mathbf{x}_{t-1} | \mathbf{x}_t,
\mathbf{x}_0)\)</span> 作为理想目标。 3. <strong>训练 <span
class="math inline">\(p_\theta\)</span></strong>：通过让 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta(\mathbf{x}_t,
t)\)</span> 预测真实噪声 <span
class="math inline">\(\boldsymbol{\epsilon}\)</span> 来简化训练目标 (MSE
Loss)。 4. <strong>推理 <span
class="math inline">\(p_\theta\)</span></strong>：从 <span
class="math inline">\(\mathbf{x}_T\)</span> 开始，利用 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta\)</span>
预测的均值，逐步采样 <span
class="math inline">\(\mathbf{x}_{t-1}\)</span>。</p>
<p>DDPM 的一个主要缺点是<strong>推理速度慢</strong>（需要 <span
class="math inline">\(T\)</span> 步，例如 1000 步）。</p>
<p><strong>DDIM (Denoising Diffusion Implicit Models)</strong>。</p>
<p>DDPM 的效果很好，但它有两个主要缺点： 1.
<strong>推理速度慢：</strong> 它是一个马尔可夫过程，从 <span
class="math inline">\(\mathbf{x}_T\)</span> 生成 <span
class="math inline">\(\mathbf{x}_0\)</span> 必须执行 <span
class="math inline">\(T\)</span> 步（例如 1000 步）采样，非常耗时。 2.
<strong>推理是随机的：</strong> (Stochastic) 在每一步采样 <span
class="math inline">\(\mathbf{x}_{t-1} =
\boldsymbol{\mu}_\theta(\mathbf{x}_t, t) + \sigma_t \mathbf{z}\)</span>
时，都需要加入一个新的随机噪声 <span
class="math inline">\(\mathbf{z}\)</span>。这意味着即使从同一个 <span
class="math inline">\(\mathbf{x}_T\)</span> 出发，两次推理也会得到不同的
<span
class="math inline">\(\mathbf{x}_0\)</span>。这对于需要一致性的任务（如图像编辑）来说是个问题。</p>
<p>DDIM（2020年提出）巧妙地解决了这两个问题，并且<strong>无需重新训练</strong>在
DDPM 上训练好的模型。</p>
<p>这对应于您大纲中的 - 部分。</p>
<h3 id="ddim推理升级">6. DDIM：推理升级</h3>
<h4 id="ddim-的核心洞察重新审视反向过程">6.1 DDIM
的核心洞察：重新审视反向过程</h4>
<p>DDIM 的出发点是重新审视我们推导出的反向过程。DDPM 假设反向过程是
<span class="math inline">\(p_\theta(\mathbf{x}_{t-1} |
\mathbf{x}_t)\)</span>，并用它来近似 <span
class="math inline">\(q(\mathbf{x}_{t-1} | \mathbf{x}_t,
\mathbf{x}_0)\)</span>。</p>
<p>DDIM 注意到，我们训练的神经网络 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta(\mathbf{x}_t,
t)\)</span> 实际上是在预测噪声 <span
class="math inline">\(\boldsymbol{\epsilon}\)</span>。
回顾我们的前向公式： <span class="math display">\[
\mathbf{x}_t = \sqrt{\bar{\alpha}_t} \mathbf{x}_0 + \sqrt{1 -
\bar{\alpha}_t} \boldsymbol{\epsilon}
\]</span> 既然我们有了 <span
class="math inline">\(\mathbf{x}_t\)</span>（当前输入）和 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta\)</span>（网络预测的
<span
class="math inline">\(\boldsymbol{\epsilon}\)</span>），我们可以直接反解出<strong>对清晰图像
<span class="math inline">\(\mathbf{x}_0\)</span>
的预测</strong>，我们称之为 <span
class="math inline">\(\hat{\mathbf{x}}_0\)</span>：</p>
<p><span class="math display">\[
\hat{\mathbf{x}}_0 = \frac{1}{\sqrt{\bar{\alpha}_t}} \left( \mathbf{x}_t
- \sqrt{1 - \bar{\alpha}_t} \boldsymbol{\epsilon}_\theta(\mathbf{x}_t,
t) \right)
\]</span> 这个 <span class="math inline">\(\hat{\mathbf{x}}_0\)</span>
是给定 <span class="math inline">\(\mathbf{x}_t\)</span>
时，模型对最终结果 <span class="math inline">\(\mathbf{x}_0\)</span>
的“最佳猜测”。</p>
<h4 id="升级-1确定性推理-deterministic-inference-对应">6.2 升级
1：确定性推理 (Deterministic Inference) (对应)</h4>
<p>DDPM 的采样公式为： <span class="math display">\[
\mathbf{x}_{t-1} = \underbrace{\boldsymbol{\mu}_\theta(\mathbf{x}_t,
t)}_{\text{均值}} + \underbrace{\sigma_t \mathbf{z}}_{\text{随机噪声}}
\]</span> DDIM 提出，这个过程不一定是随机的。DDIM 引入了一个新的参数
<span class="math inline">\(\eta\)</span> (eta) 来控制随机性。 * 当
<span class="math inline">\(\eta=1\)</span> 时，DDIM 的采样过程与 DDPM
完全相同（随机）。 * 当 <span class="math inline">\(\eta=0\)</span>
时，采样过程中的方差 <span class="math inline">\(\sigma_t\)</span>
被设为 0。</p>
<p><strong>当 <span class="math inline">\(\eta=0\)</span>（方差 <span
class="math inline">\(\sigma_t=0\)</span>）时</strong>，采样步骤变为：
<span class="math display">\[
\mathbf{x}_{t-1} = \boldsymbol{\mu}_\theta(\mathbf{x}_t, t)
\]</span> <strong>这是确定性的！</strong> 没有随机噪声 <span
class="math inline">\(\mathbf{z}\)</span> 的介入。</p>
<p><strong>这有什么用？</strong> 这意味着从一个固定的 <span
class="math inline">\(\mathbf{x}_T\)</span>
出发，无论运行多少次，<strong>总会生成完全相同的 <span
class="math inline">\(\mathbf{x}_0\)</span></strong>。这使得扩散模型可用于图像编辑、风格转换等需要保持一致性的任务。</p>
<p>DDIM 论文推导出了一个更通用的采样公式，它不依赖于 <span
class="math inline">\(\boldsymbol{\mu}_\theta\)</span> 而是直接使用
<span class="math inline">\(\hat{\mathbf{x}}_0\)</span> 和 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta\)</span>。 当 <span
class="math inline">\(\eta=0\)</span> (即 <span
class="math inline">\(\sigma_t = 0\)</span>) 时，从 <span
class="math inline">\(\mathbf{x}_t\)</span> 到 <span
class="math inline">\(\mathbf{x}_{t-1}\)</span>
的<strong>确定性采样公式</strong>为：</p>
<p><span class="math display">\[
\mathbf{x}_{t-1} = \underbrace{\sqrt{\bar{\alpha}_{t-1}}
\hat{\mathbf{x}}_0}_{\text{指向“预测的” } \mathbf{x}_0} +
\underbrace{\sqrt{1 - \bar{\alpha}_{t-1}} \cdot \left(
\frac{\mathbf{x}_t - \sqrt{\bar{\alpha}_t} \hat{\mathbf{x}}_0}{\sqrt{1 -
\bar{\alpha}_t}} \right)}_{\text{指向“当前的” } \mathbf{x}_t \text{
的方向}}
\]</span> (注意：<span class="math inline">\(\frac{\mathbf{x}_t -
\sqrt{\bar{\alpha}_t} \hat{\mathbf{x}}_0}{\sqrt{1 -
\bar{\alpha}_t}}\)</span> 正好等于 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta\)</span> )
所以，确定性（<span class="math inline">\(\eta=0\)</span>）的 DDIM
采样步骤也可以写为： <span class="math display">\[
\mathbf{x}_{t-1} = \sqrt{\bar{\alpha}_{t-1}} \hat{\mathbf{x}}_0 +
\sqrt{1 - \bar{\alpha}_{t-1}} \cdot \boldsymbol{\epsilon}_\theta
\]</span></p>
<h4 id="升级-2跳步采样-skip-sampling-对应">6.3 升级 2：跳步采样 (Skip
Sampling) (对应)</h4>
<p>DDPM 必须一步一步 <span class="math inline">\(t \to t-1 \to t-2
\dots\)</span> 地采样，因为它是马尔可夫过程。</p>
<p>DDIM
的采样公式（如上所示）是<strong>非马尔可夫的</strong>。它不依赖于 <span
class="math inline">\(q(\mathbf{x}_{t-1} | \mathbf{x}_t,
\mathbf{x}_0)\)</span>，而是直接使用在 <span
class="math inline">\(t\)</span> 时刻预测的 <span
class="math inline">\(\hat{\mathbf{x}}_0\)</span> 来计算 <span
class="math inline">\(\mathbf{x}_{t-1}\)</span>。</p>
<p><strong>关键洞察：</strong> 既然我们能从 <span
class="math inline">\(\mathbf{x}_t\)</span> 预测出 <span
class="math inline">\(\hat{\mathbf{x}}_0\)</span>，我们不仅能计算 <span
class="math inline">\(\mathbf{x}_{t-1}\)</span>，我们能计算<strong>任意</strong>
<span class="math inline">\(\mathbf{x}_{\tau}\)</span> (其中 <span
class="math inline">\(\tau &lt; t\)</span>)。</p>
<p>这使得<strong>跳步采样</strong>成为可能。我们不再需要完整的 <span
class="math inline">\(T=1000\)</span>
步，我们可以定义一个更短的子序列，例如 <span
class="math inline">\(S=20\)</span> 步： <span
class="math inline">\((\tau_1, \tau_2, \dots, \tau_S) = (1, 51, 101,
\dots, 951)\)</span></p>
<p>我们的推理循环不再是 <code>for t in (T...1)</code>，而是
<code>for i in (S...1)</code>： * <strong>当前步</strong>：<span
class="math inline">\(\tau_i\)</span> (例如 <span
class="math inline">\(\tau_{20} = 951\)</span>) *
<strong>目标步</strong>：<span class="math inline">\(\tau_{i-1}\)</span>
(例如 <span class="math inline">\(\tau_{19} = 901\)</span>)</p>
<p><strong>DDIM 跳步采样（确定性）公式：</strong> (对应)</p>
<ol type="1">
<li><strong>输入：</strong> 当前噪声图像 <span
class="math inline">\(\mathbf{x}_{\tau_i}\)</span> 和时间步 <span
class="math inline">\(\tau_i\)</span>。</li>
<li><strong>预测 <span
class="math inline">\(\hat{\mathbf{x}}_0\)</span>：</strong>
(与之前相同) <span class="math display">\[
\hat{\mathbf{x}}_0 = \frac{1}{\sqrt{\bar{\alpha}_{\tau_i}}} \left(
\mathbf{x}_{\tau_i} - \sqrt{1 - \bar{\alpha}_{\tau_i}}
\boldsymbol{\epsilon}_\theta(\mathbf{x}_{\tau_i}, \tau_i) \right)
\]</span></li>
<li><strong>计算 <span
class="math inline">\(\mathbf{x}_{\tau_{i-1}}\)</span>：</strong>
(使用确定性公式，将 <span class="math inline">\(t-1\)</span> 替换为
<span class="math inline">\(\tau_{i-1}\)</span>) <span
class="math display">\[
\mathbf{x}_{\tau_{i-1}} = \sqrt{\bar{\alpha}_{\tau_{i-1}}}
\hat{\mathbf{x}}_0 + \sqrt{1 - \bar{\alpha}_{\tau_{i-1}}} \cdot
\boldsymbol{\epsilon}_\theta(\mathbf{x}_{\tau_i}, \tau_i)
\]</span></li>
</ol>
<p><strong>结果：</strong> 我们不再需要 1000
步计算，而是通过<strong>跳步</strong>，仅用 20 步就完成了从 <span
class="math inline">\(\mathbf{x}_T\)</span> 到 <span
class="math inline">\(\mathbf{x}_0\)</span> 的生成。这极大地（例如 50
倍）提升了推理速度。</p>
<p><strong>小结</strong></p>
<p>DDIM 是对 DDPM 的一次重大升级，它通过引入 <span
class="math inline">\(\hat{\mathbf{x}}_0\)</span>
预测和非马尔可夫采样，实现了： 1. <strong>确定性推理</strong>（<span
class="math inline">\(\eta=0\)</span>），增强了模型的可控性。 2.
<strong>跳步采样</strong>，极大缩短了推理时间。 3.
最重要的是，它<strong>复用</strong>了 DDPM 训练好的 <span
class="math inline">\(\boldsymbol{\epsilon}_\theta\)</span>
模型，无需额外训练。</p>
<p>好的，我们来探讨扩散模型演进的下一个重要阶段：<strong>流匹配 (Flow
Matching)</strong>。</p>
<p>在 DDPM 和 DDIM 中，我们都依赖于一个<strong>离散时间</strong>的
SDE（随机微分方程）或其确定性版本。我们模拟了 <span
class="math inline">\(T\)</span> 个离散步骤（例如 <span
class="math inline">\(T=1000\)</span>），这在数学上是有效的，但在概念上有些繁琐，并且依赖于
<span class="math inline">\(\beta_t\)</span> (或 <span
class="math inline">\(\bar{\alpha}_t\)</span>)
这个人工设计的“噪声表”。</p>
<p>流匹配 (Flow Matching, FM)
模型（2022年及后续工作）提出了一种更简洁、更根本的视角：<strong>连续时间</strong>的<strong>常微分方程
(ODE)</strong>。</p>
<p>这对应于您大纲中的 - 部分。</p>
<h3 id="流匹配连续轨迹与速度预测">7. 流匹配：连续轨迹与速度预测</h3>
<h4 id="核心思想从-sde-到-ode">7.1 核心思想：从 SDE 到 ODE</h4>
<ul>
<li><strong>DDPM (SDE)</strong>：将图像 <span
class="math inline">\(\mathbf{x}_0\)</span> 变为噪声 <span
class="math inline">\(\mathbf{x}_T\)</span> 的过程是随机的（<span
class="math inline">\(\mathbf{x}_t = \sqrt{\alpha_t} \mathbf{x}_{t-1} +
\sqrt{\beta_t} \boldsymbol{\epsilon}\)</span>）。</li>
<li><strong>流匹配
(ODE)</strong>：我们构建一个<strong>确定性的</strong>、<strong>连续的</strong>“流”，将纯噪声
<span class="math inline">\(\mathbf{z}\)</span>（我们这里称为 <span
class="math inline">\(\mathbf{x}_0\)</span>）平滑地转变为清晰图像 <span
class="math inline">\(\mathbf{x}_1\)</span>。</li>
</ul>
<p>我们不再考虑离散步骤 <span class="math inline">\(t=1, 2, \dots,
T\)</span>，而是考虑一个连续时间 <span class="math inline">\(t \in [0,
1]\)</span>：</p>
<ul>
<li><span class="math inline">\(t=0\)</span>：<span
class="math inline">\(\mathbf{x}_0\)</span> 是从 <span
class="math inline">\(\mathcal{N}(0, \mathbf{I})\)</span>
采样的纯噪声。</li>
<li><span class="math inline">\(t=1\)</span>：<span
class="math inline">\(\mathbf{x}_1\)</span>
是我们想要生成的清晰图像。</li>
</ul>
<p>这个从 <span class="math inline">\(\mathbf{x}_0\)</span> 到 <span
class="math inline">\(\mathbf{x}_1\)</span> 的连续演变路径 <span
class="math inline">\(\mathbf{x}_t\)</span> 由一个<strong>常微分方程
(ODE)</strong> 描述：</p>
<p><span class="math display">\[
\frac{d\mathbf{x}_t}{dt} = \mathbf{v}(\mathbf{x}_t, t)
\]</span> * <span class="math inline">\(\mathbf{v}(\mathbf{x}_t,
t)\)</span> 是一个<strong>速度向量场 (velocity vector field)</strong>。
* 它告诉我们：当一个点位于位置 <span
class="math inline">\(\mathbf{x}_t\)</span> 和时间 <span
class="math inline">\(t\)</span>
时，它应该往哪个方向（向量）以多快的速度（模长）移动。 *
<strong>训练目标：</strong> 我们的神经网络 <span
class="math inline">\(\mathbf{v}_\theta(\mathbf{x}_t, t)\)</span>
的目标就是学习这个<strong>速度场 <span
class="math inline">\(\mathbf{v}\)</span></strong>，而不是像 DDPM
那样学习噪声 <span
class="math inline">\(\boldsymbol{\epsilon}\)</span>。</p>
<h4 id="训练学习速度场-对应">7.2 训练：学习速度场 (对应)</h4>
<p><strong>问题：</strong> 理论上存在一个理想的速度场 <span
class="math inline">\(\mathbf{v}\)</span>
可以将噪声分布“推向”图像分布，但这个理想的 <span
class="math inline">\(\mathbf{v}\)</span> 非常复杂，我们无法知道。</p>
<p><strong>流匹配的创见：</strong>
我们不需要知道那个复杂的理想场。我们可以<strong>自己定义</strong>无数条简单的路径，然后训练网络来学习这些简单路径的平均速度。</p>
<p><strong>1. 定义简单路径（直线模型）：</strong> 给定一个噪声 <span
class="math inline">\(\mathbf{x}_0 \sim \mathcal{N}(0,
\mathbf{I})\)</span> 和一张真实图像 <span
class="math inline">\(\mathbf{x}_1 \sim
q(\text{data})\)</span>，连接它们的最简单路径是什么？<strong>一条直线</strong>。</p>
<p><span class="math display">\[\\mathbf{x}\_t = (1 - t) \\mathbf{x}\_0
+ t \\mathbf{x}\_1
\]</span> * 当 <span class="math inline">\(t=0\)</span> 时，<span
class="math inline">\(\mathbf{x}_t = \mathbf{x}_0\)</span> (噪声)。</p>
<ul>
<li>当 <span class="math inline">\(t=1\)</span> 时，<span
class="math inline">\(\mathbf{x}_t = \mathbf{x}_1\)</span> (图像)。</li>
</ul>
<p><strong>2. 计算目标速度：</strong> 如果我们的“粒子” <span
class="math inline">\(\mathbf{x}_t\)</span> 沿着这条直线路径运动，它在
<span class="math inline">\(t\)</span> 时刻的速度 <span
class="math inline">\(\mathbf{v}_t\)</span> 是多少？我们对 <span
class="math inline">\(t\)</span> 求导：</p>
<p><span class="math display">\[
\mathbf{v}_t = \frac{d\mathbf{x}_t}{dt} = \frac{d}{dt} \left( (1 - t)
\mathbf{x}_0 + t \mathbf{x}_1 \right)
\]</span><span class="math display">\[
\mathbf{v}_t = -\mathbf{x}_0 + \mathbf{x}_1 = \mathbf{x}_1 -
\mathbf{x}_0
\]</span><strong>这就是流匹配的训练目标！</strong>
沿着这条直线路径，在任何时间 <span
class="math inline">\(t\)</span>，目标速度都是恒定的 <span
class="math inline">\(\mathbf{x}_1 - \mathbf{x}_0\)</span>。</p>
<p><strong>3. 训练流程：</strong></p>
<ol type="1">
<li>从数据集中随机抽取一张清晰图像 <span
class="math inline">\(\mathbf{x}_1\)</span>。</li>
<li>随机采样一个标准高斯噪声 <span class="math inline">\(\mathbf{x}_0
\sim \mathcal{N}(0, \mathbf{I})\)</span>。</li>
<li><strong>随机</strong>选择一个时间 <span
class="math inline">\(t\)</span>（从 <span class="math inline">\(U(0,
1)\)</span> 均匀采样）。</li>
<li>使用直线公式<strong>一步</strong>计算出路径上的点：<span
class="math inline">\(\mathbf{x}_t = (1 - t) \mathbf{x}_0 + t
\mathbf{x}_1\)</span>。</li>
<li>将 <span class="math inline">\((\mathbf{x}_t, t)\)</span>
作为输入，喂给神经网络 <span
class="math inline">\(\mathbf{v}_\theta(\mathbf{x}_t,
t)\)</span>，得到预测速度 <span
class="math inline">\(\mathbf{v}_\theta\)</span>。</li>
<li>计算损失函数（均方误差 MSE）： $$</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$L(\\theta) = E\_&#123;t, \\mathbf&#123;x&#125;\_0, \\mathbf&#123;x&#125;\_1&#125; \\left[ || (\\mathbf&#123;x&#125;\_1 - \\mathbf&#123;x&#125;*0) - \\mathbf&#123;v&#125;*\\theta(\\mathbf&#123;x&#125;\_t, t) ||^2 \\right]</span><br><span class="line">$$</span><br><span class="line">$$</span><br></pre></td></tr></table></figure>
<ol start="7" type="1">
<li>使用梯度下降更新网络参数 <span
class="math inline">\(\theta\)</span>。</li>
</ol>
<h4 id="推理求解-ode-对应">7.3 推理：求解 ODE (对应)</h4>
<p>当我们训练好 <span class="math inline">\(\mathbf{v}_\theta\)</span>
后，我们就有了一个完整的速度场，它知道在时空中的任何点 <span
class="math inline">\((\mathbf{x}, t)\)</span> 应该如何移动。</p>
<p><strong>问题：</strong> 如何从 <span
class="math inline">\(\mathbf{x}_0\)</span> 积分到 <span
class="math inline">\(\mathbf{x}_1\)</span>？ 我们需要求解 ODE <span
class="math inline">\(\frac{d\mathbf{x}_t}{dt} =
\mathbf{v}_\theta(\mathbf{x}_t, t)\)</span>，从 <span
class="math inline">\(t=0\)</span> 求解到 <span
class="math inline">\(t=1\)</span>。</p>
<p><strong>方法：</strong>
我们使用数值积分方法，最简单的就是<strong>欧拉近似法</strong>（我们在第
1 部分 提到过）。</p>
<ol type="1">
<li><strong>起始：</strong> 随机采样一张纯噪声图像 <span
class="math inline">\(\mathbf{x}_0 \sim \mathcal{N}(0,
\mathbf{I})\)</span>。</li>
<li><strong>离散化：</strong> 将时间 <span class="math inline">\([0,
1]\)</span> 分为 <span class="math inline">\(N\)</span> 步（例如 <span
class="math inline">\(N=20\)</span>），每一步 <span
class="math inline">\(\Delta t = 1/N\)</span>。</li>
<li><strong>迭代：</strong> <strong>从 <span class="math inline">\(t =
0\)</span> 循环到 <span class="math inline">\(t = 1 - \Delta
t\)</span></strong>：
<ol type="a">
<li>获取当前位置 <span class="math inline">\(\mathbf{x}_t\)</span>
和时间 <span class="math inline">\(t\)</span>。</li>
<li>输入网络，得到当前速度：<span
class="math inline">\(\mathbf{v}_\theta =
\mathbf{v}_\theta(\mathbf{x}_t, t)\)</span>。</li>
<li><strong>欧拉法更新：</strong> <span class="math display">\[
\]</span><span class="math display">\[\\mathbf{x}\_{t + \\Delta t} =
\\mathbf{x}*t + \\mathbf{v}*\\theta \\cdot \\Delta t
\]</span> $$$$(新位置 = 旧位置 + 速度 × 时间)</li>
</ol></li>
<li><strong>结束：</strong> 当循环结束时，<span
class="math inline">\(\mathbf{x}_1\)</span> 就是生成的清晰图像。</li>
</ol>
<p><strong>优势：</strong></p>
<ul>
<li><strong>更简单：</strong> 训练目标 <span
class="math inline">\(\mathbf{x}_1 - \mathbf{x}_0\)</span>
非常直观，摆脱了 DDPM 中复杂的 <span
class="math inline">\(\bar{\alpha}_t, \beta_t\)</span> 系数。</li>
<li><strong>更高效：</strong> ODE 路径通常比 SDE
路径“更直”，因此流匹配通常可以用更少的推理步骤（例如 10-50
步）生成高质量图像。</li>
<li><strong>更灵活：</strong> 我们可以使用比欧拉法更高级的 ODE
求解器（如 Runge-Kutta）来进一步提高精度和速度。</li>
</ul>
<p><strong>总结</strong></p>
<p>扩散模型从基础到前沿的全部核心数学：</p>
<ol type="1">
<li><strong>基础 (Part 1)</strong>：高斯分布、朗之万动力学 (SDE)
和贝叶斯公式。</li>
<li><strong>DDPM (Part 2-5)</strong>：
<ul>
<li><strong>前向 (q)</strong>：<span
class="math inline">\(q(\mathbf{x}_t | \mathbf{x}_0) =
\mathcal{N}(\sqrt{\bar{\alpha}_t} \mathbf{x}_0, (1 - \bar{\alpha}_t)
\mathbf{I})\)</span></li>
<li><strong>反向 (p)</strong>：<span
class="math inline">\(q(\mathbf{x}_{t-1} | \mathbf{x}_t,
\mathbf{x}_0)\)</span> 的推导。</li>
<li><strong>训练</strong>：预测噪声 <span class="math inline">\(L = ||
\boldsymbol{\epsilon} - \boldsymbol{\epsilon}_\theta(\mathbf{x}_t, t)
||^2\)</span>。</li>
<li><strong>推理</strong>：<span class="math inline">\(\mathbf{x}_{t-1}
= \boldsymbol{\mu}_\theta(\mathbf{x}_t, t) + \sigma_t
\mathbf{z}\)</span> (随机，T 步)。</li>
</ul></li>
<li><strong>DDIM (Part 6)</strong>：
<ul>
<li><strong>核心</strong>：预测 <span
class="math inline">\(\hat{\mathbf{x}}_0\)</span>。</li>
<li><strong>推理</strong>：<span
class="math inline">\(\mathbf{x}_{\tau_{i-1}} = \dots\)</span>
(确定性，可跳步)。</li>
</ul></li>
<li><strong>流匹配 (Part 7)</strong>：
<ul>
<li><strong>核心</strong>：ODE 连续流 <span
class="math inline">\(\frac{d\mathbf{x}_t}{dt} =
\mathbf{v}(\mathbf{x}_t, t)\)</span>。</li>
<li><strong>训练</strong>：预测速度 <span class="math inline">\(L = ||
(\mathbf{x}_1 - \mathbf{x}_0) - \mathbf{v}_\theta(\mathbf{x}_t, t)
||^2\)</span>。</li>
<li><strong>推理</strong>：<span class="math inline">\(\mathbf{x}_{t +
\Delta t} = \mathbf{x}_t + \mathbf{v}_\theta \cdot \Delta t\)</span>
(ODE 求解)。</li>
</ul></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/10/31/5120-1031/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/31/5120-1031/" class="post-title-link" itemprop="url">PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W8</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-10-31 21:00:00" itemprop="dateCreated datePublished" datetime="2025-10-31T21:00:00+08:00">2025-10-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-11-05 15:24:36" itemprop="dateModified" datetime="2025-11-05T15:24:36+08:00">2025-11-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHYS-5120/" itemprop="url" rel="index"><span itemprop="name">PHYS-5120</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>PHYS 5120 - 计算能源材料和电子结构模拟 Lecture</p>
<h2 id="møller-plesset-mp-微扰理论">1 Møller-Plesset (MP) 微扰理论:</h2>
<ul>
<li><strong>内容</strong>:</li>
</ul>
<p>量子化学中关于 <strong>Møller-Plesset (MP) 微扰理论</strong>
的推导过程。这是一种在 Hartree-Fock (HF)
方法基础上引入电子相关效应（electron correlation）的后-HF方法。</p>
<h3 id="标准微扰理论公式">标准微扰理论公式</h3>
<p>这部分列出的是通用的 <strong>Rayleigh-Schrödinger 微扰理论</strong>
(RSPT) 的基本公式：</p>
<ol type="1">
<li><strong>哈密顿算符 (Hamiltonian) 拆分:</strong>
<ul>
<li><span class="math inline">\(\hat{H} = \hat{H}_0 +
\hat{H}&#39;\)</span></li>
<li>将体系的总哈密顿算符 <span class="math inline">\(\hat{H}\)</span>
拆分为一个可以精确求解的零阶哈密顿算符 <span
class="math inline">\(\hat{H}_0\)</span> 和一个微扰项 <span
class="math inline">\(\hat{H}&#39;\)</span>。</li>
</ul></li>
<li><strong>能量和波函数的展开:</strong>
<ul>
<li><span class="math inline">\(E_n = E_n^{(0)} + E_n^{(1)} + E_n^{(2)}
+ \dots\)</span></li>
<li><span class="math inline">\(|n\rangle = |n^{(0)}\rangle +
|n^{(1)}\rangle + |n^{(2)}\rangle + \dots\)</span></li>
<li>体系的真实能量 <span class="math inline">\(E_n\)</span> 和波函数
<span class="math inline">\(|n\rangle\)</span>
可以展开为零阶、一阶、二阶等各级修正项的总和。</li>
</ul></li>
<li><strong>一阶能量修正 (First-order energy correction):</strong>
<ul>
<li><span class="math inline">\(E_n^{(1)} = \langle n^{(0)} |
\hat{H}&#39; | n^{(0)} \rangle\)</span></li>
<li>一阶能量修正是微扰算符 <span
class="math inline">\(\hat{H}&#39;\)</span> 在零阶波函数 <span
class="math inline">\(|n^{(0)}\rangle\)</span> 下的期望值。</li>
</ul></li>
<li><strong>二阶能量修正 (Second-order energy correction):</strong>
<ul>
<li><span class="math inline">\(E_n^{(2)} = \sum_{k \neq n}
\frac{|\langle k^{(0)} | \hat{H}&#39; | n^{(0)} \rangle|^2}{E_n^{(0)} -
E_k^{(0)}}\)</span></li>
<li>二阶能量修正涉及所有其他零阶本征态 <span
class="math inline">\(|k^{(0)}\rangle\)</span>。</li>
</ul></li>
</ol>
<h3 id="møller-plesset-理论的定义">Møller-Plesset 理论的定义</h3>
<p>这部分将上述通用公式应用到 MP 理论中，定义了 <span
class="math inline">\(\hat{H}_0\)</span> 和 <span
class="math inline">\(\hat{H}&#39;\)</span>：</p>
<ol type="1">
<li><strong>MP 理论的哈密顿算符定义:</strong>
<ul>
<li><strong>零阶哈密顿 <span
class="math inline">\(\hat{H}_0\)</span>:</strong>
<ul>
<li><span class="math inline">\(\hat{H}_0 = \hat{F} = \sum_{i=1}^N
\hat{f}(i)\)</span> (注：<span class="math inline">\(\hat{F}\)</span> 是
Fock 算符，<span class="math inline">\(\hat{H}_0\)</span> 被定义为 <span
class="math inline">\(N\)</span> 个电子的 Fock 算符之和)</li>
</ul></li>
<li><strong>微扰项 <span
class="math inline">\(\hat{H}&#39;\)</span>:</strong>
<ul>
<li><span class="math inline">\(\hat{H}&#39; = \hat{H} -
\hat{F}\)</span> (即 <span class="math inline">\(\hat{H} -
\hat{H}_0\)</span>)</li>
<li>微扰项是真实的哈密顿算符 <span
class="math inline">\(\hat{H}\)</span> (包含完整的电子-电子排斥) 与 Fock
算符 <span class="math inline">\(\hat{F}\)</span>
(只包含平均化的电子排斥) 之间的差值。这个差值就是 HF
理论所忽略的“电子相关”。</li>
</ul></li>
</ul></li>
<li><strong>零阶波函数和能量:</strong>
<ul>
<li>$|_0= $ HF Slater determinant</li>
<li>零阶波函数（即 <span class="math inline">\(\hat{H}_0\)</span>
的本征函数）被选为 <strong>Hartree-Fock (HF)
斯莱特行列式</strong>。</li>
<li><span class="math inline">\(\hat{H}_0 |\Phi_0\rangle = (\sum_{i=1}^N
\varepsilon_i) |\Phi_0\rangle\)</span></li>
<li>零阶能量 <span class="math inline">\(E^{(0)}\)</span> (即 <span
class="math inline">\(E_{MP0}\)</span>) 是所有被占据分子轨道 <span
class="math inline">\(\varepsilon_i\)</span> 的能量总和。</li>
<li><strong><span class="math inline">\(E_{MP0} = \langle \Phi_0 |
\hat{H}_0 | \Phi_0 \rangle = \sum_{i=1}^N
\varepsilon_i\)</span></strong></li>
</ul></li>
<li><strong>MP1 能量 (一阶能量修正):</strong>
<ul>
<li><span class="math inline">\(E_{MP1} = \langle \Phi_0 | \hat{H}&#39;
| \Phi_0 \rangle = \langle \Phi_0 | \hat{H} - \hat{F} | \Phi_0
\rangle\)</span></li>
<li><span class="math inline">\(E_{MP1} = \langle \Phi_0 | \hat{H} |
\Phi_0 \rangle - \langle \Phi_0 | \hat{F} | \Phi_0 \rangle\)</span></li>
<li>由于 <span class="math inline">\(\langle \Phi_0 | \hat{H} | \Phi_0
\rangle\)</span> 正是 Hartree-Fock 能量 <span
class="math inline">\(E_{HF}\)</span>，而 <span
class="math inline">\(\langle \Phi_0 | \hat{F} | \Phi_0 \rangle =
E_{MP0} = \sum \varepsilon_i\)</span>。</li>
<li>因此：<strong><span class="math inline">\(E_{MP1} = E_{HF} -
\sum_{i=1}^N \varepsilon_i\)</span></strong></li>
</ul></li>
</ol>
<blockquote>
<p><strong>重要结论：</strong> 零阶能量 (<span
class="math inline">\(E_{MP0}\)</span>) 和一阶能量 (<span
class="math inline">\(E_{MP1}\)</span>) 的总和恰好等于 Hartree-Fock
能量： <span class="math inline">\(E_{MP0} + E_{MP1} = (\sum
\varepsilon_i) + (E_{HF} - \sum \varepsilon_i) = E_{HF}\)</span>
这意味着 <strong>MP1 理论得到的总能量就是 HF 能量</strong>。要获得对 HF
能量的第一个修正（即电子相关能），我们必须计算到二阶，即
<strong>MP2</strong>。</p>
</blockquote>
<h2 id="mp2-能量推导">2. MP2 能量推导</h2>
<p>这部分是 MP 理论的核心，推导了 <strong>MP2
能量（二阶能量修正）</strong>：</p>
<ol type="1">
<li><strong>MP2 通用公式:</strong>
<ul>
<li><span class="math inline">\(E_{MP2} = \sum_{k \neq 0} \frac{|\langle
k | \hat{H}&#39; | 0 \rangle|^2}{E_0 - E_k}\)</span></li>
<li>这是将左侧的 <span class="math inline">\(E_n^{(2)}\)</span>
公式应用于基态 (<span class="math inline">\(n=0\)</span>)。</li>
</ul></li>
<li><strong>关键简化 (Brillouin 定理):</strong>
<ul>
<li>根据 Brillouin 定理，对于所有<strong>单激发</strong>行列式 <span
class="math inline">\(|\Phi_i^a\rangle\)</span> (即一个电子从占据轨道
<span class="math inline">\(i\)</span> 跃迁到空轨道 <span
class="math inline">\(a\)</span>)，矩阵元 <span
class="math inline">\(\langle \Phi_i^a | \hat{H}&#39; | \Phi_0 \rangle =
0\)</span>。</li>
<li>这意味着在求和 <span class="math inline">\(\sum_{k \neq 0}\)</span>
时，所有单激发的项都为零。</li>
<li>因此，对 MP2
能量有贡献的<strong>第一类非零项</strong>来自<strong>双激发</strong>行列式
(Doubly-excited determinants)，记为 <span
class="math inline">\(|\Phi_{ij}^{ab}\rangle\)</span>（即电子 <span
class="math inline">\(i, j\)</span> 激发到空轨道 <span
class="math inline">\(a, b\)</span>）。</li>
<li>白板中间的图示 <code>|| -&gt; #</code> (两条线变到两条更高阶的线)
正是形象地表示了这种双激发。</li>
</ul></li>
<li><strong>MP2 最终公式:</strong>
<ul>
<li><span class="math inline">\(E_{MP2} = \sum_{i&lt;j}^{occ}
\sum_{a&lt;b}^{vir} \frac{|\langle \Phi_{ij}^{ab} | \hat{H}&#39; |
\Phi_0 \rangle|^2}{\varepsilon_i + \varepsilon_j - \varepsilon_a -
\varepsilon_b}\)</span></li>
<li><strong>求和:</strong> 遍历所有占据轨道对 (<span
class="math inline">\(i, j\)</span>) 和所有空轨道（虚拟轨道）对 (<span
class="math inline">\(a, b\)</span>)。</li>
<li><strong>分母:</strong> <span class="math inline">\(E_0 - E_k = (\sum
\varepsilon) - (\sum \varepsilon - \varepsilon_i - \varepsilon_j +
\varepsilon_a + \varepsilon_b) = \varepsilon_i + \varepsilon_j -
\varepsilon_a -
\varepsilon_b\)</span>。这是零阶能量差，即激发所消耗的轨道能量。</li>
<li><strong>分子:</strong> <span class="math inline">\(\langle
\Phi_{ij}^{ab} | \hat{H}&#39; | \Phi_0 \rangle\)</span>
可以被简化为一个关于分子轨道的双电子积分 <span
class="math inline">\(\langle ij || ab \rangle\)</span>。</li>
</ul></li>
</ol>
<p><strong>总结：</strong> Møller-Plesset
微扰理论的标准推导，核心思想是将 HF
解作为零阶近似，并将电子相关的“剩余部分”作为微扰。推导表明，MP1
能量只是重现了 HF 能量，而 <strong>MP2
能量是第一个真正包含电子相关效应的修正项</strong>，它通过计算所有可能的双激发对总能量的贡献来实现。</p>
<p>从 Møller-Plesset (MP)
理论过渡到了另一种更高级的量子化学方法：<strong>耦合簇理论 (Coupled
Cluster Theory)</strong>。</p>
<h3 id="mp2-能量的深入探讨">MP2 能量的深入探讨</h3>
<p>这部分继续讨论 MP2 能量（二阶能量修正）：</p>
<ol type="1">
<li><strong>MP2 能量公式 (重复):</strong>
<ul>
<li><span class="math inline">\(E_{MP2} = \sum_{k \neq 0} \frac{|\langle
\Phi_0 | \hat{H}&#39; | \Phi_k \rangle|^2}{E_{MP0} -
E_k^{(0)}}\)</span></li>
<li>这是 MP2 能量的通用形式。</li>
</ul></li>
<li><strong>微扰的来源:</strong>
<ul>
<li><strong><span class="math inline">\(\frac{e^2}{|r_i -
r_j|}\)</span></strong> (被圈出)</li>
<li>这是电子-电子间的库仑排斥算符。这个项是 <span
class="math inline">\(\hat{H}\)</span>（真实哈密顿算符）和 <span
class="math inline">\(\hat{H}_0\)</span>（Fock
算符，仅包含平均场排斥）之间差异的核心。正是这个“瞬时相关”的相互作用导致了
<span class="math inline">\(\hat{H}&#39;\)</span>（微扰）的存在，也是 MP
理论试图修正的能量来源。</li>
</ul></li>
<li><strong>Brillouin 定理的应用:</strong>
<ul>
<li><span class="math inline">\(\langle \Phi_0 | \hat{H}&#39; | \Phi_i^a
\rangle = 0\)</span></li>
<li>这再次强调了上一张白板的结论：微扰算符 <span
class="math inline">\(\hat{H}&#39;\)</span> 在基态 <span
class="math inline">\(\Phi_0\)</span>
和任何<strong>单激发</strong>行列式 <span
class="math inline">\(\Phi_i^a\)</span> 之间的矩阵元为零。</li>
<li><span class="math inline">\(\langle \Phi_0 | \hat{H} - \hat{F} |
\Phi_i^a \rangle = 0\)</span> (这是 <span
class="math inline">\(\hat{H}&#39;\)</span> 的展开)</li>
<li><span class="math inline">\(\langle \Phi_a | \hat{f} | \Phi_i
\rangle = 0\)</span> (注：<span class="math inline">\(\Phi_i\)</span> 和
<span class="math inline">\(\Phi_a\)</span> 应为轨道 <span
class="math inline">\(\phi_i\)</span> 和 <span
class="math inline">\(\phi_a\)</span>)</li>
<li>这一行解释了为什么 Brillouin 定理在 MP 理论中成立：因为在标准的
Hartree-Fock (HF) 方法中，占据轨道 (<span
class="math inline">\(\phi_i\)</span>) 和空轨道 (<span
class="math inline">\(\phi_a\)</span>) 之间的 Fock 矩阵元（即 <span
class="math inline">\(\langle \phi_a | \hat{f} | \phi_i
\rangle\)</span>）被设为零。</li>
</ul></li>
<li><strong>MP2 最终实用公式:</strong>
<ul>
<li><span class="math inline">\(E_{MP2} = \sum_{i&lt;j}^{occ}
\sum_{a&lt;b}^{vir} \frac{|\langle \Phi_0 | \hat{H}&#39; |
\Phi_{ij}^{ab} \rangle|^2}{E_{MP0} - E_{ij}^{ab}}\)</span></li>
<li>由于单激发项为零，求和 <span class="math inline">\(k \neq 0\)</span>
中幸存下来的第一类项就是<strong>双激发</strong>项 <span
class="math inline">\(\Phi_{ij}^{ab}\)</span>（电子从 <span
class="math inline">\(i,j\)</span> 轨道激发到 <span
class="math inline">\(a,b\)</span> 轨道）。</li>
<li><span class="math inline">\(E_{ij}^{ab}\)</span>
是双激发组态的零阶能量。</li>
</ul></li>
<li><strong>MP2 能量的性质:</strong>
<ul>
<li><strong><span class="math inline">\(&lt; 0\)</span></strong>: MP2
修正能量<strong>总是负值</strong>。这意味着 MP2 能量总是在 HF
能量（<span class="math inline">\(E_{MP0} +
E_{MP1}\)</span>）的基础上进一步降低总能量。这是符合物理直觉的，因为电子相关效应允许电子更好地相互“躲避”，从而降低体系的总能量。</li>
<li><strong>“80%” (大约)</strong>:
这是一个常见的经验之谈，即对于许多小分子，MP2 方法大约能“恢复”80% 到 90%
的电子相关能。</li>
</ul></li>
</ol>
<h2 id="耦合簇理论-coupled-cluster-theory">3. 耦合簇理论 (Coupled
Cluster Theory)</h2>
<p>这部分介绍了一种更强大、更准确（也更昂贵）的后-HF方法。</p>
<ol type="1">
<li><p><strong>标题:</strong>
<code>Coupled Cluster Theory</code></p></li>
<li><p><strong>CC 波函数拟设 (Ansatz):</strong></p>
<ul>
<li><span class="math inline">\(\Psi_{CC} = e^{\hat{T}}
\Phi_{HF}\)</span> (这里 <span class="math inline">\(\Phi_{HF}\)</span>
即 <span class="math inline">\(\Phi_0\)</span>)</li>
<li>这是 CC 理论的核心！它假设真实的波函数 <span
class="math inline">\(\Psi_{CC}\)</span> 可以通过一个“指数算符” <span
class="math inline">\(e^{\hat{T}}\)</span> 作用在 HF 参考波函数 <span
class="math inline">\(\Phi_0\)</span> 上得到。</li>
</ul></li>
<li><p><strong>指数算符 <span
class="math inline">\(e^{\hat{T}}\)</span>:</strong></p>
<ul>
<li><span class="math inline">\(e^{\hat{T}} = \hat{1} + \hat{T} +
\frac{1}{2!} \hat{T}^2 + \frac{1}{3!} \hat{T}^3 + \dots\)</span></li>
<li>指数算符通过泰勒级数展开。这种指数形式具有非常重要的特性，即它能自动包含“非关联”的高阶激发（例如，两次独立的双激发
<span class="math inline">\(\hat{T}_2^2\)</span> 会产生四激发），这使得
CC 方法具有<strong>大小一致性 (size-consistency)</strong>，这是 MP
理论（在某些阶数上）所缺乏的重要特性。</li>
</ul></li>
<li><p><strong>簇算符 (Cluster Operator) <span
class="math inline">\(\hat{T}\)</span>:</strong></p>
<ul>
<li><span class="math inline">\(\hat{T} = \hat{T}_1 + \hat{T}_2 +
\hat{T}_3 + \dots\)</span></li>
<li>簇算符 <span class="math inline">\(\hat{T}\)</span>
本身是所有可能的激发算符的总和。</li>
</ul></li>
<li><p><strong>激发算符的定义:</strong></p>
<ul>
<li><strong><span class="math inline">\(\hat{T}_1\)</span>
(单激发):</strong>
<ul>
<li><span class="math inline">\(\hat{T}_1 \Phi_0 = \sum_{i}^{occ}
\sum_{a}^{vir} t_i^a \Phi_i^a\)</span></li>
<li><span class="math inline">\(\hat{T}_1\)</span>
产生所有可能的单激发态的线性组合。<span
class="math inline">\(t_i^a\)</span> 是未知的“振幅
(amplitudes)”，即激发的重要性权重，需要通过求解 CC 方程得到。</li>
</ul></li>
<li><strong><span class="math inline">\(\hat{T}_2\)</span>
(双激发):</strong>
<ul>
<li><span class="math inline">\(\hat{T}_2 \Phi_0 = \sum_{i&lt;j}^{occ}
\sum_{a&lt;b}^{vir} t_{ij}^{ab} \Phi_{ij}^{ab}\)</span></li>
<li><span class="math inline">\(\hat{T}_2\)</span>
产生所有可能的双激发态的线性组合。<span
class="math inline">\(t_{ij}^{ab}\)</span> 是双激发的振幅。</li>
</ul></li>
</ul></li>
</ol>
<p><strong>总结：</strong> 这张白板从 MP2
理论（一种基于微扰的方法）过渡到了耦合簇理论（一种基于指数拟设的非微扰方法）。</p>
<ul>
<li><strong>MP2</strong>
通过二阶微扰，只显式地考虑了<strong>双激发</strong>对能量的贡献。</li>
<li><strong>Coupled Cluster</strong> (例如 CCSD，即 <span
class="math inline">\(\hat{T} = \hat{T}_1 + \hat{T}_2\)</span>)
则系统地包含了 <span class="math inline">\(\hat{T}_1\)</span> (单激发)
和 <span class="math inline">\(\hat{T}_2\)</span> (双激发)
及其所有乘积（如 <span class="math inline">\(\hat{T}_1^2, \hat{T}_1
\hat{T}_2, \hat{T}_2^2\)</span>
等），因此它隐式地包含了某些更高阶的激发（如四激发），使其成为比 MP2
更准确、更鲁棒的方法。</li>
</ul>
<p>当然可以。这是一个非常核心的量子化学概念。</p>
<p>简单来说：<strong>双激发 (Double Excitations)
是描述电子“躲避”彼此这一行为的<em>最主要</em>、<em>最基本</em>的数学方式。</strong></p>
<p>MP2 和 CCSD 都高度关注双激发，因为它们是捕获“电子相关能” (Electron
Correlation Energy) 的关键。</p>
<h3 id="问题的根源hf-理论错过了什么">问题的根源：HF
理论错过了什么？</h3>
<p>在白板的 MP 理论推导中，我们从 <strong>Hartree-Fock (HF)
波函数</strong> (<span class="math inline">\(\Phi_0\)</span>) 开始。</p>
<ul>
<li><strong>HF 的问题：</strong> HF
是一种“平均场”理论。它假设一个电子（例如电子 <span
class="math inline">\(i\)</span>）只感受到所有其他电子（例如电子 <span
class="math inline">\(j\)</span>）的<em>平均</em>电荷分布，而不是它们在某一<em>瞬时</em>的真实位置。</li>
<li><strong>物理现实：</strong>
电子是带负电的粒子，它们会<em>瞬时</em>地相互排斥。如果电子 <span
class="math inline">\(i\)</span> 在分子的 A 点，电子 <span
class="math inline">\(j\)</span> 会倾向于<em>避开</em> A 点，跑到 B
点去。这种为了“躲避”对方而调整自己行为的现象，就叫做 <strong>电子相关
(Electron Correlation)</strong>。</li>
</ul>
<p>HF 理论忽略了这种瞬时躲避，因此 HF
能量总是高于真实的基态能量。我们所说的“电子相关能”，就是这个能量差。</p>
<h3 id="解决方案双激发phi_ijab">解决方案：双激发（<span
class="math inline">\(\Phi_{ij}^{ab}\)</span>）</h3>
<p>我们如何用数学来描述“电子 <span class="math inline">\(i\)</span> 和
<span class="math inline">\(j\)</span> 相互躲避”？</p>
<p>想象一下，在 HF 基态 (<span class="math inline">\(\Phi_0\)</span>)
中，电子 <span class="math inline">\(i\)</span> 和 <span
class="math inline">\(j\)</span> 在它们各自的轨道里。</p>
<ul>
<li>为了描述它们“躲开”彼此，我们需要在波函数中“混入”一个新的组态
(configuration)。</li>
<li>在这个新组态中，电子 <span class="math inline">\(i\)</span> 和 <span
class="math inline">\(j\)</span> <em>同时</em>从它们原来的轨道（占据轨道
<span class="math inline">\(i,
j\)</span>）“跳”到了两个新的、能量更高的空轨道（虚拟轨道 <span
class="math inline">\(a, b\)</span>）。</li>
<li>这个“双重跳跃”的态，就是白板上的 <strong>双激发态 <span
class="math inline">\(\Phi_{ij}^{ab}\)</span></strong>。</li>
</ul>
<p>通过将这个双激发态 <span
class="math inline">\(\Phi_{ij}^{ab}\)</span> 线性叠加到基态 <span
class="math inline">\(\Phi_0\)</span>
中，我们的总波函数就能描述这样一种情形：电子 <span
class="math inline">\(i\)</span> 和 <span
class="math inline">\(j\)</span>
有一定概率<em>不在</em>它们“应该”在的地方，而是跑到了别处——这就是它们相互躲避的数学表达。</p>
<p><strong>为什么单激发 (<span class="math inline">\(\Phi_i^a\)</span>)
不行？</strong> 如白板所示，Brillouin 定理（<span
class="math inline">\(\langle \Phi_0 | \hat{H}&#39; | \Phi_i^a \rangle =
0\)</span>）告诉我们，在 MP 理论框架下，HF
基态和单激发态之间没有直接的相互作用。单激发主要描述的是轨道本身的形状调整（轨道弛豫），而不是电子<em>之间</em>的相关。</p>
<h3 id="mp2-和-ccsd-的联系与区别">MP2 和 CCSD 的联系与区别</h3>
<p>MP2 和 CCSD
都是基于这个核心思想，但实现方式的复杂程度和准确性完全不同。</p>
<h4 id="mp2-møller-plesset-2nd-order">🔹 MP2 (Møller-Plesset 2nd
Order)</h4>
<ul>
<li><strong>它做了什么：</strong> MP2
是一种<strong>微扰</strong>方法。它把双激发当作一种“微小的扰动”。</li>
<li><strong>如何工作：</strong> 它使用二阶微扰公式（白板上的 <span
class="math inline">\(E_{MP2}\)</span>）来计算：<em>“如果我允许体系中的每一对电子
(i, j) 发生一次双激发 (到 a, b)，这会使体系的总能量降低多少？”</em></li>
<li><strong>局限性：</strong>
<ol type="1">
<li>它只计算<em>一次</em>激发的影响。</li>
<li>它只考虑了双激发。</li>
<li>它假设这种扰动很“小”。</li>
</ol></li>
</ul>
<p>MP2
是最简单、计算最便宜的包含电子相关的方法，它抓住了相关能的“大头”（
<code>~80%</code>）。</p>
<h4 id="ccsd-coupled-cluster-singles-and-doubles">🔹 CCSD (Coupled
Cluster Singles and Doubles)</h4>
<ul>
<li><strong>它做了什么：</strong> CCSD
是一种<strong>非微扰</strong>方法。它不认为相关是“小扰动”，而是从根本上重新构建波函数。</li>
<li><strong>如何工作：</strong> 它使用指数拟设 <span
class="math inline">\(\Psi_{CC} = e^{\hat{T}_1 + \hat{T}_2}
\Phi_0\)</span>。
<ul>
<li><span class="math inline">\(\hat{T}_2\)</span>
算符（白板上有写）就是用来产生所有双激发的。</li>
<li><span class="math inline">\(\hat{T}_1\)</span>
算符（白板上有写）用来产生所有单激发（用于轨道弛豫）。</li>
</ul></li>
<li><strong>关键区别（指数的魔力）：</strong>
<ul>
<li>当指数 <span class="math inline">\(e^{\hat{T}}\)</span> 展开时
(<span class="math inline">\(e^{\hat{T}} = 1 + \hat{T} +
\frac{1}{2}\hat{T}^2 + \dots\)</span>)，你会得到像 <span
class="math inline">\(\frac{1}{2}(\hat{T}_2)^2\)</span> 这样的项。</li>
<li><span class="math inline">\(\frac{1}{2}(\hat{T}_2)^2\)</span>
意味着<strong>两次独立的双激发</strong>。这在物理上代表了<strong>四激发</strong>（例如，分子中两对互不相干的电子同时在各自“躲避”）。</li>
<li><strong>这就是 CCSD 远比 MP2 准确的原因</strong>：它不仅包含了 <span
class="math inline">\(\hat{T}_2\)</span>（双激发），还通过指数形式<em>自动包含</em>了由
<span class="math inline">\(\hat{T}_2\)</span>
组合产生的高阶激发（如四激发、六激发等）。它正确地描述了多个电子对同时发生相关行为的情况。</li>
</ul></li>
</ul>
<h3 id="总结对比">总结对比</h3>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr>
<th style="text-align: left;">特性</th>
<th style="text-align: left;">MP2</th>
<th style="text-align: left;">CCSD ( <span class="math inline">\(\hat{T}
= \hat{T}_1 + \hat{T}_2\)</span> )</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>方法类型</strong></td>
<td style="text-align: left;">微扰理论 (Perturbative)</td>
<td style="text-align: left;">非微扰 (Non-perturbative)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>核心思想</strong></td>
<td
style="text-align: left;">计算<strong>双激发</strong>对能量的<em>二阶</em>修正。</td>
<td
style="text-align: left;">用指数算符包含所有<strong>单、双激发</strong>。</td>
</tr>
<tr>
<td style="text-align: left;"><strong>包含的激发</strong></td>
<td style="text-align: left;">仅显式包含<strong>双激发</strong>。</td>
<td style="text-align: left;">显式包含<strong>单、双激发</strong>。<br>
<em>隐式</em>包含高阶激发（四、六等）。</td>
</tr>
<tr>
<td style="text-align: left;"><strong>准确性</strong></td>
<td style="text-align: left;">良好（约 80-90% 相关能）</td>
<td style="text-align: left;">优秀（“黄金标准”之一）</td>
</tr>
<tr>
<td style="text-align: left;"><strong>数学联系</strong></td>
<td style="text-align: left;">MP2 的能量公式可以被证明是 CCSD
方程的<em>最低阶近似</em>。</td>
<td style="text-align: left;">更完整、更高级的理论。</td>
</tr>
</tbody>
</table>
<p><strong>总结：</strong></p>
<p><strong>双激发是描述电子相关（相互躲避）的物理核心。MP2
用最简单的方式估算了它的能量贡献，而 CCSD
则用一种更完备、更强大的数学（指数）形式将其及组合效应系统地包含了进来。</strong></p>
<h2 id="量子蒙特卡洛-quantum-monte-carlo">4. 量子蒙特卡洛 (Quantum Monte
Carlo)</h2>
<h3 id="耦合簇理论-coupled-cluster">耦合簇理论 (Coupled Cluster)</h3>
<h4 id="ccsdtt-的含义">1. CCSD(T)：“(T)” 的含义</h4>
<ul>
<li><strong>回顾 <code>CCSD</code>：</strong> 正如标题
<code>Coupled Cluster Singles and Doubles (CCSD)</code> 所示，CCSD
方法只完整地包含了单激发算符 (<span
class="math inline">\(\hat{T}_1\)</span>) 和双激发算符 (<span
class="math inline">\(\hat{T}_2\)</span>)。它通过指数形式 <span
class="math inline">\(e^{(\hat{T}_1 +
\hat{T}_2)}\)</span>，已经能间接地包含一些高阶激发（如四激发 <span
class="math inline">\(\hat{T}_2^2\)</span>）。</li>
<li><strong>缺失的项：</strong> CCSD <strong>没有</strong> 显式地包含
<strong>“连通”(connected) 三激发算符 <span
class="math inline">\(\hat{T}_3\)</span></strong>。<span
class="math inline">\(\hat{T}_3\)</span>
描述的是三个电子<em>同时</em>相互关联并激发到三个空轨道。</li>
<li><strong><code>(T)</code> 的含义：</strong> <code>(T)</code> 代表
<strong>“微扰三激发” (perturbative Triples)</strong>。
<ul>
<li><strong>为什么不直接用 <code>CCSDT</code>？</strong> 完整地求解包含
<span class="math inline">\(\hat{T}_3\)</span> 的方程（即 CCSDT
方法）在计算上极其昂贵（计算量随体系大小的 <span
class="math inline">\(N^8\)</span> 增长）。</li>
<li><strong><code>(T)</code> 的解决之道：</strong> <code>CCSD(T)</code>
是一种巧妙的折中。它首先执行一个完整的、较便宜的 CCSD 计算（求解 <span
class="math inline">\(\hat{T}_1\)</span> 和 <span
class="math inline">\(\hat{T}_2\)</span>）。然后，它使用这些已知的 <span
class="math inline">\(\hat{T}_1\)</span> 和 <span
class="math inline">\(\hat{T}_2\)</span>
振幅，通过<strong>微扰理论</strong>（就像第一张白板上的 MP
理论一样！）来<em>估算</em> <span
class="math inline">\(\hat{T}_3\)</span>
会对总能量产生的<em>修正</em>。</li>
</ul></li>
<li><strong>“黄金标准” (Gold Standard)：</strong> <code>CCSD(T)</code>
方法被广泛认为是量子化学的“黄金标准”。它以可承受的计算成本（<span
class="math inline">\(N^7\)</span>
增长）提供了接近“完美”的能量，是绝大多数高精度计算的基准。</li>
<li><strong>“95%” 注释：</strong> 白板上的 <code>95%</code>
注释很可能是讲师的一个经验之谈，即 CCSD 大约能恢复 95%
的电子相关能（相比 MP2 的 ~80%），而 <code>(T)</code>
修正则能将这个数字推向 99% 甚至更高。</li>
</ul>
<h4 id="耦合簇方程-cc-equations">2. 耦合簇方程 (CC Equations)</h4>
<p>白板的中间部分展示了如何<em>求解</em> CCSD 方程以获得能量 <span
class="math inline">\(E\)</span> 和振幅 <span
class="math inline">\(t_i^a, t_{ij}^{ab}\)</span>。</p>
<ul>
<li><p><strong>总薛定谔方程：</strong></p>
<ul>
<li><span class="math inline">\(H e^{\hat{T}} | \Phi_0 \rangle = E
e^{\hat{T}} | \Phi_0 \rangle\)</span></li>
<li>这是 CC 理论要解的薛定谔方程 (<span class="math inline">\(\hat{H}
|\Psi_{CC}\rangle = E |\Psi_{CC}\rangle\)</span>)。</li>
</ul></li>
<li><p><strong>求解方法（投影法）：</strong> 为了解出未知的 <span
class="math inline">\(E\)</span>, <span
class="math inline">\(\hat{T}_1\)</span>, <span
class="math inline">\(\hat{T}_2\)</span>，我们将这个总方程“投影”到不同的激发空间上：</p>
<ol type="1">
<li><strong>能量 <span class="math inline">\(E\)</span>：</strong>
<ul>
<li><span class="math inline">\(\langle \Phi_0 |
e^{-(\hat{T}_1+\hat{T}_2)} \hat{H} e^{(\hat{T}_1+\hat{T}_2)} | \Phi_0
\rangle = E\)</span></li>
<li>将总方程左乘 <span class="math inline">\(\langle \Phi_0
|\)</span>（HF 基态）并积分，可以直接得到总能量 <span
class="math inline">\(E\)</span>。</li>
</ul></li>
<li><strong>求解 <span class="math inline">\(\hat{T}_1\)</span>（方程
①）：</strong>
<ul>
<li><span class="math inline">\(\langle \Phi_i^a |
e^{-(\hat{T}_1+\hat{T}_2)} \hat{H} e^{(\hat{T}_1+\hat{T}_2)} | \Phi_0
\rangle = 0\)</span></li>
<li>将总方程左乘 <span class="math inline">\(\langle \Phi_i^a
|\)</span>（所有<strong>单激发</strong>态）。这会产生一系列方程，求解它们可以得到所有
<span class="math inline">\(\hat{T}_1\)</span> 的振幅 <span
class="math inline">\(t_i^a\)</span>。</li>
</ul></li>
<li><strong>求解 <span class="math inline">\(\hat{T}_2\)</span>（方程
②）：</strong>
<ul>
<li><span class="math inline">\(\langle \Phi_{ij}^{ab} |
e^{-(\hat{T}_1+\hat{T}_2)} \hat{H} e^{(\hat{T}_1+\hat{T}_2)} | \Phi_0
\rangle = 0\)</span></li>
<li>将总方程左乘 <span class="math inline">\(\langle \Phi_{ij}^{ab}
|\)</span>（所有<strong>双激发</strong>态）。这会产生另一系列方程，求解它们可以得到所有
<span class="math inline">\(\hat{T}_2\)</span> 的振幅 <span
class="math inline">\(t_{ij}^{ab}\)</span>。</li>
</ul></li>
</ol></li>
</ul>
<p><strong>总结：</strong> CCSD
是一个复杂的非线性方程组。我们通过求解方程 ① 和 ②
得到所有激发振幅，然后将这些振幅代入能量方程，得到最终的 CCSD 能量。</p>
<h3 id="量子蒙特卡洛-quantum-monte-carlo-qmc">量子蒙特卡洛 (Quantum
Monte Carlo, QMC)</h3>
<p>这部分介绍了一种<strong>完全不同</strong>的、不依赖于轨道和激发的方法。</p>
<ul>
<li><strong>标题：</strong> <code>Quantum Monte Carlo</code></li>
<li><strong>子标题：</strong> <code>Variational / Diffusion MC</code>
(变分蒙特卡洛 / 扩散蒙特卡洛)</li>
</ul>
<h4 id="变分蒙特卡洛-vmc">变分蒙特卡洛 (VMC)</h4>
<p>VMC 的核心思想，基于<strong>变分原理</strong>：</p>
<ol type="1">
<li><strong>能量期望值：</strong>
<ul>
<li><span class="math inline">\(E(\theta) = \frac{\langle \Psi(\theta) |
\hat{H} | \Psi(\theta) \rangle}{\langle \Psi(\theta) | \Psi(\theta)
\rangle}\)</span></li>
<li>任何一个“试验波函数” <span
class="math inline">\(\Psi(\theta)\)</span>（<span
class="math inline">\(\theta\)</span> 是函数中的可调参数）所计算出的能量
<span class="math inline">\(E(\theta)\)</span>
永远<strong>大于或等于</strong>真实的基态能量 <span
class="math inline">\(E_{\text{ground}}\)</span>。</li>
<li><strong>目标：</strong>
<code>min $E(\theta)$ = $E_&#123;\text&#123;ground&#125;&#125;$</code> (更准确地说是 <span
class="math inline">\(E_{\text{approx}}\)</span>)</li>
<li>通过调整参数 <span class="math inline">\(\theta\)</span> 来最小化
<span
class="math inline">\(E(\theta)\)</span>，我们可以获得对基态能量的最佳近似。</li>
</ul></li>
<li><strong>蒙特卡洛方法如何计算？</strong>
<ul>
<li>上述能量公式是一个极其复杂的高维积分（积分维度 = 3 <span
class="math inline">\(\times\)</span> 电子数）。</li>
<li>QMC
它<strong>不直接计算这个积分</strong>，而是使用<strong>随机抽样</strong>（“蒙特卡洛”方法）来估算它。</li>
</ul></li>
<li><strong>VMC 计算步骤（如白板所示）：</strong>
<ul>
<li><strong>a. 重写积分：</strong> <span class="math inline">\(E =
\frac{\int |\Psi(\vec{x}, \theta)|^2 \left[ \frac{\hat{H} \Psi(\vec{x},
\theta)}{\Psi(\vec{x}, \theta)} \right] d\vec{x}}{\int |\Psi(\vec{x},
\theta)|^2 d\vec{x}}\)</span>
<ul>
<li><span class="math inline">\(\vec{x}\)</span> 代表所有电子的坐标
(<span class="math inline">\(r_1, r_2, \dots\)</span>)。</li>
<li><span class="math inline">\(\frac{|\Psi(\vec{x})|^2}{\int
|\Psi(\vec{x})|^2 d\vec{x}}\)</span> 是电子在 <span
class="math inline">\(\vec{x}\)</span>
处被发现的<strong>概率密度</strong> <span
class="math inline">\(P(\vec{x})\)</span>。</li>
<li><span class="math inline">\(E_L(\vec{x}) = \frac{\hat{H}
\Psi(\vec{x}, \theta)}{\Psi(\vec{x}, \theta)}\)</span> 被称为
<strong>“局域能量” (Local Energy)</strong>。</li>
</ul></li>
<li><strong>b. 抽样：</strong>
<ul>
<li>整个积分就变成了在 <span class="math inline">\(P(\vec{x})\)</span>
概率分布下，对 <span class="math inline">\(E_L(\vec{x})\)</span>
求平均值。</li>
<li>VMC 方法通过一种算法（如 Metropolis 算法）产生大量的、符合 <span
class="math inline">\(|\Psi|^2\)</span>
分布的随机电子构型（“walkers”）。</li>
</ul></li>
<li><strong>c. 求平均：</strong>
<ul>
<li><span class="math inline">\(E \approx \frac{1}{N}
\sum_{\text{samples } \vec{x}} E_L(\vec{x})\)</span></li>
<li>最终的能量就是所有采样点上“局域能量”的简单平均值。</li>
</ul></li>
</ul></li>
</ol>
<p><strong>总结：</strong> VMC
通过在“真实空间”中随机移动电子来直接估算能量，完全绕过了 MP 或 CC
理论中复杂的轨道和激发概念。<code>Diffusion MC</code> (DMC)
是其更高级的变体，原则上可以找到精确的基态能量。</p>
<p>这张白板标志着一个<strong>重大的理论转变</strong>：从前面讨论的“波函数方法”（Wavefunction
Methods, 如 MP2,
CCSD）转向了一种完全不同的、在计算化学和物理中占主导地位的方法——<strong>密度泛函理论
(Density Functional Theory, DFT)</strong>。</p>
<h2 id="波函数方法的维度灾难">5. 波函数方法的“维度灾难”</h2>
<p>一个生动的例子，说明了为什么基于波函数的方法（如
CCSD）在计算上极其昂贵，甚至是不可能的。</p>
<ol type="1">
<li><strong>“wavefunction method” (波函数方法):</strong>
<ul>
<li>这类方法（如 HF, MP2, CCSD）的中心目标是求解体系的 <span
class="math inline">\(N\)</span> 电子波函数 <span
class="math inline">\(\Psi(\vec{r}_1, \vec{r}_2, \dots,
\vec{r}_N)\)</span>。</li>
<li>这个波函数 <span class="math inline">\(\Psi\)</span>
是一个极其复杂的对象，它是一个 <span class="math inline">\(3N\)</span>
维度的函数（每个电子有 3 个空间坐标 <span class="math inline">\(x, y,
z\)</span>）。</li>
</ul></li>
<li><strong>计算成本的“立方体”比喻：</strong>
<ul>
<li>假设我们想在一个 3D 空间中存储<em>一个</em>电子的波函数。</li>
<li>如果我们在每个维度（x, y, z）上只使用 <strong>10</strong>
个网格点，我们就需要 <span class="math inline">\(10 \times 10 \times 10
= 10^3\)</span> 个点来描述这<em>一个</em>电子。</li>
<li>现在，考虑一个有 <strong>30</strong>
个电子的体系（一个中等大小的分子）。</li>
<li>由于总波函数 <span class="math inline">\(\Psi\)</span> 是 <span
class="math inline">\(3 \times 30 = 90\)</span> 维的，我们需要 <span
class="math inline">\((10^3)^{30} = 10^{90}\)</span>
个网格点来存储这个波函数。</li>
<li><strong><span class="math inline">\(10^{90}\)</span>
是一个天文数字！</strong> 白板上的 <span
class="math inline">\(10^{77}\)</span> 或 <span
class="math inline">\(10^{80}\)</span>
可能是用来比较的数字（例如，可观测宇宙中的原子总数约 <span
class="math inline">\(10^{80}\)</span>）。这个数字 (<span
class="math inline">\(10^{90}\)</span>) 意味着直接存储或计算 N
电子波函数在计算上是<strong>绝对不可能</strong>的。</li>
<li>这就是所谓的“<strong>维度灾难 (Curse of
Dimensionality)</strong>”。</li>
</ul></li>
<li><strong>DFT：解决方案登场</strong>
<ul>
<li>在指出了波函数方法的根本困难后，白板上写下了
<strong>DFT</strong>，预示着它是一种解决方案。</li>
</ul></li>
<li><strong>体系的哈密顿算符 (<span
class="math inline">\(\hat{H}\)</span>):</strong>
<ul>
<li><span class="math inline">\(\hat{H} = \underbrace{-\sum_i
\frac{\hbar^2}{2m} \nabla_i^2}_{\text{电子动能}} + \underbrace{\sum_i
V_{\text{ext}}(\vec{r}_i)}_{\text{电子-原子核吸引}} +
\underbrace{\frac{1}{2} \sum_{i \neq j} \frac{e^2}{|\vec{r}_i -
\vec{r}_j|}}_{\text{电子-电子排斥}}\)</span></li>
<li>这是任何分子体系的完整（非相对论）哈密顿算符。</li>
</ul></li>
<li><strong>关键的简化：</strong>
<ul>
<li><span class="math inline">\(\langle \Psi | \sum_i
V_{\text{ext}}(\vec{r}_i) | \Psi \rangle = \int V_{\text{ext}}(\vec{r})
\rho(\vec{r}) d\vec{r}\)</span></li>
<li>这一行展示了一个至关重要的简化：<span
class="math inline">\(N\)</span> 电子的“电子-原子核吸引能”的期望值（一个
<span class="math inline">\(3N\)</span>
维积分），可以被<em>精确地</em>重写为一个只涉及<strong>电子密度 <span
class="math inline">\(\rho(\vec{r})\)</span></strong> 的** 3
维积分**。</li>
<li>这就引出了一个问题：我们是否能用这个简单的 <span
class="math inline">\(\rho(\vec{r})\)</span> 来代替 <span
class="math inline">\(\Psi\)</span> 呢？</li>
</ul></li>
</ol>
<h3 id="dft-的理论基石">DFT 的理论基石</h3>
<p>这部分介绍了 DFT 的核心定理</p>
<ol type="1">
<li><strong>电子密度 (Electron Density, <span
class="math inline">\(\rho(\vec{r})\)</span>):</strong>
<ul>
<li><span class="math inline">\(\int \rho(\vec{r}) d\vec{r} =
N\)</span></li>
<li>电子密度 <span class="math inline">\(\rho(\vec{r})\)</span>
是一个<strong>在 3D 空间中的函数</strong>。它描述了在任意空间点 <span
class="math inline">\(\vec{r}\)</span> 处找到一个电子的概率。</li>
<li>无论体系有多少电子（<span class="math inline">\(N=30\)</span> 或
<span class="math inline">\(N=1000\)</span>），<span
class="math inline">\(\rho(\vec{r})\)</span>
<strong>始终</strong>是一个简单的 3 维函数。这与 <span
class="math inline">\(3N\)</span> 维的波函数 <span
class="math inline">\(\Psi\)</span> 形成了鲜明对比。</li>
</ul></li>
<li><strong>Hohenberg-Kohn (H-K) 定理：</strong>
<ul>
<li>这是 DFT 的全部理论基础。白板上的图示完美地总结了第一个 H-K
定理：</li>
<li><strong>标准路径（上 <span
class="math inline">\(\rightarrow\)</span> 下）：</strong> <span
class="math inline">\(V_{\text{ext}}(\vec{r})\)</span>（外势，即原子核的位置和电荷）<span
class="math inline">\(\implies \Psi(\vec{r})\)</span>（基态波函数）<span
class="math inline">\(\implies \rho(\vec{r})\)</span>（基态密度）。
<ul>
<li><em>解释：</em> 原子核的位置决定了 <span
class="math inline">\(\hat{H}\)</span>，求解 <span
class="math inline">\(\hat{H}\)</span> 得到 <span
class="math inline">\(\Psi\)</span>，由 <span
class="math inline">\(\Psi\)</span> 可以计算出 <span
class="math inline">\(\rho\)</span>。</li>
</ul></li>
<li><strong>H-K 革命性路径（下 <span
class="math inline">\(\leftrightarrow\)</span> 上）：</strong> <span
class="math inline">\(V_{\text{ext}}(\vec{r}) \Longleftrightarrow
\rho(\vec{r})\)</span>
<ul>
<li><strong>第一 H-K 定理</strong>证明：体系的<strong>基态电子密度 <span
class="math inline">\(\rho(\vec{r})\)</span></strong>
<em>唯一地</em>决定了<strong>外势 <span
class="math inline">\(V_{\text{ext}}(\vec{r})\)</span></strong>（因此也唯一决定了
<span class="math inline">\(\hat{H}\)</span>、<span
class="math inline">\(\Psi\)</span> 和总能量 <span
class="math inline">\(E\)</span>）。</li>
</ul></li>
</ul></li>
<li><strong>H-K 定理的重大意义：</strong>
<ul>
<li><strong>所有信息都在 <span
class="math inline">\(\rho(\vec{r})\)</span> 中！</strong>
体系的基态总能量 <span class="math inline">\(E\)</span> 是基态密度 <span
class="math inline">\(\rho\)</span> 的一个<strong>泛函
(Functional)</strong>，记为 <span
class="math inline">\(E[\rho]\)</span>。</li>
<li><strong>目标转变：</strong> 我们不再需要去求解那个 <span
class="math inline">\(10^{90}\)</span> 维的波函数 <span
class="math inline">\(\Psi\)</span>！我们只需要找到那个能使总能量 <span
class="math inline">\(E[\rho]\)</span> 最小的 3 维密度 <span
class="math inline">\(\rho(\vec{r})\)</span>。</li>
</ul></li>
</ol>
<p><strong>总结：</strong>
首先论证了“波函数方法”在计算上的不可能性（维度灾难），然后引入了
<strong>DFT</strong> 作为解决方案，其理论依据是 <strong>H-K
定理</strong>——即体系的所有信息都包含在简单的 3 维电子密度 <span
class="math inline">\(\rho(\vec{r})\)</span> 中。</p>
<h2
id="证明-第一-hohenberg-kohn-h-k-定理的经典证明这个定理是密度泛函理论-dft-的基石">6：证明
<strong>第一 Hohenberg-Kohn (H-K)
定理的经典证明</strong>。这个定理是密度泛函理论 (DFT) 的基石。</h2>
<p>这个证明使用的是 <strong>“Proof by contradiction”
(反证法)</strong>。</p>
<p><strong>定理内容：</strong> 体系的基态电子密度 <span
class="math inline">\(\rho_0(\vec{r})\)</span> 唯一地决定了其外势 <span
class="math inline">\(V_{ext}(\vec{r})\)</span>（即原子核的位置和电荷），并因此唯一地决定了体系的哈密顿算符
<span class="math inline">\(\hat{H}\)</span> 和波函数 <span
class="math inline">\(\Psi\)</span>。</p>
<h3 id="证明步骤详解">证明步骤详解</h3>
<h4 id="假设-为反证法设置">1. 假设 (为反证法设置)</h4>
<p>我们假设 H-K 定理是<strong>错</strong>的。</p>
<p>这意味着我们假设存在<strong>两个不同 (different)</strong> 的外势
<span class="math inline">\(V_{ext}^{(1)}\)</span> 和 <span
class="math inline">\(V_{ext}^{(2)}\)</span>，它们分别对应各自的哈密顿算符
<span class="math inline">\(\hat{H}^{(1)}\)</span>、<span
class="math inline">\(\hat{H}^{(2)}\)</span> 和基态波函数 <span
class="math inline">\(\Psi^{(1)}\)</span>、<span
class="math inline">\(\Psi^{(2)}\)</span>。</p>
<p>但我们<strong>假设</strong>，这两个完全不同的体系却碰巧产生了<strong>完全相同
(same)</strong> 的基态电子密度 <span
class="math inline">\(\rho_0(\vec{r})\)</span>。</p>
<blockquote>
<p><strong>假设总结：</strong> * <span
class="math inline">\(V_{ext}^{(1)} \neq V_{ext}^{(2)}\)</span> （因此
<span class="math inline">\(\hat{H}^{(1)} \neq \hat{H}^{(2)}\)</span> 且
<span class="math inline">\(\Psi^{(1)} \neq \Psi^{(2)}\)</span>） * 但是
<span class="math inline">\(\rho^{(1)}(\vec{r}) = \rho^{(2)}(\vec{r}) =
\rho_0(\vec{r})\)</span> * <span class="math inline">\(E^{(1)}\)</span>
是体系1的基态能量。 * <span class="math inline">\(E^{(2)}\)</span>
是体系2的基态能量。</p>
</blockquote>
<h4 id="应用变分原理-第-1-步">2. 应用变分原理 (第 1 步)</h4>
<p>变分原理指出：任何一个“试验波函数” <span
class="math inline">\(\Psi_{\text{trial}}\)</span> 对某个哈密顿算符
<span class="math inline">\(\hat{H}\)</span>
的能量期望值，永远高于或等于该 <span
class="math inline">\(\hat{H}\)</span> 的真实基态能量 <span
class="math inline">\(E_{GS}\)</span>。</p>
<ul>
<li>我们将 <span class="math inline">\(\Psi^{(2)}\)</span>
(体系2的基态波函数) 作为体系1的<strong>试验波函数</strong>。</li>
<li>根据变分原理，<span class="math inline">\(\Psi^{(2)}\)</span>
计算出的 <span class="math inline">\(\hat{H}^{(1)}\)</span>
的能量必定高于 <span class="math inline">\(\hat{H}^{(1)}\)</span>
的真实基态能量 <span
class="math inline">\(E^{(1)}\)</span>（因为我们假设了 <span
class="math inline">\(\Psi^{(1)} \neq \Psi^{(2)}\)</span>）。</li>
<li><strong><span class="math inline">\(E^{(1)} &lt; \langle \Psi^{(2)}
| \hat{H}^{(1)} | \Psi^{(2)} \rangle\)</span></strong>
(白板上的第3行)</li>
</ul>
<h4 id="展开能量-第-2-步">3. 展开能量 (第 2 步)</h4>
<p>我们来展开 <span class="math inline">\(\langle \Psi^{(2)} |
\hat{H}^{(1)} | \Psi^{(2)} \rangle\)</span> 这一项。</p>
<ul>
<li><p>我们知道 <span class="math inline">\(\hat{H}^{(1)} =
\hat{H}^{(2)} + (V_{ext}^{(1)} - V_{ext}^{(2)})\)</span>。</p></li>
<li><p>代入上式： <span class="math inline">\(\langle \Psi^{(2)} |
\hat{H}^{(1)} | \Psi^{(2)} \rangle = \langle \Psi^{(2)} | \hat{H}^{(2)}
+ V_{ext}^{(1)} - V_{ext}^{(2)} | \Psi^{(2)} \rangle\)</span></p></li>
<li><p>拆分它： <span class="math inline">\(= \langle \Psi^{(2)} |
\hat{H}^{(2)} | \Psi^{(2)} \rangle + \langle \Psi^{(2)} | V_{ext}^{(1)}
- V_{ext}^{(2)} | \Psi^{(2)} \rangle\)</span></p></li>
<li><p>第一项 <span class="math inline">\(\langle \Psi^{(2)} |
\hat{H}^{(2)} | \Psi^{(2)} \rangle\)</span> 正是体系2的基态能量 <span
class="math inline">\(E^{(2)}\)</span>。</p></li>
<li><p>第二项（如上一张白板所示）可以写成关于密度的积分： <span
class="math inline">\(\int (V_{ext}^{(1)} - V_{ext}^{(2)})
\rho^{(2)}(\vec{r}) d\vec{r}\)</span></p></li>
<li><p>根据我们的初始假设，<span
class="math inline">\(\rho^{(2)}(\vec{r}) =
\rho_0(\vec{r})\)</span>。</p></li>
<li><p>将这些组合起来，第1步的变分不等式 <span
class="math inline">\(E^{(1)} &lt; \dots\)</span> 就变成了：
<strong><span class="math inline">\(E^{(1)} &lt; E^{(2)} + \int
(V_{ext}^{(1)} - V_{ext}^{(2)}) \rho_0(\vec{r})
d\vec{r}\)</span></strong> (白板上的第5行)</p></li>
</ul>
<h4 id="对称地应用变分原理-第-3-步">4. 对称地应用变分原理 (第 3 步)</h4>
<p>现在我们反过来，将 <span class="math inline">\(\Psi^{(1)}\)</span>
作为体系2的<strong>试验波函数</strong>。</p>
<ul>
<li><p>根据变分原理： <strong><span class="math inline">\(E^{(2)} &lt;
\langle \Psi^{(1)} | \hat{H}^{(2)} | \Psi^{(1)}
\rangle\)</span></strong></p></li>
<li><p>我们用同样的方法展开 <span class="math inline">\(\hat{H}^{(2)} =
\hat{H}^{(1)} + (V_{ext}^{(2)} - V_{ext}^{(1)})\)</span>： <span
class="math inline">\(\langle \Psi^{(1)} | \hat{H}^{(2)} | \Psi^{(1)}
\rangle = \langle \Psi^{(1)} | \hat{H}^{(1)} | \Psi^{(1)} \rangle +
\langle \Psi^{(1)} | V_{ext}^{(2)} - V_{ext}^{(1)} | \Psi^{(1)}
\rangle\)</span></p></li>
<li><p>这等于： <span class="math inline">\(= E^{(1)} + \int
(V_{ext}^{(2)} - V_{ext}^{(1)}) \rho^{(1)}(\vec{r})
d\vec{r}\)</span></p></li>
<li><p>再次使用我们的假设 <span
class="math inline">\(\rho^{(1)}(\vec{r}) =
\rho_0(\vec{r})\)</span>。</p></li>
<li><p>因此，我们得到了第二个不等式： <strong><span
class="math inline">\(E^{(2)} &lt; E^{(1)} + \int (V_{ext}^{(2)} -
V_{ext}^{(1)}) \rho_0(\vec{r}) d\vec{r}\)</span></strong>
(白板上的第6行)</p></li>
</ul>
<h4 id="导出矛盾-第-4-步">5. 导出矛盾 (第 4 步)</h4>
<p>现在我们把两个不等式（第5行和第6行）相加：</p>
<p><span class="math inline">\(E^{(1)} + E^{(2)} &lt; \left[ E^{(2)} +
\int (V_{ext}^{(1)} - V_{ext}^{(2)}) \rho_0 d\vec{r} \right] + \left[
E^{(1)} + \int (V_{ext}^{(2)} - V_{ext}^{(1)}) \rho_0 d\vec{r}
\right]\)</span></p>
<p>我们来合并右侧的项：</p>
<p><span class="math inline">\(E^{(1)} + E^{(2)} &lt; (E^{(1)} +
E^{(2)}) + \int \underbrace{[(V_{ext}^{(1)} - V_{ext}^{(2)}) +
(V_{ext}^{(2)} - V_{ext}^{(1)})]}_{= 0} \rho_0 d\vec{r}\)</span></p>
<p>右侧的两个积分项<strong>完全抵消</strong>，变成了 0。</p>
<ul>
<li>于是我们得到了最终的荒谬结论： <strong><span
class="math inline">\(E^{(1)} + E^{(2)} &lt; E^{(1)} +
E^{(2)}\)</span></strong> (白板上的最后一行)</li>
</ul>
<h4 id="结论">6. 结论</h4>
<p>“一个数严格小于它自己” (<span class="math inline">\(A &lt;
A\)</span>) 是一个数学上<strong>不可能</strong>的悖论。</p>
<p>这个悖论证明了我们的<strong>初始假设一定是错误的</strong>。</p>
<p>因此，两个不同的外势 <span
class="math inline">\(V_{ext}^{(1)}\)</span> 和 <span
class="math inline">\(V_{ext}^{(2)}\)</span> <strong>不可能</strong>
产生相同的基态密度 <span class="math inline">\(\rho_0\)</span>。</p>
<p><strong>证明完毕：</strong> 体系的基态电子密度 <span
class="math inline">\(\rho_0(\vec{r})\)</span>
<strong>唯一地</strong>决定了其外势 <span
class="math inline">\(V_{ext}(\vec{r})\)</span>，并因此决定了体系的所有基态性质。</p>
<h2 id="更多">7. 更多</h2>
<p>Hohenberg-Kohn (H-K) 定理证明了 <span
class="math inline">\(E[\rho]\)</span>（能量是密度的泛函）的<em>存在性</em>，但它没有告诉我们这个泛函到底长什么样。</p>
<p><strong>问题在于：</strong> 我们不知道电子动能 <span
class="math inline">\(T[\rho]\)</span> 和电子-电子排斥能 <span
class="math inline">\(V_{ee}[\rho]\)</span> 的精确泛函形式。</p>
<p><strong>Kohn-Sham (KS) 理论</strong>
就是为了解决这个问题而提出的。</p>
<p>这个理论的核心思想是：<strong>“我们假装在解一个简单问题，然后把所有的复杂性都藏在一个我们去近似的项里。”</strong></p>
<p>以下是这个实践过程的分解：</p>
<h3 id="引入一个虚拟的无相互作用体系">1.
引入一个“虚拟”的无相互作用体系</h3>
<p>Kohn 和 Sham
假设存在一个<em>虚拟的</em>、<strong>无相互作用</strong>（non-interacting）的电子体系。</p>
<p>这个虚拟体系有一个关键的约束：它被设计为与<em>真实的</em>、有相互作用的体系具有<strong>完全相同的基态电子密度
<span class="math inline">\(\rho(\vec{r})\)</span></strong>。</p>
<p><strong>这为什么有帮助？</strong>
因为对于一个<strong>无相互作用</strong>的体系，我们<strong>精确地知道</strong>它的动能泛函
<span class="math inline">\(T_s[\rho]\)</span>！它就是所有单电子轨道
<span class="math inline">\(\phi_i\)</span> 的动能之和。（<span
class="math inline">\(s\)</span> 代表 “single-particle” 或
“non-interacting”）。</p>
<h3 id="重写总能量泛函-erho">2. 重写总能量泛函 <span
class="math inline">\(E[\rho]\)</span></h3>
<p>现在，Kohn-Sham 将<em>真实</em>体系的总能量 <span
class="math inline">\(E[\rho]\)</span> 重新组织为以下四项：</p>
<p><span class="math inline">\(E[\rho] = T_s[\rho] + \int
V_{ext}(\vec{r}) \rho(\vec{r}) d\vec{r} + E_H[\rho] +
E_{xc}[\rho]\)</span></p>
<p>我们来逐项分析：</p>
<ol type="1">
<li><strong><span
class="math inline">\(T_s[\rho]\)</span>：无相互作用动能</strong>
<ul>
<li>这是我们刚刚引入的<em>虚拟</em>体系的动能。我们<strong>可以精确计算</strong>它（通过求解轨道
<span class="math inline">\(\phi_i\)</span>）。</li>
<li><em>（注：这</em>不是<em>真实体系的动能 <span
class="math inline">\(T[\rho]\)</span>，但它通常是 <span
class="math inline">\(T[\rho]\)</span> 的一个很好的近似。）</em></li>
</ul></li>
<li><strong><span class="math inline">\(\int V_{ext}(\vec{r})
\rho(\vec{r}) d\vec{r}\)</span>：外势能</strong>
<ul>
<li>这是电子-原子核的吸引能。这个泛函是<strong>精确已知</strong>的（就像上一张白板展示的）。</li>
</ul></li>
<li><strong><span class="math inline">\(E_H[\rho]\)</span>：哈特里
(Hartree) 能量</strong>
<ul>
<li><span class="math inline">\(E_H[\rho] = \frac{1}{2} \iint
\frac{\rho(\vec{r})\rho(\vec{r}&#39;)}{|\vec{r}-\vec{r}&#39;|}
d\vec{r}d\vec{r}&#39;\)</span></li>
<li>这是电子密度与其自身相互作用的经典库仑排斥能。这个泛函也是<strong>精确已知</strong>的。</li>
</ul></li>
<li><strong><span class="math inline">\(E_{xc}[\rho]\)</span>：交换-相关
(Exchange-Correlation) 泛函</strong>
<ul>
<li><strong>这是 DFT 实践的核心！</strong></li>
<li><span class="math inline">\(E_{xc}[\rho]\)</span>
被定义为一个“垃圾桶”，它包含了所有我们不知道的、以及我们故意用近似替换掉的<em>所有</em>复杂物理：
<ul>
<li>(<span class="math inline">\(T[\rho] -
T_s[\rho]\)</span>)：真实动能与无相互作用动能之间的差值（即动能的相关部分）。</li>
<li>(<span class="math inline">\(V_{ee}[\rho] -
E_H[\rho]\)</span>)：总电子排斥能与经典库仑排斥能之间的差值（即所有非经典的交换效应和相关效应）。</li>
</ul></li>
</ul></li>
</ol>
<h3 id="kohn-sham-方程实践的工具">3. Kohn-Sham 方程：实践的工具</h3>
<p>现在我们有了能量表达式。根据变分原理（Hohenberg-Kohn
第二定理），我们通过最小化 <span class="math inline">\(E[\rho]\)</span>
来寻找基态密度 <span class="math inline">\(\rho(\vec{r})\)</span>。</p>
<p>对这个能量泛函 <span class="math inline">\(E[\rho]\)</span>
应用变分法，最终会得到一组<strong>类似于薛定谔方程</strong>的单电子方程，这就是著名的
<strong>Kohn-Sham (KS) 方程</strong>：</p>
<p><span class="math inline">\(\left( -\frac{\hbar^2}{2m} \nabla^2 +
V_{eff}(\vec{r}) \right) \phi_i(\vec{r}) = \varepsilon_i
\phi_i(\vec{r})\)</span></p>
<ul>
<li><span class="math inline">\(\phi_i(\vec{r})\)</span> 就是“Kohn-Sham
轨道”，电子密度由它们构成：<span class="math inline">\(\rho(\vec{r}) =
\sum_i |\phi_i(\vec{r})|^2\)</span>。</li>
<li><span class="math inline">\(V_{eff}(\vec{r})\)</span>
是一个“有效势”，无相互作用的电子在这个势场中运动： <span
class="math inline">\(V_{eff}(\vec{r}) = V_{ext}(\vec{r}) + V_H(\vec{r})
+ V_{xc}(\vec{r})\)</span>
<ul>
<li><span class="math inline">\(V_{ext}\)</span>：原子核的势。</li>
<li><span class="math inline">\(V_H\)</span>：电子间的经典库仑势（来自
<span class="math inline">\(E_H\)</span>）。</li>
<li><span
class="math inline">\(V_{xc}\)</span>：<strong>交换-相关势</strong>（来自
<span class="math inline">\(E_{xc}\)</span>）。</li>
</ul></li>
</ul>
<h3 id="唯一的近似泛函动物园">4. 唯一的近似：“泛函动物园”</h3>
<p><strong>Kohn-Sham 理论在形式上是精确的。</strong>
如果我们知道了<em>精确的</em> <span
class="math inline">\(E_{xc}[\rho]\)</span>
泛函，我们将得到体系的精确基态能量和密度。</p>
<p><strong>但在实践中，我们不知道精确的 <span
class="math inline">\(E_{xc}[\rho]\)</span>。</strong></p>
<p>因此，<strong>所有实用的 DFT 计算都变成了对 <span
class="math inline">\(E_{xc}[\rho]\)</span> 的近似。</strong></p>
<p>这就是您可能听说过的所有“泛函”（functionals）的来源，它们是对 <span
class="math inline">\(E_{xc}[\rho]\)</span>
的不同近似，构成了所谓的“泛函动物园”(Functional Zoo)：</p>
<ul>
<li><strong>LDA (局域密度近似):</strong> 最简单的近似，只依赖于 <span
class="math inline">\(\rho\)</span>。</li>
<li><strong>GGA (广义梯度近似):</strong> 依赖于 <span
class="math inline">\(\rho\)</span> 和它的梯度 <span
class="math inline">\(\nabla\rho\)</span> (例如 PBE, BLYP)。</li>
<li><strong>Hybrid (杂化) 泛函:</strong> 混合了一部分 Hartree-Fock
的精确交换（例如 B3LYP, PBE0）。</li>
</ul>
<h3 id="总结实践中的-dft">总结：实践中的 DFT</h3>
<ol type="1">
<li><strong>选择一个近似的 <span
class="math inline">\(E_{xc}[\rho]\)</span> 泛函</strong>（例如
B3LYP）。</li>
<li><strong>猜测</strong>一个初始的电子密度 <span
class="math inline">\(\rho_{guess}\)</span>。</li>
<li>根据 <span class="math inline">\(\rho_{guess}\)</span> 计算出有效势
<span class="math inline">\(V_{eff}\)</span>。</li>
<li>求解 Kohn-Sham 方程，得到一组新的轨道 <span
class="math inline">\(\phi_i\)</span>。</li>
<li>根据新的 <span class="math inline">\(\phi_i\)</span>
计算出一个新的电子密度 <span
class="math inline">\(\rho_{new}\)</span>。</li>
<li>比较 <span class="math inline">\(\rho_{new}\)</span> 和 <span
class="math inline">\(\rho_{guess}\)</span>。如果它们足够接近，计算完成（“自洽”）。</li>
<li>如果不同，则混合新旧密度，返回第 3
步，<strong>循环迭代</strong>直到收敛。</li>
</ol>
<p>Kohn-Sham 理论的伟大之处在于，它将一个极其复杂的 <span
class="math inline">\(N\)</span> 电子问题（如 <span
class="math inline">\(10^{90}\)</span>
维度），<strong>在数学上等价地</strong>转化为了一个（原则上精确的）求解
<span class="math inline">\(N\)</span> 个电子在有效势场中运动的 3
维问题。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">28</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
