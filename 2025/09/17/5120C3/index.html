<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tianyaoblogs.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="PHYS 5120 - 计算能源材料和电子结构模拟 Lecture-3 Lecturer: Prof.PAN DING 1 radial distribution function:  内容:  This whiteboard explains the process of calculating the radial distribution function, often d">
<meta property="og:type" content="article">
<meta property="og:title" content="PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W3-1">
<meta property="og:url" content="https://tianyaoblogs.github.io/2025/09/17/5120C3/index.html">
<meta property="og:site_name" content="TianyaoBlogs">
<meta property="og:description" content="PHYS 5120 - 计算能源材料和电子结构模拟 Lecture-3 Lecturer: Prof.PAN DING 1 radial distribution function:  内容:  This whiteboard explains the process of calculating the radial distribution function, often d">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-09-17T13:00:00.000Z">
<meta property="article:modified_time" content="2025-09-19T12:28:09.350Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="PHYS-5120">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tianyaoblogs.github.io/2025/09/17/5120C3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W3-1 | TianyaoBlogs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">TianyaoBlogs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/09/17/5120C3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W3-1
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-09-17 21:00:00" itemprop="dateCreated datePublished" datetime="2025-09-17T21:00:00+08:00">2025-09-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-09-19 20:28:09" itemprop="dateModified" datetime="2025-09-19T20:28:09+08:00">2025-09-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHYS-5120/" itemprop="url" rel="index"><span itemprop="name">PHYS-5120</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>PHYS 5120 - 计算能源材料和电子结构模拟 Lecture-3</p>
<p><a target="_blank" rel="noopener" href="https://chem.hkust.edu.hk/people/ding-pan-panding">Lecturer:
Prof.PAN DING</a></p>
<h2 id="radial-distribution-function">1 radial distribution
function:</h2>
<ul>
<li><strong>内容</strong>:</li>
</ul>
<p>This whiteboard explains the process of calculating the
<strong>radial distribution function</strong>, often denoted as <span
class="math inline">\(g(r)\)</span>, to analyze the atomic structure of
a material, which is referred to here as a “film”.
本白板解释了计算<strong>径向分布函数</strong>（通常表示为 <span
class="math inline">\(g(r)\)</span>）的过程，用于分析材料（本文中称为“薄膜”）的原子结构。</p>
<p>In simple terms, the radial distribution function tells you the
probability of finding an atom at a certain distance from another
reference atom. It’s a powerful way to see the local structure in a
disordered system like a liquid or an amorphous solid.</p>
<p>简单来说，径向分布函数表示在距离另一个参考原子一定距离处找到一个原子的概率。它是观察无序系统（例如液体或非晶态固体）局部结构的有效方法。</p>
<h3 id="core-concept-radial-distribution-function-径向分布函数">## Core
Concept: Radial Distribution Function 径向分布函数</h3>
<p>The main goal is to compute the radial distribution function, <span
class="math inline">\(g(r)\)</span>, which is defined as the ratio of
the actual number of atoms found in a thin shell at a distance <span
class="math inline">\(r\)</span> to the number of atoms you’d expect to
find if the material were an ideal gas (completely random).
主要目标是计算径向分布函数 <span
class="math inline">\(g(r)\)</span>，其定义为在距离 <span
class="math inline">\(r\)</span>
的薄壳层中实际发现的原子数与材料为理想气体（完全随机）时预期发现的原子数之比。</p>
<p>The formula is expressed as: <span class="math display">\[g(r)dr =
\frac{n(r)}{\text{ideal gas}}\]</span></p>
<ul>
<li><strong><span class="math inline">\(n(r)\)</span></strong>:
Represents the average number of atoms found in a thin spherical shell
between a distance <span class="math inline">\(r\)</span> and <span
class="math inline">\(r+dr\)</span> from a central atom.
表示距离中心原子 <span class="math inline">\(r\)</span> 到 <span
class="math inline">\(r+dr\)</span> 之间的薄球壳中原子的平均数量。</li>
<li><strong>ideal gas</strong>: Represents the number of atoms you would
expect in that same shell if the atoms were distributed completely
randomly with the same average density (<span
class="math inline">\(\rho\)</span>). The volume of this shell is
approximately <span class="math inline">\(4\pi r^2
dr\)</span>.表示如果原子完全随机分布且平均密度 (<span
class="math inline">\(\rho\)</span>)
相同，则该球壳中原子的数量。该球壳的体积约为 <span
class="math inline">\(4\pi r^2 dr\)</span>。</li>
</ul>
<p>A peak in the <span class="math inline">\(g(r)\)</span> plot
indicates a high probability of finding neighboring atoms at that
specific distance, revealing the material’s structural shells (e.g.,
nearest neighbors, second-nearest neighbors, etc.).<span
class="math inline">\(g(r)\)</span>
图中的峰值表示在该特定距离处找到相邻原子的概率很高，从而揭示了材料的结构壳（例如，最近邻、次近邻等）。</p>
<h3 id="calculation-method">## Calculation Method</h3>
<p>The board outlines a two-step averaging process to get a
statistically meaningful result from simulation data (a “film” at 20
frames per second).</p>
<ol type="1">
<li><p><strong>Average over atoms:</strong> In a single frame (a
snapshot in time), you pick one atom as the center. Then, you count how
many other atoms (<span class="math inline">\(n(r)\)</span>) are in
concentric spherical shells around it. This process is repeated,
treating each atom in the frame as the center, and the results are
averaged.</p></li>
<li><p><strong>Average over frames:</strong> The entire process
described above is repeated for multiple frames from the simulation or
video. This time-averaging ensures that the final result represents the
typical structure of the material over time, smoothing out random
fluctuations.</p></li>
</ol>
<p>The board notes “dx = bin width 0.01Å”, which is a practical detail
for the calculation. To create a histogram, the distance <code>r</code>
is divided into small segments (bins) of 0.01 angstroms.</p>
<h3 id="connection-to-experiments">## Connection to Experiments</h3>
<p>Finally, the whiteboard mentions <strong>“frame X-ray
scattering”</strong>. This is a crucial point because it connects this
computational analysis to real-world experiments. Experimental
techniques like X-ray or neutron scattering can be used to measure a
quantity called the structure factor, <span
class="math inline">\(S(q)\)</span>, which is directly related to the
radial distribution function <span class="math inline">\(g(r)\)</span>
through a mathematical operation called a Fourier transform. This allows
scientists to directly compare the structure produced in their
simulations with the structure of a real material measured in a lab.
最后，白板上提到了<strong>“帧 X
射线散射”</strong>。这一点至关重要，因为它将计算分析与实际实验联系起来。X射线或中子散射等实验技术可以用来测量一个称为结构因子<span
class="math inline">\(S(q)\)</span>的量，该量通过傅里叶变换的数学运算与径向分布函数<span
class="math inline">\(g(r)\)</span>直接相关。这使得科学家能够直接将模拟中产生的结构与实验室测量的真实材料结构进行比较。</p>
<p>The board correctly links <span class="math inline">\(g(r)\)</span>
to X-ray scattering experiments. The quantity measured in these
experiments is the <strong>static structure factor</strong>, <span
class="math inline">\(S(q)\)</span>, which describes how the material
scatters radiation. The relationship between the two is a Fourier
transform: 该板正确地将<span
class="math inline">\(g(r)\)</span>与X射线散射实验联系起来。这些实验中测量的量是<strong>静态结构因子</strong><span
class="math inline">\(S(q)\)</span>，它描述了材料如何散射辐射。两者之间的关系是傅里叶变换：
<span class="math display">\[S(q) = 1 + 4 \pi \rho \int_0^\infty [g(r) -
1] r^2 \frac{\sin(qr)}{qr} dr\]</span> This equation is crucial because
it bridges the gap between computer simulations (which calculate <span
class="math inline">\(g(r)\)</span>) and physical experiments (which
measure <span class="math inline">\(S(q)\)</span>).
这个方程至关重要，因为它弥合了计算机模拟（计算 <span
class="math inline">\(g(r)\)</span>）和物理实验（测量 <span
class="math inline">\(S(q)\)</span>）之间的差距。</p>
<h3
id="the-gaussian-distribution-probability-of-particle-position-高斯分布粒子位置的概率">##
2. The Gaussian Distribution: Probability of Particle Position
高斯分布：粒子位置的概率</h3>
<p>The board starts with the formula for a one-dimensional
<strong>Gaussian (or normal) distribution</strong>:
白板首先展示的是一维<strong>高斯（或正态）分布</strong>的公式：</p>
<p><span class="math display">\[f(x | \mu, \sigma^2) =
\frac{1}{\sqrt{2\pi\sigma^2}}
\exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)\]</span></p>
<p>This equation describes the probability of finding a particle at a
specific position <code>x</code> after a certain amount of time has
passed. * <strong><span class="math inline">\(\mu\)</span> (mu)</strong>
is the <strong>mean</strong> or average position. For a simple diffusion
process starting at the origin, the particles spread out symmetrically,
so the average position remains at the origin (<span
class="math inline">\(\mu = 0\)</span>). * <strong><span
class="math inline">\(\sigma^2\)</span> (sigma squared)</strong> is the
<strong>variance</strong>, which measures how spread out the particles
are from the mean position. A larger variance means the particles have,
on average, traveled farther from the starting point.
这个方程描述了经过一定时间后，在特定位置“x”找到粒子的概率。 *
<strong><span class="math inline">\(\mu\)</span> (mu)</strong>
是<strong>平均值</strong>或平均位置。对于从原点开始的简单扩散过程，粒子对称扩散，因此平均位置保持在原点（<span
class="math inline">\(\mu = 0\)</span>）。 * <strong><span
class="math inline">\(\sigma^2\)</span>（sigma 平方）</strong>
是<strong>方差</strong>，用​​于衡量粒子与平均位置的扩散程度。方差越大，意味着粒子平均距离起点越远。</p>
<p>The note “Black-Scholes” is a side reference. The Black-Scholes
model, famous in financial mathematics for pricing options, uses similar
mathematical principles based on Brownian motion to model the random
fluctuations of stock prices. “Black-Scholes”注释仅供参考。Black-Scholes
模型在金融数学中以期权定价而闻名，它使用基于布朗运动的类似数学原理来模拟股票价格的随机波动。</p>
<h3
id="mean-squared-displacement-msd-quantifying-the-spread-均方位移-msd量化扩散">##
3. Mean Squared Displacement (MSD): Quantifying the Spread 均方位移
(MSD)：量化扩散</h3>
<p>The core of the board is dedicated to the <strong>Mean Squared
Displacement (MSD)</strong>. This is the primary tool used to measure
how far, on average, particles have moved over a time interval
<code>t</code>. 本版块的核心内容是<strong>均方位移
(MSD)</strong>。这是用于测量粒子在时间间隔“t”内平均移动距离的主要工具。</p>
<p>The variance <span class="math inline">\(\sigma^2\)</span> is
formally defined as the average of the squared deviations from the mean:
<span class="math display">\[\sigma^2 = \langle x^2(t) \rangle - \langle
x(t) \rangle^2\]</span> * <span class="math inline">\(\langle x(t)
\rangle\)</span> is the average displacement. As mentioned, for simple
diffusion, <span class="math inline">\(\langle x(t) \rangle =
0\)</span>. * <span class="math inline">\(\langle x^2(t)
\rangle\)</span> is the average of the <em>square</em> of the
displacement. 方差<span
class="math inline">\(\sigma^2\)</span>的正式定义为与平均值偏差平方的平均值：
<span class="math display">\[\sigma^2 = \langle x^2(t) \rangle - \langle
x(t) \rangle^2\]</span> * <span class="math inline">\(\langle x(t)
\rangle\)</span>是平均位移。如上所述，对于简单扩散，<span
class="math inline">\(\langle x(t) \rangle = 0\)</span>。 * <span
class="math inline">\(\langle x^2(t)
\rangle\)</span>是位移<em>平方</em>的平均值。</p>
<p>Since <span class="math inline">\(\langle x(t) \rangle = 0\)</span>,
the variance is simply equal to the MSD: <span
class="math display">\[\sigma^2 = \langle x^2(t) \rangle\]</span> 由于
<span class="math inline">\(\langle x(t) \rangle =
0\)</span>，方差等于均方差 (MSD)： <span class="math display">\[\sigma^2
= \langle x^2(t) \rangle\]</span></p>
<p>The crucial insight for a diffusive process is that the <strong>MSD
grows linearly with time</strong>. The rate of this growth is determined
by the <strong>diffusion coefficient, D</strong>. The board shows this
relationship for different dimensions: 扩散过程的关键在于<strong>MSD
随时间线性增长</strong>。其增长率由<strong>扩散系数
D</strong>决定。棋盘显示了不同维度下的这种关系：</p>
<ul>
<li><strong>1D:</strong> <span class="math inline">\(\langle x^2(t)
\rangle = 2Dt\)</span> (Movement along a line) （沿直线运动）</li>
<li><strong>2D:</strong> The board has a slight typo or ambiguity with
<span class="math inline">\(\langle z^2(t) \rangle = 2Dt\)</span>. For
2D motion in the x-y plane, the total MSD would be <span
class="math inline">\(\langle r^2(t) \rangle = \langle x^2(t) \rangle +
\langle y^2(t) \rangle = 4Dt\)</span>. The note on the board might be
referring to just one component of motion. **棋盘上的 <span
class="math inline">\(\langle z^2(t) \rangle = 2Dt\)</span>
存在轻微拼写错误或歧义。对于 x-y 平面上的二维运动，总平均散射差 (MSD) 为
<span class="math inline">\(\langle r^2(t) \rangle = \langle x^2(t)
\rangle + \langle y^2(t) \rangle =
4Dt\)</span>。黑板上的注释可能仅指运动的一个分量。</li>
<li><strong>3D:</strong> <span class="math inline">\(\langle r^2(t)
\rangle = \langle |\vec{r}(t) - \vec{r}(0)|^2 \rangle = 6Dt\)</span>
(Movement in 3D space, which is the most common case in molecular
simulations) （三维空间中的运动，这是分子模拟中最常见的情况） Here,
<span class="math inline">\(\vec{r}(t)\)</span> is the position vector
of a particle at time <code>t</code>. The quantity <span
class="math inline">\(\langle |\vec{r}(t) - \vec{r}(0)|^2
\rangle\)</span> is the average of the squared distance a particle has
traveled from its initial position <span
class="math inline">\(\vec{r}(0)\)</span>. 这里，<span
class="math inline">\(\vec{r}(t)\)</span> 是粒子在时间 <code>t</code>
的位置矢量。 <span class="math inline">\(\langle |\vec{r}(t) -
\vec{r}(0)|^2 \rangle\)</span> 是粒子从其初始位置 <span
class="math inline">\(\vec{r}(0)\)</span> 行进距离的平方平均值。</li>
</ul>
<h3
id="the-einstein-relation-connecting-microscopic-motion-to-a-macroscopic-property-爱因斯坦关系将微观运动与宏观特性联系起来">##
4. The Einstein Relation: Connecting Microscopic Motion to a Macroscopic
Property 爱因斯坦关系：将微观运动与宏观特性联系起来</h3>
<p>Finally, the board presents the famous <strong>Einstein
relation</strong>, which rearranges the 3D MSD equation to solve for the
diffusion coefficient <code>D</code>:</p>
<p><span class="math display">\[D = \lim_{t \to \infty} \frac{\langle
|\vec{r}(t) - \vec{r}(0)|^2 \rangle}{6t}\]</span></p>
<p>This is a cornerstone equation in statistical mechanics. It provides
a practical way to calculate a macroscopic property—the
<strong>diffusion coefficient <code>D</code></strong>—from the
microscopic movements of individual particles observed in a computer
simulation.
这是统计力学中的一个基石方程。它提供了一种实用的方法，可以通过计算机模拟中观察到的单个粒子的微观运动来计算宏观属性——扩散系数“D”。</p>
<p>In practice, one would: 1. Run a simulation of particles.
运行粒子模拟。 2. Track the position of each particle over time.
跟踪每个粒子随时间的位置。 3. Calculate the squared displacement <span
class="math inline">\(|\vec{r}(t) - \vec{r}(0)|^2\)</span> for each
particle at various time intervals <code>t</code>.
计算每个粒子在不同时间间隔“t”的位移平方<span
class="math inline">\(|\vec{r}(t) - \vec{r}(0)|^2\)</span>。 4. Average
this value over all particles to get the MSD, <span
class="math inline">\(\langle |\vec{r}(t) - \vec{r}(0)|^2
\rangle\)</span>. 对所有粒子取平均值，得到均方差（MSD），即<span
class="math inline">\(\langle |\vec{r}(t) - \vec{r}(0)|^2
\rangle\)</span>。 5. Plot the MSD as a function of time.
将MSD绘制成时间函数。 6. The slope of this line, divided by 6, gives the
diffusion coefficient <code>D</code>. The <code>lim t→∞</code> indicates
that this linear relationship is most accurate for long time scales,
after initial transient effects have died down.
这条直线的斜率除以6，即扩散系数“D”。“lim
t→∞”表明，在初始瞬态效应消退后，这种线性关系在长时间尺度上最为准确。</p>
<h3 id="right-board-green-kubo-relations">## 5. Right Board: Green-Kubo
Relations</h3>
<p>This board introduces a more advanced and powerful method to
calculate transport coefficients like the diffusion coefficient, known
as the <strong>Green-Kubo relations</strong>.
本面板介绍了一种更先进、更强大的方法来计算扩散系数等传输系数，即<strong>Green-Kubo
关系</strong>。</p>
<h4 id="velocity-autocorrelation-function-vacf-速度自相关函数-vacf">###
<strong>Velocity Autocorrelation Function (VACF)</strong> 速度自相关函数
(VACF)</h4>
<p>The key idea is to look at how a particle’s velocity at one point in
time is related to its velocity at a later time. This is measured by the
<strong>Velocity Autocorrelation Function (VACF)</strong>: <span
class="math display">\[C_{vv}(t) = \langle \vec{v}(t&#39;) \cdot
\vec{v}(t&#39; + t) \rangle\]</span> This function tells us how long a
particle “remembers” its velocity. For a typical liquid, the velocity is
quickly randomized by collisions, so the VACF decays to zero rapidly.
其核心思想是考察粒子在某一时间点的速度与其在之后时间点的速度之间的关系。这可以通过<strong>速度自相关函数
(VACF)</strong>来测量： <span class="math display">\[C_{vv}(t) = \langle
\vec{v}(t&#39;) \cdot \vec{v}(t&#39; + t) \rangle\]</span>
此函数告诉我们粒子“记住”其速度的时间。对于典型的液体，速度会因碰撞而迅速随机化，因此
VACF 会迅速衰减为零。</p>
<h4 id="connecting-msd-and-vacf">### <strong>Connecting MSD and
VACF</strong></h4>
<p>The board shows the mathematical link between the MSD and the VACF.
Starting with the definition of position as the integral of velocity,
<span class="math inline">\(\vec{r}(t) = \int_0^t \vec{v}(t&#39;)
dt&#39;\)</span>, one can show that the MSD is a double integral of the
VACF. The board writes this as: <span class="math display">\[\langle
x^2(t) \rangle = \left\langle \left( \int_0^t v(t&#39;) dt&#39; \right)
\left( \int_0^t v(t&#39;&#39;) dt&#39;&#39; \right) \right\rangle =
\int_0^t dt&#39; \int_0^t dt&#39;&#39; \langle v(t&#39;) v(t&#39;&#39;)
\rangle\]</span> This shows that the two pictures of motion—the
particle’s displacement (MSD) and its velocity fluctuations (VACF)—are
deeply connected. 该面板展示了 MSD 和 VACF
之间的数学联系。从位置定义为速度的积分开始，<span
class="math inline">\(\vec{r}(t) = \int_0^t \vec{v}(t&#39;)
dt&#39;\)</span>，可以证明 MSD 是 VACF 的二重积分。黑板上写着： <span
class="math display">\[\langle x^2(t) \rangle = \left\langle \left(
\int_0^t v(t&#39;) dt&#39; \right) \left( \int_0^t v(t&#39;&#39;)
dt&#39;&#39; \right) \right\rangle = \int_0^t dt&#39; \int_0^t
dt&#39;&#39; \langle v(t&#39;) v(t&#39;&#39;) \rangle\]</span>
这表明，粒子运动的两幅图像——粒子的位移（MSD）和速度涨落（VACF）——之间存在着深刻的联系。</p>
<h4 id="the-green-kubo-formula-for-diffusion-扩散的格林-久保公式">###
<strong>The Green-Kubo Formula for Diffusion
扩散的格林-久保公式</strong></h4>
<p>By combining the Einstein relation with the integral of the VACF, one
arrives at the Green-Kubo formula for the diffusion coefficient: <span
class="math display">\[D = \frac{1}{3} \int_0^\infty \langle \vec{v}(0)
\cdot \vec{v}(t) \rangle dt\]</span> This incredible result states that
the <strong>macroscopic</strong> property of diffusion (<span
class="math inline">\(D\)</span>) is determined by the integral of the
<strong>microscopic</strong> velocity correlations. It’s often a more
efficient way to compute <span class="math inline">\(D\)</span> in
simulations than calculating the long-time limit of the MSD.
将爱因斯坦关系与VACF积分相结合，可以得到扩散系数的格林-久保公式： <span
class="math display">\[D = \frac{1}{3} \int_0^\infty \langle \vec{v}(0)
\cdot \vec{v}(t) \rangle dt\]</span>
这个令人难以置信的结果表明，扩散的<strong>宏观</strong>特性（<span
class="math inline">\(D\)</span>）由<strong>微观</strong>速度关联的积分决定。在模拟中，这通常是计算<span
class="math inline">\(D\)</span>比计算MSD的长期极限更有效的方法。</p>
<h3 id="the-grand-narrative-from-micro-to-macro-宏大叙事从微观到宏观">##
6. The Grand Narrative: From Micro to Macro 宏大叙事：从微观到宏观</h3>
<p>The previous whiteboards gave us two ways to calculate the
<strong>diffusion constant, D</strong>, from the microscopic random walk
of individual atoms:
之前的白板提供了两种从单个原子的微观随机游动计算<strong>扩散常数
D</strong>的方法： 1. <strong>Einstein Relation:</strong> From the
long-term slope of the Mean Squared Displacement (MSD). 根据均方位移
(MSD) 的长期斜率。 2. <strong>Green-Kubo Relation:</strong> From the
integral of the Velocity Autocorrelation Function (VACF).
根据速度自相关函数 (VACF) 的积分。</p>
<p>This new whiteboard shows how that single microscopic parameter,
<code>D</code>, governs the large-scale, observable process of diffusion
described by <strong>Fick’s Laws</strong> and the <strong>Diffusion
Equation</strong>. 这块新的白板展示了单个微观参数 <code>D</code>
如何控制<strong>菲克定律</strong>和<strong>扩散方程</strong>所描述的大规模可观测扩散过程。</p>
<h3 id="the-starting-point-a-liquids-structure-起点液体的结构">## 1. The
Starting Point: A Liquid’s Structure 起点：液体的结构</h3>
<p>The plot on the top left is the <strong>Radial Distribution Function,
<span class="math inline">\(g(r)\)</span></strong>, which we discussed
in detail from the first whiteboard. 左上角的图是<strong>径向分布函数
<span
class="math inline">\(g(r)\)</span></strong>，我们在第一个白板上详细讨论过它。</p>
<ul>
<li><strong>The Plot:</strong> It shows the characteristic structure of
a liquid. The peaks are labeled “1st”, “2nd”, and “3rd”, corresponding
to the first, second, and third <strong>solvation shells</strong>
(layers of neighboring atoms).
它显示了液体的特征结构。峰分别标记为“第一”、“第二”和“第三”，分别对应于第一、第二和第三<strong>溶剂化壳层</strong>（相邻原子层）。</li>
<li><strong>The Limit:</strong> The note <code>lim r→∞ g(r) = 1</code>
confirms that at large distances, the liquid has no long-range order, as
expected.注释“lim r→∞ g(r) =
1”证实了在远距离下，液体没有长程有序，这与预期一致。</li>
<li><strong>System Parameters:</strong> The values <code>T = 0.71</code>
and <code>ρ = 0.844</code> are the temperature and density of the
simulated system (likely in reduced or “Lennard-Jones” units) for which
this <span class="math inline">\(g(r)\)</span> was calculated. 值“T =
0.71”和“ρ =
0.844”分别是模拟系统的温度和密度（可能采用约化或“Lennard-Jones”单位），用于计算此
<span class="math inline">\(g(r)\)</span>。</li>
</ul>
<p>This section sets the stage: we are looking at the dynamics within a
system that has this specific liquid-like structure.
本节奠定了基础：我们将研究具有特定类液体结构的系统内的动力学。</p>
<h3 id="the-macroscopic-laws-of-diffusion-宏观扩散定律">## 2. The
Macroscopic Laws of Diffusion 宏观扩散定律</h3>
<p>The bottom-left and top-right sections introduce the continuum
equations that describe how concentration changes in space and time.
左下角和右上角部分介绍了描述浓度随空间和时间变化的连续方程。左下角和右上角部分介绍了描述浓度随空间和时间变化的连续方程。</p>
<h4 id="ficks-first-law-菲克第一定律">### <strong>Fick’s First Law
菲克第一定律</strong></h4>
<p><span class="math display">\[\vec{J} = -D \nabla C\]</span> This is
Fick’s first law of diffusion. It states that there is a
<strong>flux</strong> of particles (<span
class="math inline">\(\vec{J}\)</span>), meaning a net flow. This flow
is directed from high concentration to low concentration (hence the
minus sign) and its magnitude is proportional to the
<strong>concentration gradient</strong> (<span
class="math inline">\(\nabla C\)</span>).
这是菲克第一扩散定律。它指出存在粒子的<strong>通量</strong> (<span
class="math inline">\(\vec{J}\)</span>)，即净流量。该流量从高浓度流向低浓度（因此带有负号），其大小与<strong>浓度梯度</strong>
(<span class="math inline">\(\nabla C\)</span>) 成正比。</p>
<p><strong>The Crucial Link:</strong> The proportionality constant is
<strong>D</strong>, the very same <strong>diffusion constant</strong> we
calculated from the microscopic random walk (MSD/VACF). This is the key
connection: the collective result of countless individual random walks
is a predictable net flow of particles.
比例常数是<strong>D</strong>，与我们根据微观随机游走 (MSD/VACF)
计算出的<strong>扩散常数</strong>完全相同。这是关键的联系：无数个体随机游动的集合结果是可预测的粒子净流。</p>
<h4
id="the-diffusion-equation-ficks-second-law-扩散方程菲克第二定律">###
<strong>The Diffusion Equation (Fick’s Second Law)
扩散方程（菲克第二定律）</strong></h4>
<p><span class="math display">\[\frac{\partial C(\vec{r},t)}{\partial t}
= D \nabla^2 C(\vec{r},t)\]</span> This is the <strong>diffusion
equation</strong>, one of the most important equations in physics and
chemistry (also called the heat equation, as noted). It’s derived from
Fick’s first law and the principle of mass conservation (<span
class="math inline">\(\frac{\partial C}{\partial t} + \nabla \cdot
\vec{J} = 0\)</span>). It’s a differential equation that tells you
exactly how the concentration at any point, <span
class="math inline">\(C(\vec{r},t)\)</span>, will change over time.
这就是<strong>扩散方程</strong>，它是物理学和化学中最重要的方程之一（也称为热方程）。它源于菲克第一定律和质量守恒定律（<span
class="math inline">\(\frac{\partial C}{\partial t} + \nabla \cdot
\vec{J} = 0\)</span>）。它是一个微分方程，可以精确地告诉你任意一点的浓度
<span class="math inline">\(C(\vec{r},t)\)</span> 随时间的变化。</p>
<h3
id="the-solution-connecting-back-to-the-random-walk-与随机游动联系起来">##
3. The Solution: Connecting Back to the Random Walk
与随机游动联系起来</h3>
<p>This is the most beautiful part. The board shows the solution to the
diffusion equation for a very specific scenario, linking the macroscopic
equation directly back to the microscopic random walk.
黑板上展示了一个非常具体场景下扩散方程的解，将宏观方程直接与微观随机游动联系起来。</p>
<h4 id="the-initial-condition-初始条件">### <strong>The Initial
Condition 初始条件</strong></h4>
<p>The problem is set up by assuming all particles start at a single
point at time zero: <span class="math display">\[C(\vec{r}, 0) =
\delta(\vec{r})\]</span> This is a <strong>Dirac delta
function</strong>, representing an infinitely concentrated point source
at the origin. 问题假设所有粒子在时间零点处从一个点开始： <span
class="math display">\[C(\vec{r}, 0) = \delta(\vec{r})\]</span>
这是一个<strong>狄拉克函数</strong>，表示一个在原点处无限集中的点源。</p>
<h4 id="the-fundamental-solution-greens-function-基本解格林函数">###
<strong>The Fundamental Solution (Green’s Function)
基本解（格林函数）</strong></h4>
<p>The solution to the diffusion equation with this starting condition
is called the <strong>fundamental solution</strong> or <strong>Green’s
function</strong>. For one dimension, it is: <span
class="math display">\[C(x,t) = \frac{1}{\sqrt{4\pi Dt}}
\exp\left(-\frac{x^2}{4Dt}\right)\]</span></p>
<p><strong>The “Aha!” Moment:</strong> This is a <strong>Gaussian
distribution</strong>. Let’s compare it to the formula from the second
whiteboard: * The mean is <span class="math inline">\(\mu=0\)</span>.
均值为 <span class="math inline">\(\mu=0\)</span>。 * The variance is
<span class="math inline">\(\sigma^2 = 2Dt\)</span>. 方差为 <span
class="math inline">\(\sigma^2 = 2Dt\)</span>。</p>
<p>This is an incredible result. The macroscopic diffusion equation
predicts that a concentration pulse will spread out over time, and the
shape of the concentration profile will be a Gaussian curve. The width
of this curve, measured by its variance <span
class="math inline">\(\sigma^2\)</span>, is <strong>exactly the Mean
Squared Displacement, <span class="math inline">\(\langle x^2(t)
\rangle\)</span>, of the individual random-walking particles.</strong>
宏观扩散方程预测浓度脉冲会随时间扩散，浓度分布的形状将是高斯曲线。这条曲线的宽度，用其方差
<span class="math inline">\(\sigma^2\)</span>
来衡量，<strong>恰好是单个随机游动粒子的均方位移 <span
class="math inline">\(\langle x^2(t) \rangle\)</span>。</strong></p>
<p>This perfectly unites the two perspectives: * <strong>Microscopic微观
(Board 2):</strong> Particles undergo a random walk, and their average
squared displacement from the origin grows as <span
class="math inline">\(\langle x^2(t) \rangle = 2Dt\)</span>.
粒子进行随机游动，它们相对于原点的平均平方位移随着 <span
class="math inline">\(\langle x^2(t) \rangle = 2Dt\)</span>
的增长而增长。 * <strong>Macroscopic宏观 (This Board):</strong> A
collection of these particles, described by a continuum concentration
<code>C</code>, spreads out in a Gaussian profile whose variance is
<span class="math inline">\(\sigma^2 = 2Dt\)</span>.
这些粒子的集合，用连续浓度“C”来描述，呈方差为 <span
class="math inline">\(\sigma^2 = 2Dt\)</span> 的高斯分布。</p>
<p>The two pictures are mathematically identical.</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/PHYS-5120/" rel="tag"># PHYS-5120</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/09/17/5120C3-2/" rel="prev" title="PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W3-2">
      <i class="fa fa-chevron-left"></i> PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W3-2
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/09/18/img_assert/" rel="next" title="BLOGS - IMG Assert">
      BLOGS - IMG Assert <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#radial-distribution-function"><span class="nav-number">1.</span> <span class="nav-text">1 radial distribution
function:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#core-concept-radial-distribution-function-%E5%BE%84%E5%90%91%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.</span> <span class="nav-text">## Core
Concept: Radial Distribution Function 径向分布函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#calculation-method"><span class="nav-number">1.2.</span> <span class="nav-text">## Calculation Method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#connection-to-experiments"><span class="nav-number">1.3.</span> <span class="nav-text">## Connection to Experiments</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-gaussian-distribution-probability-of-particle-position-%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83%E7%B2%92%E5%AD%90%E4%BD%8D%E7%BD%AE%E7%9A%84%E6%A6%82%E7%8E%87"><span class="nav-number">1.4.</span> <span class="nav-text">##
2. The Gaussian Distribution: Probability of Particle Position
高斯分布：粒子位置的概率</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mean-squared-displacement-msd-quantifying-the-spread-%E5%9D%87%E6%96%B9%E4%BD%8D%E7%A7%BB-msd%E9%87%8F%E5%8C%96%E6%89%A9%E6%95%A3"><span class="nav-number">1.5.</span> <span class="nav-text">##
3. Mean Squared Displacement (MSD): Quantifying the Spread 均方位移
(MSD)：量化扩散</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-einstein-relation-connecting-microscopic-motion-to-a-macroscopic-property-%E7%88%B1%E5%9B%A0%E6%96%AF%E5%9D%A6%E5%85%B3%E7%B3%BB%E5%B0%86%E5%BE%AE%E8%A7%82%E8%BF%90%E5%8A%A8%E4%B8%8E%E5%AE%8F%E8%A7%82%E7%89%B9%E6%80%A7%E8%81%94%E7%B3%BB%E8%B5%B7%E6%9D%A5"><span class="nav-number">1.6.</span> <span class="nav-text">##
4. The Einstein Relation: Connecting Microscopic Motion to a Macroscopic
Property 爱因斯坦关系：将微观运动与宏观特性联系起来</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#right-board-green-kubo-relations"><span class="nav-number">1.7.</span> <span class="nav-text">## 5. Right Board: Green-Kubo
Relations</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#velocity-autocorrelation-function-vacf-%E9%80%9F%E5%BA%A6%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0-vacf"><span class="nav-number">1.7.1.</span> <span class="nav-text">###
Velocity Autocorrelation Function (VACF) 速度自相关函数
(VACF)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#connecting-msd-and-vacf"><span class="nav-number">1.7.2.</span> <span class="nav-text">### Connecting MSD and
VACF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#the-green-kubo-formula-for-diffusion-%E6%89%A9%E6%95%A3%E7%9A%84%E6%A0%BC%E6%9E%97-%E4%B9%85%E4%BF%9D%E5%85%AC%E5%BC%8F"><span class="nav-number">1.7.3.</span> <span class="nav-text">###
The Green-Kubo Formula for Diffusion
扩散的格林-久保公式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-grand-narrative-from-micro-to-macro-%E5%AE%8F%E5%A4%A7%E5%8F%99%E4%BA%8B%E4%BB%8E%E5%BE%AE%E8%A7%82%E5%88%B0%E5%AE%8F%E8%A7%82"><span class="nav-number">1.8.</span> <span class="nav-text">##
6. The Grand Narrative: From Micro to Macro 宏大叙事：从微观到宏观</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-starting-point-a-liquids-structure-%E8%B5%B7%E7%82%B9%E6%B6%B2%E4%BD%93%E7%9A%84%E7%BB%93%E6%9E%84"><span class="nav-number">1.9.</span> <span class="nav-text">## 1. The
Starting Point: A Liquid’s Structure 起点：液体的结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-macroscopic-laws-of-diffusion-%E5%AE%8F%E8%A7%82%E6%89%A9%E6%95%A3%E5%AE%9A%E5%BE%8B"><span class="nav-number">1.10.</span> <span class="nav-text">## 2. The
Macroscopic Laws of Diffusion 宏观扩散定律</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ficks-first-law-%E8%8F%B2%E5%85%8B%E7%AC%AC%E4%B8%80%E5%AE%9A%E5%BE%8B"><span class="nav-number">1.10.1.</span> <span class="nav-text">### Fick’s First Law
菲克第一定律</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#the-diffusion-equation-ficks-second-law-%E6%89%A9%E6%95%A3%E6%96%B9%E7%A8%8B%E8%8F%B2%E5%85%8B%E7%AC%AC%E4%BA%8C%E5%AE%9A%E5%BE%8B"><span class="nav-number">1.10.2.</span> <span class="nav-text">###
The Diffusion Equation (Fick’s Second Law)
扩散方程（菲克第二定律）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-solution-connecting-back-to-the-random-walk-%E4%B8%8E%E9%9A%8F%E6%9C%BA%E6%B8%B8%E5%8A%A8%E8%81%94%E7%B3%BB%E8%B5%B7%E6%9D%A5"><span class="nav-number">1.11.</span> <span class="nav-text">##
3. The Solution: Connecting Back to the Random Walk
与随机游动联系起来</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#the-initial-condition-%E5%88%9D%E5%A7%8B%E6%9D%A1%E4%BB%B6"><span class="nav-number">1.11.1.</span> <span class="nav-text">### The Initial
Condition 初始条件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#the-fundamental-solution-greens-function-%E5%9F%BA%E6%9C%AC%E8%A7%A3%E6%A0%BC%E6%9E%97%E5%87%BD%E6%95%B0"><span class="nav-number">1.11.2.</span> <span class="nav-text">###
The Fundamental Solution (Green’s Function)
基本解（格林函数）</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
