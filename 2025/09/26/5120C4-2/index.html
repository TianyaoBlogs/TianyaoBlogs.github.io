<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tianyaoblogs.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="PHYS 5120 - 计算能源材料和电子结构模拟 Lecture-4 Lecturer: Prof.PAN DING 1 Monte Carlo (MC) Method:  内容:  This whiteboard provides a concise but detailed overview of two important and related simulation te">
<meta property="og:type" content="article">
<meta property="og:title" content="PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W4">
<meta property="og:url" content="https://tianyaoblogs.github.io/2025/09/26/5120C4-2/index.html">
<meta property="og:site_name" content="TianyaoBlogs">
<meta property="og:description" content="PHYS 5120 - 计算能源材料和电子结构模拟 Lecture-4 Lecturer: Prof.PAN DING 1 Monte Carlo (MC) Method:  内容:  This whiteboard provides a concise but detailed overview of two important and related simulation te">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-09-26T13:00:00.000Z">
<meta property="article:modified_time" content="2025-09-26T12:48:45.176Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="PHYS-5120">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://tianyaoblogs.github.io/2025/09/26/5120C4-2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W4 | TianyaoBlogs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">TianyaoBlogs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianyaoblogs.github.io/2025/09/26/5120C4-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TianyaoBlogs">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          PHYS 5120 - Computational Energy Materials and Electronic Structure Simulations-W4
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-09-26 21:00:00 / 修改时间：20:48:45" itemprop="dateCreated datePublished" datetime="2025-09-26T21:00:00+08:00">2025-09-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHYS-5120/" itemprop="url" rel="index"><span itemprop="name">PHYS-5120</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>PHYS 5120 - 计算能源材料和电子结构模拟 Lecture-4</p>
<p><a target="_blank" rel="noopener" href="https://chem.hkust.edu.hk/people/ding-pan-panding">Lecturer:
Prof.PAN DING</a></p>
<h2 id="monte-carlo-mc-method">1 Monte Carlo (MC) Method:</h2>
<ul>
<li><strong>内容</strong>:</li>
</ul>
<p>This whiteboard provides a concise but detailed overview of two
important and related simulation techniques in computational physics and
chemistry: the Metropolis Monte Carlo (MC) method and Hamiltonian (or
Hybrid) Monte Carlo (HMC). Here is a detailed breakdown of the concepts
presented.</p>
<h3 id="metropolis-monte-carlo-mc-method">1. Metropolis Monte Carlo (MC)
Method</h3>
<p>The heading “Metropolis MC method” introduces a foundational
algorithm in statistical mechanics. Metropolis Monte Carlo is a method
used to generate a sequence of states for a system, allowing for the
calculation of average properties. 左上角的这一部分介绍了基础的
<strong>Metropolis Monte Carlo</strong>
算法。它是一种生成状态序列的方法，使得处于任何状态的概率都符合期望的概率分布（在物理学中通常是玻尔兹曼分布）。</p>
<ul>
<li><strong>Conceptual Diagram:</strong> The small box with numbered
sites (0-5) and an arrow showing a move from state 0 to 2, and then to
3, illustrates a “random walk.” In Metropolis MC, the system transitions
from one state to another by making small, random changes.
小方框中标有编号的位点（0-5），箭头表示从状态 0 到状态 2，再到状态 3
的移动，代表“随机游走”。在 Metropolis MC
中，系统通过进行微小的随机变化从一个状态过渡到另一个状态。</li>
<li><strong>Random Number Generation:</strong> The notation
<code>rand t \in (0,1)</code> indicates the use of a random number <span
class="math inline">\(t\)</span> drawn from a uniform distribution
between 0 and 1. This is a core component of the algorithm, used to
decide whether to accept or reject a proposed new state. 符号
<code>rand t \in (0,1)</code> 表示使用从 0 到 1
之间的均匀分布中抽取的随机数 <span
class="math inline">\(t\)</span>。这是算法的核心部分，用于决定是否接受或拒绝提议的新状态。</li>
<li><strong>Detailed Balance Condition:</strong> The equation <span
class="math inline">\(P_o T(o \to n) = P_n T(n \to o)\)</span> is the
principle of detailed balance. It states that in a system at
equilibrium, the probability of being in an old state (<span
class="math inline">\(o\)</span>) and transitioning to a new state
(<span class="math inline">\(n\)</span>) is equal to the probability of
being in the new state and transitioning back to the old one. This
condition is crucial because it ensures that the simulation will
eventually sample states according to their correct thermodynamic
probabilities (the Boltzmann distribution). 方程 <span
class="math inline">\(P_o T(o \to n) = P_n T(n \to o)\)</span>
是详细平衡的原理。它指出，在平衡系统中，处于旧状态 (<span
class="math inline">\(o\)</span>) 并转变为新状态 (<span
class="math inline">\(n\)</span>)
的概率等于处于新状态并转变回旧状态的概率。此条件至关​​重要，因为它确保模拟最终将根据正确的热力学概率（玻尔兹曼分布）对状态进行采样。</li>
<li><strong>Acceptance Rate:</strong> The note <code>\sim 30\%?</code>
likely refers to the target <strong>acceptance rate</strong> for an
efficient Metropolis MC simulation. If new states are accepted too often
or too rarely, the exploration of the system’s possible configurations
is inefficient. While the famous optimal acceptance rate for certain
high-dimensional problems is around 23.4%, a range of 20-50% is often
considered effective. 注释“30%？”指的是高效 Metropolis
蒙特卡罗模拟的目标<strong>接受率</strong>。如果新状态接受过于频繁或过于稀少，系统对可能配置的探索就会变得低效。虽然某些高维问题的最佳接受率约为
23.4%，但通常认为 20-50% 的范围是有效的。</li>
</ul>
<h3 id="hamiltonian-hybrid-monte-carlo-hmc">2. Hamiltonian / Hybrid
Monte Carlo (HMC)</h3>
<p>The second topic, “Hamiltonian/Hybrid MC (HMC),” is a more advanced
Monte Carlo method that uses principles from classical mechanics to
propose new states more intelligently than the simple random-walk
approach of the standard Metropolis method. This often leads to a much
higher acceptance rate and more efficient exploration of the state
space. 第二个主题“哈密顿/混合蒙特卡罗
(HMC)”是一种更先进的蒙特卡罗方法，它利用经典力学原理，比标准 Metropolis
方法中简单的随机游走方法更智能地提出新状态。这通常会带来更高的接受率和更高效的状态空间探索。</p>
<p>The whiteboard outlines a four-step HMC algorithm:</p>
<p><strong>Step 1: Randomize Velocities</strong> The first step is to
randomize the velocities: <span class="math inline">\(\vec{v}_i \sim
\mathcal{N}(0, k_B T)\)</span>. 第一步是随机化速度：<span
class="math inline">\(\vec{v}_i \sim \mathcal{N}(0, k_B T)\)</span>。 *
This step introduces momentum into the system. For each particle <span
class="math inline">\(i\)</span>, a velocity vector <span
class="math inline">\(\vec{v}_i\)</span> is randomly drawn from a normal
(Gaussian) distribution with a mean of 0 and a variance related to the
temperature <span class="math inline">\(T\)</span> and the Boltzmann
constant <span class="math inline">\(k_B\)</span>.
此步骤将动量引入系统。对于每个粒子 <span
class="math inline">\(i\)</span>，速度矢量 <span
class="math inline">\(\vec{v}_i\)</span>
会随机地从正态（高斯）分布中抽取，该分布的均值为 0，方差与温度 <span
class="math inline">\(T\)</span> 和玻尔兹曼常数 <span
class="math inline">\(k_B\)</span> 相关。 * The full formula for this
probability distribution, <span
class="math inline">\(f(\vec{v})\)</span>, is the
<strong>Maxwell-Boltzmann distribution</strong>, which is written out
further down the board. 该概率分布的完整公式 <span
class="math inline">\(f(\vec{v})\)</span>
是<strong>麦克斯韦-玻尔兹曼分布</strong>。</p>
<p><strong>Step 2: Molecular Dynamics (MD) Integration</strong> The
board notes this as <code>t=0 \to h \text&#123; or &#125; mh</code>
<code>MD</code> and mentions the <code>Verlet</code> algorithm.</p>
<ul>
<li>This is the “Hamiltonian dynamics” part of the algorithm. Starting
from the current positions and the newly randomized velocities, the
system’s trajectory is calculated for a short period of time (<span
class="math inline">\(h\)</span> or <span
class="math inline">\(mh\)</span>) using Molecular Dynamics (MD).
这是算法的“哈密顿动力学”部分。从当前位置和新随机化的速度开始，使用分子动力学
(MD) 计算系统在短时间内（<span class="math inline">\(h\)</span> 或 <span
class="math inline">\(mh\)</span>）的轨迹。</li>
<li>The name <strong>Verlet</strong> refers to the Verlet integration
algorithm, a numerical method used to solve Newton’s equations of
motion. It is popular in MD simulations because it is time-reversible
and conserves energy well over long simulations. 指的是 Verlet
积分算法，这是一种用于求解牛顿运动方程的数值方法。它在 MD
模拟中很受欢迎，因为它具有时间可逆性，并且在长时间模拟中能量守恒效果良好。</li>
</ul>
<p><strong>Step 3: Calculate Total Energy</strong> The third step is to
<code>calculate total energy</code>: <span class="math inline">\(E_n =
K_n + V_n\)</span>. 第三步是“计算总能量”：<span
class="math inline">\(E_n = K_n + V_n\)</span>。 * After the MD
trajectory, the system is in a new state <span
class="math inline">\(n\)</span>. The total energy of this new state,
<span class="math inline">\(E_n\)</span>, is calculated as the sum of
its kinetic energy (<span class="math inline">\(K_n\)</span>, from the
velocities) and its potential energy (<span
class="math inline">\(V_n\)</span>, from the positions). MD
轨迹之后，系统处于新状态 <span
class="math inline">\(n\)</span>。新状态的总能量 <span
class="math inline">\(E_n\)</span> 等于其动能 (<span
class="math inline">\(K_n\)</span>，由速度计算得出）和势能 (<span
class="math inline">\(V_n\)</span>，由位置计算得出)之和。</p>
<p><strong>Step 4: Acceptance Test</strong> The final step is the
acceptance criterion: <span class="math inline">\(\text{acc}(o \to n) =
\min(1, e^{-\beta(E_n - E_o)})\)</span>. 最后一步是验收标准：<span
class="math inline">\(\text{acc}(o \to n) = \min(1, e^{-\beta(E_n -
E_o)})\)</span>。 * This is the Metropolis acceptance criterion. The
algorithm decides whether to accept the new state <span
class="math inline">\(n\)</span> or reject it and stay in the old state
<span class="math inline">\(o\)</span>. 这是 Metropolis
验收标准。算法决定是接受新状态 <span class="math inline">\(n\)</span>
还是拒绝它并保持旧状态 <span class="math inline">\(o\)</span>。 * The
probability of acceptance depends on the change in total energy (<span
class="math inline">\(E_n - E_o\)</span>). If the new energy is lower,
the move is always accepted. If the new energy is higher, it might still
be accepted with a probability <span class="math inline">\(e^{-\beta(E_n
- E_o)}\)</span>, where <span class="math inline">\(\beta = 1/(k_B
T)\)</span>. This allows the system to escape from local energy minima.
验收概率取决于总能量的变化 (<span class="math inline">\(E_n -
E_o\)</span>)。如果新能量较低，则始终接受该移动。如果新的能量更高，它仍然可能以概率
<span class="math inline">\(e^{-\beta(E_n - E_o)}\)</span> 被接受，其中
<span class="math inline">\(\beta = 1/(k_B
T)\)</span>。这使得系统能够摆脱局部能量最小值。</p>
<h3 id="key-formulas-and-notations">Key Formulas and Notations</h3>
<ul>
<li><p><strong>Maxwell-Boltzmann
Distribution麦克斯韦-玻尔兹曼分布:</strong> The formula for the velocity
distribution is given as: <span class="math inline">\(f(\vec{v}) =
\left(\frac{m}{2\pi k_B T}\right)^{3/2} \exp\left(-\frac{m v^2}{2 k_B
T}\right)\)</span> This gives the probability density for a particle of
mass <span class="math inline">\(m\)</span> to have a velocity <span
class="math inline">\(\vec{v}\)</span> at a given temperature <span
class="math inline">\(T\)</span>.质量为 <span
class="math inline">\(m\)</span> 的粒子速度为 的概率密度</p></li>
<li><p><strong>Energy Conservation and Acceptance Rate:</strong> The
notes <span class="math inline">\(E_n \approx E_o\)</span> and <span
class="math inline">\(75\%\)</span> highlight a key advantage of HMC.
Because the Verlet integrator approximately conserves energy, the final
energy <span class="math inline">\(E_n\)</span> after the MD trajectory
is usually very close to the initial energy <span
class="math inline">\(E_o\)</span>. This means the term <span
class="math inline">\((E_n - E_o)\)</span> is small, and the acceptance
probability is high. The <span class="math inline">\(75\%\)</span>
indicates a typical or target acceptance rate for HMC, which is
significantly higher than for standard Metropolis MC. 注释 <span
class="math inline">\(E_n \approx E_o\)</span> 和 <span
class="math inline">\(75\%\)</span> 凸显了 HMC 的一个关键优势。由于
Verlet 积分器近似地守恒能量，MD 轨迹后的最终能量 <span
class="math inline">\(E_n\)</span> 通常非常接近初始能量 <span
class="math inline">\(E_o\)</span>。这意味着 <span
class="math inline">\((E_n - E_o)\)</span> 项很小，接受概率很高。<span
class="math inline">\(75\%\)</span> 表示 HMC
的典型或目标接受率，明显高于标准 Metropolis MC。</p></li>
<li><p><strong>Hamiltonian Operator:</strong> The symbol <span
class="math inline">\(\hat{H}\)</span> written on the adjacent board
represents the Hamiltonian operator, which gives the total energy of the
system. The note <code>Δ Adiabatic</code> suggests that the MD evolution
is ideally an adiabatic process (no heat exchange), during which the
total energy (the Hamiltonian) is conserved. 相邻板上的符号 <span
class="math inline">\(\hat{H}\)</span>
代表哈密顿算符，它给出了系统的总能量。注释“Δ Adiabatic”表明 MD
演化在理想情况下是一个绝热过程（无热交换），在此过程中总能量（哈密顿量）守恒。</p></li>
</ul>
<p>This whiteboard displays the fundamental equation of quantum
chemistry: the time-dependent Schrödinger equation, along with the
detailed breakdown of the molecular Hamiltonian operator. This equation
is the starting point for almost all <em>ab initio</em>
(first-principles) quantum mechanical calculations of molecular systems.
这块白板展示了量子化学的基本方程：含时薛定谔方程，以及分子哈密顿算符的详细分解。该方程是几乎所有分子系统<em>从头算</em>（第一性原理）量子力学计算的起点。</p>
<h3 id="the-time-dependent-schrödinger-equation">3. The Time-Dependent
Schrödinger Equation</h3>
<p>At the top of the board, the fundamental equation governing the
evolution of a quantum mechanical system is presented:
白板顶部显示了控制量子力学系统演化的基本方程： <span
class="math inline">\(i\hbar \frac{\partial \Psi}{\partial t} =
\hat{\mathcal{H}} \Psi\)</span></p>
<ul>
<li><p><strong><span class="math inline">\(\Psi\)</span> (Psi)</strong>
is the <strong>wave function</strong> of the system. It contains all the
information that can be known about the system (e.g., the positions and
momenta of all particles).
是系统的<strong>波函数</strong>。它包含了关于系统的所有已知信息（例如，所有粒子的位置和动量）。</p></li>
<li><p><strong><span
class="math inline">\(\hat{\mathcal{H}}\)</span></strong> is the
<strong>Hamiltonian operator</strong>, which represents the total energy
of the system.
是<strong>哈密顿算符</strong>，表示系统的总能量。</p></li>
<li><p><strong><span class="math inline">\(i\)</span></strong>
是虚数单位。</p></li>
<li><p><strong><span class="math inline">\(i\)</span></strong> is the
imaginary unit.</p></li>
<li><p><strong><span class="math inline">\(\hbar\)</span></strong> is
the <strong>reduced Planck
constant</strong>.是<strong>约化普朗克常数</strong>。</p></li>
<li><p><strong><span class="math inline">\(\frac{\partial \Psi}{\partial
t}\)</span></strong> represents how the wave function changes over
time.表示波函数随时间的变化。</p></li>
</ul>
<p>This equation states that the time evolution of the quantum state is
dictated by the system’s total energy operator, the Hamiltonian. The
note “Δ Adiabatic process” likely connects to the context of the
Born-Oppenheimer approximation, where the electronic Schrödinger
equation is solved for fixed nuclear positions, assuming the electrons
adjust adiabatically (instantaneously) to the motion of the nuclei.
该方程表明，量子态的时间演化由系统的总能量算符——哈密顿算符决定。注释“Δ绝热过程”与玻恩-奥本海默近似相关，在该近似中，电子薛定谔方程是针对固定原子核位置求解的，假设电子以绝热方式（瞬时）调整以适应原子核的运动。</p>
<h3 id="the-full-molecular-hamiltonian-hatmathcalh">4. The Full
Molecular Hamiltonian (<span
class="math inline">\(\hat{\mathcal{H}}\)</span>)</h3>
<p>The main part of the whiteboard is the detailed expression for the
non-relativistic, time-independent molecular Hamiltonian. It is the sum
of the kinetic and potential energies of all the nuclei and electrons in
the system. The equation can be broken down into five distinct terms:
白板的主要部分是非相对论性、时间无关的分子哈密顿量的详细表达式。它是系统中所有原子核和电子的动能和势能之和。</p>
<p>该方程可以分解为五个不同的项：</p>
<p><span class="math inline">\(\hat{\mathcal{H}} = -\sum_{I=1}^{P}
\frac{\hbar^2}{2M_I}\nabla_I^2 - \sum_{i=1}^{N}
\frac{\hbar^2}{2m}\nabla_i^2 + \frac{e^2}{2}\sum_{I=1}^{P}\sum_{J \neq
I}^{P} \frac{Z_I Z_J}{|\vec{R}_I - \vec{R}_J|} +
\frac{e^2}{2}\sum_{i=1}^{N}\sum_{j \neq i}^{N} \frac{1}{|\vec{r}_i -
\vec{r}_j|} - e^2\sum_{I=1}^{P}\sum_{i=1}^{N} \frac{Z_I}{|\vec{R}_I -
\vec{r}_i|}\)</span></p>
<p>Let’s analyze each component:</p>
<p><strong>A. Kinetic Energy Terms 动能项</strong></p>
<ol type="1">
<li><strong>Kinetic Energy of the Nuclei 原子核的动能:</strong> <span
class="math inline">\(-\sum_{I=1}^{P}
\frac{\hbar^2}{2M_I}\nabla_I^2\)</span> This term is the sum of the
kinetic energy operators for all the nuclei in the
system.此项是系统中所有原子核的动能算符之和。
<ul>
<li>The sum is over all nuclei, indexed by <span
class="math inline">\(I\)</span> from 1 to <span
class="math inline">\(P\)</span>.该和涵盖所有原子核，索引为 <span
class="math inline">\(I\)</span>，从 1 到 <span
class="math inline">\(P\)</span>。</li>
<li><span class="math inline">\(M_I\)</span> is the mass of nucleus
<span class="math inline">\(I\)</span>.是原子核 <span
class="math inline">\(I\)</span> 的质量。</li>
<li><span class="math inline">\(\nabla_I^2\)</span> is the Laplacian
operator, which involves the second spatial derivatives with respect to
the coordinates of nucleus <span
class="math inline">\(I\)</span>.是拉普拉斯算符，它涉及原子核 <span
class="math inline">\(I\)</span> 坐标的二阶空间导数。</li>
</ul></li>
<li><strong>Kinetic Energy of the Electrons 电子的动能:</strong> <span
class="math inline">\(-\sum_{i=1}^{N}
\frac{\hbar^2}{2m}\nabla_i^2\)</span> This is the corresponding sum of
the kinetic energy operators for all the
electrons.这是所有电子的动能算符的对应和。
<ul>
<li>The sum is over all electrons, indexed by <span
class="math inline">\(i\)</span> from 1 to <span
class="math inline">\(N\)</span>.该和是针对所有电子的，索引为 <span
class="math inline">\(i\)</span>，从 1 到 <span
class="math inline">\(N\)</span>。</li>
<li><span class="math inline">\(m\)</span> is the mass of an
electron.是电子的质量。</li>
<li><span class="math inline">\(\nabla_i^2\)</span> is the Laplacian
operator with respect to the coordinates of electron <span
class="math inline">\(i\)</span>.是关于电子 <span
class="math inline">\(i\)</span> 坐标的拉普拉斯算符。</li>
</ul></li>
</ol>
<p><strong>B. Potential Energy Terms (Electrostatic Interactions)
势能项（静电相互作用）</strong></p>
<ol start="3" type="1">
<li><strong>Nuclear-Nuclear Repulsion 核间排斥力:</strong> <span
class="math inline">\(+\frac{e^2}{2}\sum_{I=1}^{P}\sum_{J \neq I}^{P}
\frac{Z_I Z_J}{|\vec{R}_I - \vec{R}_J|}\)</span> This term represents
the potential energy from the electrostatic (Coulomb) repulsion between
all pairs of positively charged
nuclei.该项表示所有带正电原子核对之间静电（库仑）排斥力产生的势能。
<ul>
<li>The double summation runs over all unique pairs of nuclei (<span
class="math inline">\(I, J\)</span>).对所有唯一的原子核对 (<span
class="math inline">\(I, J\)</span>) 进行双重求和。</li>
<li><span class="math inline">\(Z_I\)</span> is the atomic number (i.e.,
the charge) of nucleus <span class="math inline">\(I\)</span>.是原子核
<span class="math inline">\(I\)</span> 的原子序数（即电荷）。</li>
<li><span class="math inline">\(\vec{R}_I\)</span> is the position
vector of nucleus <span class="math inline">\(I\)</span>.是原子核 <span
class="math inline">\(I\)</span> 的位置矢量。</li>
<li><span class="math inline">\(e\)</span> is the elementary
charge.是基本电荷。</li>
</ul></li>
<li><strong>Electron-Electron Repulsion 电子间排斥力:</strong> <span
class="math inline">\(+\frac{e^2}{2}\sum_{i=1}^{N}\sum_{j \neq i}^{N}
\frac{1}{|\vec{r}_i - \vec{r}_j|}\)</span> This term represents the
potential energy from the electrostatic repulsion between all pairs of
negatively charged
electrons.该项表示所有带负电的电子对之间静电排斥的势能。
<ul>
<li>The double summation runs over all unique pairs of electrons (<span
class="math inline">\(i, j\)</span>).对所有不同的电子对 (<span
class="math inline">\(i, j\)</span>) 进行双重求和。</li>
<li><span class="math inline">\(\vec{r}_i\)</span> is the position
vector of electron <span class="math inline">\(i\)</span>.是电子 <span
class="math inline">\(i\)</span> 的位置矢量。</li>
</ul></li>
<li><strong>Nuclear-Electron Attraction 核-电子引力:</strong> <span
class="math inline">\(-e^2\sum_{I=1}^{P}\sum_{i=1}^{N}
\frac{Z_I}{|\vec{R}_I - \vec{r}_i|}\)</span> This final term represents
the potential energy from the electrostatic attraction between the
nuclei and the electrons.这最后一项表示原子核和电子之间静电引力的势能。
<ul>
<li>The summation runs over all nuclei and all
electrons.该求和适用于所有原子核和所有电子。</li>
</ul></li>
</ol>
<h3 id="notations-and-conventions">5. Notations and Conventions</h3>
<ul>
<li><strong>Atomic Units:</strong> The note <span
class="math inline">\(\frac{1}{4\pi\epsilon_0} = k = 1\)</span> is a key
indicator of the convention being used. This sets the Coulomb constant
to 1, which is a hallmark of <strong>Hartree atomic units</strong>. In
this system, the elementary charge (<span
class="math inline">\(e\)</span>), electron mass (<span
class="math inline">\(m\)</span>), and reduced Planck constant (<span
class="math inline">\(\hbar\)</span>) are also set to 1. This simplifies
the Hamiltonian significantly, removing the physical constants and
making the equations easier to work with computationally.
是所用约定的关键指标。这将库仑常数设置为 1，这是<strong>Hartree
原子单位</strong>的标志。在这个系统中，基本电荷 (<span
class="math inline">\(e\)</span>)、电子质量 (<span
class="math inline">\(m\)</span>) 和​​约化普朗克常数 (<span
class="math inline">\(\hbar\)</span>) 也设为
1。这显著简化了哈密顿量，消除了物理常数，使方程更易于计算。</li>
<li><strong>Interaction Terms:</strong> The notations <span
class="math inline">\(\{i, j\}\)</span>, <span
class="math inline">\(\{i, j, k\}\)</span>, etc., refer to the
“many-body” problem. The Hamiltonian contains two-body terms
(interactions between pairs of particles), and solving the Schrödinger
equation exactly is extremely difficult because the motion of every
particle is correlated with every other particle. Computational methods
are designed to approximate these interactions. 符号 <span
class="math inline">\(\{i, j\}\)</span>、<span
class="math inline">\(\{i, j, k\}\)</span>
等指的是“多体”问题。哈密顿量包含二体项（粒子对之间的相互作用），而精确求解薛定谔方程极其困难，因为每个粒子的运动都与其他粒子相关。计算方法旨在近似这些相互作用。</li>
</ul>
<p>This whiteboard presents the mathematical foundation for
<strong>non-adiabatic molecular dynamics</strong>, a sophisticated
method in theoretical chemistry and physics used to simulate processes
where the Born-Oppenheimer approximation breaks down. This typically
occurs in photochemistry, electron transfer reactions, and when
molecules interact with intense laser fields.
这块白板展示了<strong>非绝热分子动力学</strong>的数学基础，这是理论化学和物理学中一种复杂的方法，用于模拟玻恩-奥本海默近似失效的过程。这通常发生在光化学、电子转移反应以及分子与强激光场相互作用时。</p>
<h3
id="topic-non-adiabatic-molecular-dynamics-md-非绝热分子动力学-md">6.
Topic: Non-Adiabatic Molecular Dynamics (MD) 非绝热分子动力学 (MD)</h3>
<p>The title “Δ non-adiabatic MD” indicates that the topic moves beyond
the standard Born-Oppenheimer approximation. In this approximation, it
is assumed that the light electrons adjust instantaneously to the motion
of the heavy nuclei, allowing the system to be described by a single
potential energy surface. Non-adiabatic methods, by contrast, account
for the quantum mechanical coupling between multiple electronic
states.</p>
<p>标题“Δ 非绝热
MD”表明该主题超越了标准的玻恩-奥本海默近似。在该近似中，假设轻电子会根据重原子核的运动进行瞬时调整，从而使系统可以用单个势能面来描述。相比之下，非绝热方法则考虑了多个电子态之间的量子力学耦合。</p>
<h3 id="the-born-huang-ansatz-玻恩-黄拟设">7. The Born-Huang Ansatz
玻恩-黄拟设</h3>
<p>The starting point for this method is the “ansatz” (an educated guess
for the form of the solution). This is the Born-Huang expansion for the
total molecular wave function, <span
class="math inline">\(\Psi\)</span>.
该方法的起点是“拟设”（对解形式的合理猜测）。这是分子总波函数 <span
class="math inline">\(\Psi\)</span> 的玻恩-黄展开式。</p>
<p><span class="math inline">\(\Psi(\vec{R}, \vec{r}, t) = \sum_{n}
\Theta_n(\vec{R}, t) \Phi_n(\vec{R}, \vec{r})\)</span></p>
<ul>
<li><p><strong><span class="math inline">\(\Psi(\vec{R}, \vec{r},
t)\)</span></strong> is the total wave function for the entire molecule.
It depends on the coordinates of all nuclei (<span
class="math inline">\(\vec{R}\)</span>), all electrons (<span
class="math inline">\(\vec{r}\)</span>), and time (<span
class="math inline">\(t\)</span>).
是整个分子的总波函数。它取决于所有原子核 (<span
class="math inline">\(\vec{R}\)</span>)、所有电子 (<span
class="math inline">\(\vec{r}\)</span>) 和时间 (<span
class="math inline">\(t\)</span>) 的坐标。</p></li>
<li><p><strong><span class="math inline">\(\Phi_n(\vec{R},
\vec{r})\)</span></strong> are the <strong>electronic wave
functions</strong>. They are the solutions to the electronic Schrödinger
equation for a fixed nuclear geometry <span
class="math inline">\(\vec{R}\)</span> and form a complete basis set.
The index <span class="math inline">\(n\)</span> labels the electronic
state (e.g., ground state, first excited state, etc.).
它们是给定原子核几何构型 <span class="math inline">\(\vec{R}\)</span>
的电子薛定谔方程的解，并构成一个完整的基组。下标 <span
class="math inline">\(n\)</span>
标记电子态（例如，基态、第一激发态等）。</p></li>
<li><p><strong><span class="math inline">\(\Theta_n(\vec{R},
t)\)</span></strong> are the <strong>nuclear wave functions</strong>.
Each <span class="math inline">\(\Theta_n\)</span> describes the motion
of the nuclei on the potential energy surface of the corresponding
electronic state, <span class="math inline">\(\Phi_n\)</span>.
Crucially, they depend on time. 是<strong>核波函数</strong>。每个 <span
class="math inline">\(\Theta_n\)</span> 描述原子核在相应电子态 <span
class="math inline">\(\Phi_n\)</span>
势能面上的运动。至关重要的是，它们依赖于时间。</p></li>
</ul>
<p>This ansatz expresses the total molecular state as a superposition of
electronic states, where the coefficients of the superposition are the
nuclear wave functions.
该拟设将总分子态表示为电子态的叠加，其中叠加的系数是核波函数。</p>
<h3 id="the-partitioned-molecular-hamiltonian-分割分子哈密顿量">8. The
Partitioned Molecular Hamiltonian 分割分子哈密顿量</h3>
<p>The total molecular Hamiltonian, <span
class="math inline">\(\hat{\mathcal{H}}\)</span>, is partitioned into
terms that act on the nuclei and electrons separately. 总分子哈密顿量
<span class="math inline">\(\hat{\mathcal{H}}\)</span>
被分割成分别作用于原子核和电子的项。</p>
<p><span class="math inline">\(\hat{\mathcal{H}} = -\sum_{I}
\frac{\hbar^2}{2M_I}\nabla_I^2 + \hat{\mathcal{H}}_e +
\hat{V}_{nn}\)</span></p>
<ul>
<li><p><strong><span class="math inline">\(-\sum_{I}
\frac{\hbar^2}{2M_I}\nabla_I^2\)</span></strong>: This is the kinetic
energy operator for the nuclei, often denoted as <span
class="math inline">\(\hat{T}_n\)</span>.这是原子核的动能算符，通常表示为
<span class="math inline">\(\hat{T}_n\)</span>。</p></li>
<li><p><strong><span
class="math inline">\(\hat{\mathcal{H}}_e\)</span></strong>: This is the
<strong>electronic Hamiltonian</strong>, which includes the kinetic
energy of the electrons and the potential energy of electron-electron
and electron-nuclear interactions.
这是<strong>电子哈密顿量</strong>，包含电子的动能以及电子-电子和电子-核相互作用的势能。</p></li>
<li><p><strong><span
class="math inline">\(\hat{V}_{nn}\)</span></strong>: This is the
potential energy operator for <strong>nuclear-nuclear
repulsion</strong>.这是<strong>核-核排斥</strong>的势能算符。</p></li>
</ul>
<h3 id="the-electronic-schrödinger-equation-电子薛定谔方程">9. The
Electronic Schrödinger Equation 电子薛定谔方程</h3>
<p>The electronic basis functions, <span
class="math inline">\(\Phi_n\)</span>, are defined as the eigenfunctions
of the electronic Hamiltonian (plus the nuclear repulsion term) for a
fixed nuclear configuration <span
class="math inline">\(\vec{R}\)</span>. 电子基函数 <span
class="math inline">\(\Phi_n\)</span> 定义为对于固定的核构型 <span
class="math inline">\(\vec{R}\)</span>，电子哈密顿量（加上核排斥项）的本征函数。</p>
<p><span class="math inline">\((\hat{\mathcal{H}}_e + \hat{V}_{nn})
\Phi_n(\vec{R}, \vec{r}) = E_n(\vec{R}) \Phi_n(\vec{R},
\vec{r})\)</span></p>
<ul>
<li><strong><span class="math inline">\(E_n(\vec{R})\)</span></strong>
are the eigenvalues, which are the <strong>potential energy surfaces
(PES)</strong>. Each electronic state <span
class="math inline">\(n\)</span> has its own PES, which dictates the
forces acting on the nuclei when the molecule is in that electronic
state. 是特征值，即<strong>势能面 (PES)</strong>。每个电子态 <span
class="math inline">\(n\)</span>
都有其自身的势能面，它决定了分子处于该电子态时作用于原子核的力。</li>
</ul>
<h3
id="deriving-the-equations-of-motion-for-the-nuclei-推导原子核运动方程">10.
Deriving the Equations of Motion for the Nuclei 推导原子核运动方程</h3>
<p>The final part of the whiteboard begins the derivation of the
time-dependent Schrödinger equation for the nuclear wave functions,
<span class="math inline">\(\Theta_k\)</span>. The process starts with
the full time-dependent Schrödinger equation, <span
class="math inline">\(i\hbar \frac{\partial \Psi}{\partial t} =
\hat{\mathcal{H}} \Psi\)</span>. To find the equation for a specific
nuclear wave function <span class="math inline">\(\Theta_k\)</span>,
this main equation is projected onto the corresponding electronic basis
state <span class="math inline">\(\Phi_k\)</span>.
白板的最后一部分开始推导原子核波函数 <span
class="math inline">\(\Theta_k\)</span>
的含时薛定谔方程。该过程从完整的含时薛定谔方程 <span
class="math inline">\(i\hbar \frac{\partial \Psi}{\partial t} =
\hat{\mathcal{H}} \Psi\)</span> 开始。为了找到特定原子核波函数 <span
class="math inline">\(\Theta_k\)</span>
的方程，需要将这个主方程投影到相应的电子基态 <span
class="math inline">\(\Phi_k\)</span> 上。</p>
<p>This is done by multiplying from the left by the complex conjugate of
the electronic wave function, <span
class="math inline">\(\Phi_k^*\)</span>, and integrating over all
electronic coordinates, <span class="math inline">\(d\vec{r}\)</span>.
可以通过从左边乘以电子波函数 <span
class="math inline">\(\Phi_k^*\)</span> 的复共轭，然后在所有电子坐标
<span class="math inline">\(d\vec{r}\)</span> 上积分来实现。</p>
<p><span class="math inline">\(\int \Phi_k^* i\hbar
\frac{\partial}{\partial t} \Psi \,d\vec{r} = \int \Phi_k^*
\hat{\mathcal{H}} \Psi \,d\vec{r}\)</span></p>
<p>The board then shows the result of substituting the Born-Huang ansatz
for <span class="math inline">\(\Psi\)</span> and the partitioned
Hamiltonian for <span class="math inline">\(\hat{\mathcal{H}}\)</span>
into this projected equation: 然后，黑板显示将 Born-Huang 拟设式代入
<span
class="math inline">\(\Psi\)</span>，将分块哈密顿量代入以下投影方程的结果：</p>
<p><span class="math inline">\(i\hbar \frac{\partial}{\partial t}
\Theta_k(\vec{R}, t) = \int \Phi_k^* \left( -\sum_{I}
\frac{\hbar^2}{2M_I}\nabla_I^2 + \hat{\mathcal{H}}_e + \hat{V}_{nn}
\right) \sum_n \Theta_n \Phi_n \,d\vec{r}\)</span></p>
<ul>
<li><p><strong>Left Hand Side</strong>: The left side of the projection
has been simplified. Because the electronic basis functions <span
class="math inline">\(\Phi_n\)</span> form an orthonormal set (<span
class="math inline">\(\int \Phi_k^* \Phi_n d\vec{r} =
\delta_{kn}\)</span>), the sum collapses to a single term for <span
class="math inline">\(n=k\)</span>. 投影左侧已简化。由于电子基函数 <span
class="math inline">\(\Phi_n\)</span> 构成一个正交集 (<span
class="math inline">\(\int \Phi_k^* \Phi_n d\vec{r} =
\delta_{kn}\)</span>，因此当 <span class="math inline">\(n=k\)</span>
时，和将折叠为一个项。</p></li>
<li><p><strong>Right Hand Side</strong>: This complex integral is the
core of non-adiabatic dynamics. When the nuclear kinetic energy
operator, <span class="math inline">\(\nabla_I^2\)</span>, acts on the
product <span class="math inline">\(\Theta_n \Phi_n\)</span>, it acts on
both functions (via the product rule). The terms that arise from <span
class="math inline">\(\nabla_I\)</span> acting on the electronic wave
functions <span class="math inline">\(\Phi_n\)</span> are known as
<strong>non-adiabatic coupling terms</strong>. These terms are
responsible for enabling transitions between different electronic
potential energy surfaces, which is the essence of non-adiabatic
dynamics. 这个复积分是非绝热动力学的核心。当核动能算符 <span
class="math inline">\(\nabla_I^2\)</span> 作用于乘积 <span
class="math inline">\(\Theta_n \Phi_n\)</span>
时，它会作用于这两个函数（通过乘积规则）。由 <span
class="math inline">\(\nabla_I\)</span> 作用于电子波函数 <span
class="math inline">\(\Phi_n\)</span>
而产生的项称为<strong>非绝热耦合项</strong>。这些术语负责实现不同电子势能面之间的转变，这是非绝热动力学的本质。</p></li>
</ul>
<p>This whiteboard continues the mathematical derivation for
non-adiabatic molecular dynamics started in the previous image. It
focuses on expanding the nuclear kinetic energy term to reveal the
crucial couplings between different electronic
states.这块白板延续了上一张图片中非绝热分子动力学的数学推导。它着重于扩展核动能项，以揭示不同电子态之间的关键耦合。</p>
<h3
id="starting-point-the-projected-schrödinger-equation-起点投影薛定谔方程">11.
Starting Point: The Projected Schrödinger Equation
起点：投影薛定谔方程</h3>
<p>The derivation picks up from the equation for the time evolution of
the nuclear wave function, <span
class="math inline">\(\Theta_k\)</span>. The right-hand side of this
equation is being evaluated. 推导过程取自核波函数 <span
class="math inline">\(\Theta_k\)</span>
的时间演化方程。该方程的右边正在求值。</p>
<p><span class="math inline">\(= \int \Phi_k^* \left( -\sum_{I}
\frac{\hbar^2}{2M_I}\nabla_I^2 \right) \sum_n \Theta_n \Phi_n \,d\vec{r}
+ E_k \Theta_k\)</span></p>
<p>This equation separates the total energy into two parts
该方程将总能量分为两部分 : * The first term is the contribution from the
<strong>nuclear kinetic energy operator</strong>, <span
class="math inline">\(-\sum_{I} \frac{\hbar^2}{2M_I}\nabla_I^2\)</span>.
第一项是<strong>核动能算符</strong>的贡献 * The second term, <span
class="math inline">\(E_k \Theta_k\)</span>, is the contribution from
the <strong>potential energy</strong>. This term arises from the action
of the electronic Hamiltonian part <span
class="math inline">\((\hat{\mathcal{H}}_e + \hat{V}_{nn})\)</span> on
the basis functions. Due to the orthonormality of the electronic
wavefunctions (<span class="math inline">\(\int \Phi_k^* \Phi_n
\,d\vec{r} = \delta_{kn}\)</span>), the sum over <span
class="math inline">\(n\)</span> collapses to a single term for the
potential energy. 第二项，<span class="math inline">\(E_k
\Theta_k\)</span>，是<strong>势能</strong>的贡献。这一项源于电子哈密顿量部分
<span class="math inline">\((\hat{\mathcal{H}}_e +
\hat{V}_{nn})\)</span> 对基函数的作用。由于电子波函数（<span
class="math inline">\(\int \Phi_k^* \Phi_n \,d\vec{r} =
\delta_{kn}\)</span>）的正交性，<span
class="math inline">\(n\)</span>项的和会坍缩为势能的一项。</p>
<p>The challenge, and the core of the physics, lies in evaluating the
first term, as the nuclear derivative <span
class="math inline">\(\nabla_I\)</span> acts on <em>both</em> the
nuclear wave function <span class="math inline">\(\Theta_n\)</span> and
the electronic wave function <span
class="math inline">\(\Phi_n\)</span>.
难点在于，也是物理的核心在于如何计算第一项，因为核导数 <span
class="math inline">\(\nabla_I\)</span> 同时作用于核波函数 <span
class="math inline">\(\Theta_n\)</span> 和电子波函数 <span
class="math inline">\(\Phi_n\)</span>。</p>
<h3
id="applying-the-product-rule-for-the-laplacian-应用拉普拉斯算子的乘积规则">12.
Applying the Product Rule for the Laplacian
应用拉普拉斯算子的乘积规则</h3>
<p>To expand the kinetic energy term, the product rule for the Laplacian
operator acting on two functions (A and B) is used. The board writes
this rule as: 为了展开动能项，我们利用了拉普拉斯算子作用于两个函数（A 和
B）的乘积规则。棋盘上将这条规则写成： <span
class="math inline">\(\nabla^2(AB) = (\nabla^2 A)B + 2(\nabla
A)\cdot(\nabla B) + A(\nabla^2 B)\)</span></p>
<p>In our case, <span class="math inline">\(A = \Theta_n(\vec{R},
t)\)</span> and <span class="math inline">\(B = \Phi_n(\vec{R},
\vec{r})\)</span>. The derivative <span
class="math inline">\(\nabla_I\)</span> is with respect to the nuclear
coordinates <span class="math inline">\(\vec{R}_I\)</span>.
在我们的例子中，<span class="math inline">\(A = \Theta_n(\vec{R},
t)\)</span>，<span class="math inline">\(B = \Phi_n(\vec{R},
\vec{r})\)</span>。导数 <span class="math inline">\(\nabla_I\)</span>
是关于原子核坐标 <span class="math inline">\(\vec{R}_I\)</span> 的。</p>
<h3 id="expanding-the-kinetic-energy-term-展开动能项">13. Expanding the
Kinetic Energy Term 展开动能项</h3>
<p>Applying this rule, the integral containing the kinetic energy
operator is expanded: 应用此规则，展开包含动能算符的积分： <span
class="math inline">\(= -\sum_I \frac{\hbar^2}{2M_I} \int \Phi_k^*
\sum_n \left( (\nabla_I^2 \Theta_n)\Phi_n + 2(\nabla_I
\Theta_n)\cdot(\nabla_I \Phi_n) + \Theta_n(\nabla_I^2 \Phi_n) \right)
d\vec{r} + E_k \Theta_k\)</span></p>
<p>This step explicitly shows how the nuclear kinetic energy operator
gives rise to three distinct types of
terms.此步骤明确展示了核动能算符如何产生三种不同类型的项。</p>
<h3
id="final-result-and-identification-of-coupling-terms-最终结果及耦合项的识别">14.
Final Result and Identification of Coupling Terms
最终结果及耦合项的识别</h3>
<p>The final step is to take the integral over the electronic
coordinates (<span class="math inline">\(d\vec{r}\)</span>) and
rearrange the terms. The expression is simplified by again using the
orthonormality of the electronic wave functions, <span
class="math inline">\(\int \Phi_k^* \Phi_n \, d\vec{r} =
\delta_{kn}\)</span>. 最后一步是对电子坐标 (<span
class="math inline">\(d\vec{r}\)</span>)
进行积分，并重新排列各项。再次利用电子波函数的正交性简化表达式，<span
class="math inline">\(\int \Phi_k^* \Phi_n \, d\vec{r} =
\delta_{kn}\)</span>。</p>
<p><span class="math inline">\(= -\sum_I \frac{\hbar^2}{2M_I} \left(
\nabla_I^2 \Theta_k + \sum_n 2 \left( \int \Phi_k^* \nabla_I \Phi_n \,
d\vec{r} \right) \cdot \nabla_I \Theta_n + \sum_n \left( \int \Phi_k^*
\nabla_I^2 \Phi_n \, d\vec{r} \right) \Theta_n \right) + E_k
\Theta_k\)</span></p>
<p>This final equation is profound. It represents the time-independent
Schrödinger equation for the nuclear wave function <span
class="math inline">\(\Theta_k\)</span>, but it is coupled to all other
nuclear wave functions <span class="math inline">\(\Theta_n\)</span>.
Let’s break down the key terms within the parentheses:
最后一个方程意义深远。它代表了核波函数 <span
class="math inline">\(\Theta_k\)</span>
的与时间无关的薛定谔方程，但它与所有其他核波函数 <span
class="math inline">\(\Theta_n\)</span>
耦合。让我们分解一下括号内的关键项：</p>
<ul>
<li><p><strong><span class="math inline">\(\nabla_I^2
\Theta_k\)</span></strong>: This is the standard kinetic energy term for
the nuclei moving on the potential energy surface of state <span
class="math inline">\(k\)</span>. This is the only term that would
remain in the simple Born-Oppenheimer (adiabatic) approximation.
这是原子核在势能面 <span class="math inline">\(k\)</span>
上运动的标准动能项。这是在简单的
Born-Oppenheimer（绝热）近似中唯一保留的项。</p></li>
<li><p><strong><span class="math inline">\(\left( \int \Phi_k^* \nabla_I
\Phi_n \, d\vec{r} \right)\)</span></strong>: This is the
<strong>first-derivative non-adiabatic coupling term (NACT)</strong>,
often called the derivative coupling. This vector quantity determines
the strength of the coupling between electronic states <span
class="math inline">\(k\)</span> and <span
class="math inline">\(n\)</span> due to the velocity of the nuclei. It
is the primary term responsible for enabling transitions between
different potential energy surfaces. 这是<strong>一阶导数非绝热耦合项
(NACT)</strong>，通常称为导数耦合。该矢量决定了由于原子核速度而导致的电子态
<span class="math inline">\(k\)</span> 和 <span
class="math inline">\(n\)</span>
之间耦合的强度。它是实现不同势能面之间跃迁的主要项。</p></li>
<li><p><strong><span class="math inline">\(\left( \int \Phi_k^*
\nabla_I^2 \Phi_n \, d\vec{r} \right)\)</span></strong>: This is the
<strong>second-derivative non-adiabatic coupling term</strong>, a scalar
quantity. While often smaller than the first-derivative term, it is also
part of the complete description of non-adiabatic effects.
是<strong>二阶导数非绝热耦合项</strong>，一个标量。虽然它通常小于一阶导数项，但它也是非绝热效应完整描述的一部分。</p></li>
</ul>
<p>In summary, this derivation shows mathematically how the motion of
the nuclei (via the <span class="math inline">\(\nabla_I\)</span>
operator) can induce quantum mechanical transitions between different
electronic states (<span class="math inline">\(\Phi_k \leftrightarrow
\Phi_n\)</span>). The strength of these transitions is governed by the
non-adiabatic coupling terms, which depend on how the electronic wave
functions change as the nuclear geometry changes.
总之，该推导从数学上展示了原子核的运动（通过 <span
class="math inline">\(\nabla_I\)</span>
算符）如何诱导不同电子态之间的量子力学跃迁（<span
class="math inline">\(\Phi_k \leftrightarrow
\Phi_n\)</span>）。这些跃迁的强度由非绝热耦合项控制，而非绝热耦合项又取决于电子波函数如何随原子核几何结构的变化而变化。</p>
<p>This whiteboard concludes the derivation of the equations for
non-adiabatic molecular dynamics by defining the coupling operator and
then showing how different levels of approximation—specifically the
Born-Huang and the more restrictive Born-Oppenheimer
approximations—arise from neglecting certain coupling terms.
这块白板通过定义耦合算符，并展示不同程度的近似——特别是 Born-Huang
近似和更严格的 Born-Oppenheimer
近似——是如何通过忽略某些耦合项而产生的，从而推导出非绝热分子动力学方程的。</p>
<h3
id="definition-of-the-non-adiabatic-coupling-operator-非绝热耦合算符的定义">15.
Definition of the Non-Adiabatic Coupling Operator
非绝热耦合算符的定义</h3>
<p>The whiteboard begins by collecting all the non-adiabatic coupling
terms derived previously into a single operator, <span
class="math inline">\(C_{kn}\)</span>.
白板首先将之前推导的所有非绝热耦合项合并为一个算符 <span
class="math inline">\(C_{kn}\)</span>。</p>
<p>Let <span class="math inline">\(C_{kn} = -\sum_{I}
\frac{\hbar^2}{2M_I} \left( 2 \left( \int \Phi_k^* \nabla_I \Phi_n \,
d\vec{r} \right) \cdot \nabla_I + \left( \int \Phi_k^* \nabla_I^2 \Phi_n
\, d\vec{r} \right) \right)\)</span></p>
<ul>
<li>This operator, <span class="math inline">\(C_{kn}\)</span>,
represents the total effect of the coupling between electronic state
<span class="math inline">\(k\)</span> and electronic state <span
class="math inline">\(n\)</span>, which is induced by the kinetic energy
of the nuclei. 此算符 <span class="math inline">\(C_{kn}\)</span>
表示由原子核动能引起的电子态 <span class="math inline">\(k\)</span>
和电子态 <span class="math inline">\(n\)</span> 之间耦合的总效应。</li>
<li>The operator acts on the nuclear wave function that follows it in
the full equation. The <span class="math inline">\(\nabla_I\)</span>
term acts as a derivative on that wave function.
该算符作用于完整方程中跟随它的核波函数。<span
class="math inline">\(\nabla_I\)</span> 项充当该波函数的导数。</li>
</ul>
<h3 id="the-coupled-equations-of-motion-耦合运动方程">16. The Coupled
Equations of Motion 耦合运动方程</h3>
<p>Using this compact definition, the full set of coupled time-dependent
Schrödinger equations for the nuclear wave functions can be written as:
基于此简洁定义，核波函数的完整耦合含时薛定谔方程组可以写成：</p>
<p><span class="math inline">\(i\hbar \frac{\partial}{\partial t}
\Theta_k = \left( -\sum_{I} \frac{\hbar^2}{2M_I}\nabla_I^2 + E_k \right)
\Theta_k + \sum_n C_{kn} \Theta_n\)</span></p>
<p>This is the central result. It shows that the time evolution of the
nuclear wave function on a given potential energy surface <span
class="math inline">\(k\)</span> (described by <span
class="math inline">\(\Theta_k\)</span>) depends on two things:
这是核心结论。它表明，核波函数在给定势能面 <span
class="math inline">\(k\)</span>（用 <span
class="math inline">\(\Theta_k\)</span>
描述）上的时间演化取决于两个因素： 1. The motion on its own surface,
governed by its kinetic energy and the potential <span
class="math inline">\(E_k\)</span>. 其自身表面上的运动，由其动能和势能
<span class="math inline">\(E_k\)</span> 控制。 2. The influence of the
nuclear wave functions on <em>all other</em> electronic surfaces (<span
class="math inline">\(\Theta_n\)</span>), mediated by the coupling
operators <span class="math inline">\(C_{kn}\)</span>.
核波函数对<em>所有其他</em>电子表面（<span
class="math inline">\(\Theta_n\)</span>）的影响，由耦合算符 <span
class="math inline">\(C_{kn}\)</span> 介导。</p>
<h3 id="the-born-huang-approximation-玻恩-黄近似">17. The Born-Huang
Approximation 玻恩-黄近似</h3>
<p>The first and most crucial approximation is introduced to simplify
this complex set of coupled equations.
为了简化这组复杂的耦合方程，引入了第一个也是最重要的近似。</p>
<p><strong>If <span class="math inline">\(C_{kn} = 0\)</span> for <span
class="math inline">\(k \neq n\)</span> (Born-Huang
approximation)</strong></p>
<p>This approximation assumes that the <strong>off-diagonal</strong>
coupling terms, which are responsible for transitions between different
electronic states, are negligible. However, it retains the
<strong>diagonal</strong> coupling term (<span
class="math inline">\(C_{kk}\)</span>). This leads to a simplified,
uncoupled equation:
该近似假设导致不同电子态之间跃迁的<strong>非对角</strong>耦合项可以忽略不计。然而，它保留了<strong>对角</strong>耦合项（<span
class="math inline">\(C_{kk}\)</span>）。这可以得到一个简化的非耦合方程：</p>
<p><span class="math inline">\(i\hbar \frac{\partial}{\partial t}
\Theta_k = \left( -\sum_{I} \frac{\hbar^2}{2M_I}\nabla_I^2 + E_k +
C_{kk} \right) \Theta_k\)</span></p>
<p>Substituting the definition of <span
class="math inline">\(C_{kk}\)</span>: 代入 <span
class="math inline">\(C_{kk}\)</span> 的定义：</p>
<p><span class="math inline">\(i\hbar \frac{\partial}{\partial t}
\Theta_k = \left( -\sum_{I} \frac{\hbar^2}{2M_I}\nabla_I^2 + E_k -
\sum_I \frac{\hbar^2}{2M_I} \left( 2 \left( \int \Phi_k^* \nabla_I
\Phi_k \, d\vec{r} \right) \cdot \nabla_I + \int \Phi_k^* \nabla_I^2
\Phi_k \, d\vec{r} \right) \right) \Theta_k\)</span></p>
<p>The term <span class="math inline">\(C_{kk}\)</span> is known as the
<strong>diagonal Born-Oppenheimer correction (DBOC)</strong>. It
represents a small correction to the potential energy surface <span
class="math inline">\(E_k\)</span> that arises from the fact that the
electrons do not adjust perfectly and instantaneously to the nuclear
motion, even within the same electronic state. <span
class="math inline">\(C_{kk}\)</span>
项被称为<strong>对角玻恩-奥本海默修正 (DBOC)</strong>。它表示对势能面
<span class="math inline">\(E_k\)</span>
的微小修正，其原因是即使在相同的电子态下，电子也无法完美且即时地适应核运动。</p>
<ul>
<li><strong>Note on Real Wavefunctions 关于实波函数的注释</strong>: The
board shows that for real wavefunctions, the first-derivative part of
the diagonal correction vanishes: <span class="math inline">\(\int
\Phi_k \nabla_I \Phi_k \, d\vec{r} = 0\)</span>. This is because the
integral is related to the gradient of the normalization condition,
<span class="math inline">\(\nabla_I \int \Phi_k^2 \, d\vec{r} =
\nabla_I(1) = 0\)</span>, which expands to <span
class="math inline">\(2\int \Phi_k \nabla_I \Phi_k \, d\vec{r} =
0\)</span>. 黑板显示，对于实波函数，对角修正的一阶导数部分为零：<span
class="math inline">\(\int \Phi_k \nabla_I \Phi_k \, d\vec{r} =
0\)</span>。这是因为积分与归一化条件的梯度有关，<span
class="math inline">\(\nabla_I \int \Phi_k^2 \, d\vec{r} = \nabla_I(1) =
0\)</span>，其展开为 <span class="math inline">\(2\int \Phi_k \nabla_I
\Phi_k \, d\vec{r} = 0\)</span>。</li>
</ul>
<h3 id="the-born-oppenheimer-approximation-玻恩-奥本海默近似">18. The
Born-Oppenheimer Approximation 玻恩-奥本海默近似</h3>
<p>The final and most widely used approximation is the Born-Oppenheimer
approximation. It is more restrictive than the Born-Huang approximation.
最后一种也是最广泛使用的近似方法是玻恩-奥本海默近似。它比玻恩-黄近似更具限制性。</p>
<p><strong>If <span class="math inline">\(C_{kk} = 0\)</span>
(Born-Oppenheimer approximation) 若<span class="math inline">\(C_{kk} =
0\)</span>（玻恩-奥本海默近似）</strong></p>
<p>This assumes that the diagonal correction term is also negligible. By
setting all <span class="math inline">\(C_{kn}=0\)</span> (both diagonal
and off-diagonal), the equations become completely decoupled, and the
nuclear motion evolves independently on each potential energy surface.
这假设对角修正项也可忽略不计。通过令所有<span
class="math inline">\(C_{kn}=0\)</span>（包括对角和非对角），方程组完全解耦，原子核运动在每个势能面上独立演化。</p>
<p>The result is the standard <strong>time-dependent Schrödinger
equation for the nuclei</strong>:
由此可得标准的<strong>原子核的含时薛定谔方程</strong>：</p>
<p><span class="math inline">\(i\hbar \frac{\partial}{\partial t}
\Theta_k = \left( -\sum_{I} \frac{\hbar^2}{2M_I}\nabla_I^2 + E_k \right)
\Theta_k\)</span></p>
<p>This equation is the foundation of most of quantum chemistry. It
states that the nuclei move on a static potential energy surface <span
class="math inline">\(E_k(\vec{R})\)</span> provided by the electrons,
without any possibility of transitioning to other electronic states or
having the surface be corrected by their own motion.</p>
<p>该方程是大多数量子化学的基础。原子核在由电子提供的静态势能面 <span
class="math inline">\(E_k(\vec{R})\)</span>
上运动，不存在跃迁到其他电子态或因自身运动而修正势能面的可能性。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/PHYS-5120/" rel="tag"># PHYS-5120</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/09/18/img_assert/" rel="prev" title="BLOGS - IMG Assert">
      <i class="fa fa-chevron-left"></i> BLOGS - IMG Assert
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/09/27/fusionnetwork/" rel="next" title="FusionProt - 论文阅读">
      FusionProt - 论文阅读 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#monte-carlo-mc-method"><span class="nav-number">1.</span> <span class="nav-text">1 Monte Carlo (MC) Method:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#metropolis-monte-carlo-mc-method"><span class="nav-number">1.1.</span> <span class="nav-text">1. Metropolis Monte Carlo (MC)
Method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hamiltonian-hybrid-monte-carlo-hmc"><span class="nav-number">1.2.</span> <span class="nav-text">2. Hamiltonian &#x2F; Hybrid
Monte Carlo (HMC)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#key-formulas-and-notations"><span class="nav-number">1.3.</span> <span class="nav-text">Key Formulas and Notations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-time-dependent-schr%C3%B6dinger-equation"><span class="nav-number">1.4.</span> <span class="nav-text">3. The Time-Dependent
Schrödinger Equation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-full-molecular-hamiltonian-hatmathcalh"><span class="nav-number">1.5.</span> <span class="nav-text">4. The Full
Molecular Hamiltonian (\(\hat{\mathcal{H}}\))</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#notations-and-conventions"><span class="nav-number">1.6.</span> <span class="nav-text">5. Notations and Conventions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#topic-non-adiabatic-molecular-dynamics-md-%E9%9D%9E%E7%BB%9D%E7%83%AD%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6-md"><span class="nav-number">1.7.</span> <span class="nav-text">6.
Topic: Non-Adiabatic Molecular Dynamics (MD) 非绝热分子动力学 (MD)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-born-huang-ansatz-%E7%8E%BB%E6%81%A9-%E9%BB%84%E6%8B%9F%E8%AE%BE"><span class="nav-number">1.8.</span> <span class="nav-text">7. The Born-Huang Ansatz
玻恩-黄拟设</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-partitioned-molecular-hamiltonian-%E5%88%86%E5%89%B2%E5%88%86%E5%AD%90%E5%93%88%E5%AF%86%E9%A1%BF%E9%87%8F"><span class="nav-number">1.9.</span> <span class="nav-text">8. The
Partitioned Molecular Hamiltonian 分割分子哈密顿量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-electronic-schr%C3%B6dinger-equation-%E7%94%B5%E5%AD%90%E8%96%9B%E5%AE%9A%E8%B0%94%E6%96%B9%E7%A8%8B"><span class="nav-number">1.10.</span> <span class="nav-text">9. The
Electronic Schrödinger Equation 电子薛定谔方程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#deriving-the-equations-of-motion-for-the-nuclei-%E6%8E%A8%E5%AF%BC%E5%8E%9F%E5%AD%90%E6%A0%B8%E8%BF%90%E5%8A%A8%E6%96%B9%E7%A8%8B"><span class="nav-number">1.11.</span> <span class="nav-text">10.
Deriving the Equations of Motion for the Nuclei 推导原子核运动方程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#starting-point-the-projected-schr%C3%B6dinger-equation-%E8%B5%B7%E7%82%B9%E6%8A%95%E5%BD%B1%E8%96%9B%E5%AE%9A%E8%B0%94%E6%96%B9%E7%A8%8B"><span class="nav-number">1.12.</span> <span class="nav-text">11.
Starting Point: The Projected Schrödinger Equation
起点：投影薛定谔方程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#applying-the-product-rule-for-the-laplacian-%E5%BA%94%E7%94%A8%E6%8B%89%E6%99%AE%E6%8B%89%E6%96%AF%E7%AE%97%E5%AD%90%E7%9A%84%E4%B9%98%E7%A7%AF%E8%A7%84%E5%88%99"><span class="nav-number">1.13.</span> <span class="nav-text">12.
Applying the Product Rule for the Laplacian
应用拉普拉斯算子的乘积规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#expanding-the-kinetic-energy-term-%E5%B1%95%E5%BC%80%E5%8A%A8%E8%83%BD%E9%A1%B9"><span class="nav-number">1.14.</span> <span class="nav-text">13. Expanding the
Kinetic Energy Term 展开动能项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#final-result-and-identification-of-coupling-terms-%E6%9C%80%E7%BB%88%E7%BB%93%E6%9E%9C%E5%8F%8A%E8%80%A6%E5%90%88%E9%A1%B9%E7%9A%84%E8%AF%86%E5%88%AB"><span class="nav-number">1.15.</span> <span class="nav-text">14.
Final Result and Identification of Coupling Terms
最终结果及耦合项的识别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#definition-of-the-non-adiabatic-coupling-operator-%E9%9D%9E%E7%BB%9D%E7%83%AD%E8%80%A6%E5%90%88%E7%AE%97%E7%AC%A6%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="nav-number">1.16.</span> <span class="nav-text">15.
Definition of the Non-Adiabatic Coupling Operator
非绝热耦合算符的定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-coupled-equations-of-motion-%E8%80%A6%E5%90%88%E8%BF%90%E5%8A%A8%E6%96%B9%E7%A8%8B"><span class="nav-number">1.17.</span> <span class="nav-text">16. The Coupled
Equations of Motion 耦合运动方程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-born-huang-approximation-%E7%8E%BB%E6%81%A9-%E9%BB%84%E8%BF%91%E4%BC%BC"><span class="nav-number">1.18.</span> <span class="nav-text">17. The Born-Huang
Approximation 玻恩-黄近似</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#the-born-oppenheimer-approximation-%E7%8E%BB%E6%81%A9-%E5%A5%A5%E6%9C%AC%E6%B5%B7%E9%BB%98%E8%BF%91%E4%BC%BC"><span class="nav-number">1.19.</span> <span class="nav-text">18. The
Born-Oppenheimer Approximation 玻恩-奥本海默近似</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
